(function(ne,Ae,v,t,re,L,A,e,F,se,Je,P,W){"use strict";const{openLazy:Ke,hideActionSheet:Kt}=v.findByProps("openLazy","hideActionSheet");function oe(n,r){if(n!=null&&r!=null)for(const a of Object.keys(r))typeof r[a]=="object"&&!Array.isArray(r[a])?(typeof n[a]!="object"&&(n[a]={}),oe(n[a],r[a])):n[a]??=r[a]}function _e(n,r){try{Ke(new Promise(function(a){return a({default:n})}),"ActionSheet",r)}catch(a){Ae.logger.error(a.stack),showToast("Got error when opening ActionSheet! Please check debug logs")}}function We(n,r){let a=n+r;a=Math.min(a,255);const g=n.toString(16).padStart(2,"0"),i=a.toString(16).padStart(2,"0");return{main:g,secondary:i}}const we=function(n,r){return`${n}${Math.floor(r*255).toString(16).padStart(2,0)}`},Q={toInt(n){return n=n.replace(/^#/,""),parseInt(n,16)},toHex(n){return"#"+n.toString(16).toUpperCase()},HSLtoHEX(n,r,a){a/=100;const g=r*Math.min(a,1-a)/100,i=function(f){const c=(f+n/30)%12,m=a-g*Math.max(Math.min(c-3,9-c,1),-1);return Math.round(255*m).toString(16).padStart(2,"0")};return`#${i(0)}${i(8)}${i(4)}`}};var De=Object.freeze({__proto__:null,calculateLighterValue:We,colorConverter:Q,makeDefaults:oe,openSheet:_e,setOpacity:we});const{ScrollView:Qe,View:le,Text:Ze,TouchableOpacity:Ne,TextInput:Wt,Image:qe,Animated:Z}=L.General,{FormLabel:et,FormIcon:tt,FormArrow:Qt,FormRow:ie,FormSwitch:at,FormSwitchRow:Zt,FormSection:nt,FormDivider:rt,FormInput:Te}=L.Forms,st=v.findByName("useIsFocused");v.findByProps("BottomSheetScrollView");const Fe=v.findByStoreName("UserStore"),ce=v.findByProps("showUserProfile");A.getAssetIDByName("ic_add_24px"),A.getAssetIDByName("ic_arrow"),A.getAssetIDByName("ic_minus_circle_24px"),A.getAssetIDByName("Check"),A.getAssetIDByName("Small");function Be(n){return e.React.createElement(tt,{style:{opacity:1},source:A.getAssetIDByName(n)})}const z=e.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:F.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"3%",fontSize:24},sub:{color:F.semanticColors.TEXT_POSITIVE,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:F.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16},container:{marginTop:25,marginLeft:"5%",marginBottom:-15,flexDirection:"row"},textContainer:{paddingLeft:15,paddingTop:5,flexDirection:"column",flexWrap:"wrap",shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:.2,shadowRadius:4.65,elevation:8},image:{width:75,height:75,borderRadius:10,shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:.2,shadowRadius:4.65,elevation:8},mainText:{opacity:.975,letterSpacing:.25},header:{color:F.semanticColors.HEADER_PRIMARY,fontFamily:e.constants.Fonts.DISPLAY_BOLD,fontSize:25,letterSpacing:.25},subHeader:{color:F.semanticColors.HEADER_SECONDARY,fontSize:12.75}});function Pe(n){let{index:r}=n;var a,g,i,f;re.useProxy(t.storage);let c=t.storage===null||t.storage===void 0||(a=t.storage.inputs)===null||a===void 0?void 0:a.ignoredUserList[r];const m=e.React.useRef(new Z.Value(1)).current,C=function(){return Z.spring(m,{toValue:1.1,duration:10,useNativeDriver:!0}).start()},_=function(){return Z.spring(m,{toValue:1,duration:250,useNativeDriver:!0}).start()},w={transform:[{scale:m}]};let u=Fe.getUser(c?.id),b=Object.values(Fe.getUsers());u||(u=b.find(function(l){return l?.username==c?.username})),u||(u=b.find(function(l){var d,s;return(l==null||(d=l.username)===null||d===void 0?void 0:d.toLowerCase())==(c==null||(s=c.username)===null||s===void 0?void 0:s.toLowerCase())}));const h=e.NavigationNative.useNavigation();return st(),e.React.createElement(e.React.Fragment,null,e.React.createElement(Qe,null,e.React.createElement(le,{style:[z.basicPad,z.sub]},e.React.createElement(nt,{title:"User Setting",style:[z.header]},e.React.createElement(ie,{label:"Find User Id or Username",leading:Be("ic_search"),onPress:function(){var l,d;u&&!(!((l=c.username)===null||l===void 0)&&l.length)?c.username=u.username:u&&!(!((d=c.id)===null||d===void 0)&&d.length)?c.id=u.id:se.showToast("Cannot find User Id/Username.")}}),e.React.createElement(Te,{title:"User Username | Case Sensitive",placeholder:"Missing No",value:c?.username,onChange:function(l){return c.username=l}}),e.React.createElement(Te,{title:"User Id",placeholder:"Missing No",value:c?.id,onChange:function(l){return c.id=l}}),e.React.createElement(ie,{label:"User is webhook?",subLabel:"User is webhook or system, and not BOT or Normal User.",leading:Be("ic_webhook_24px"),trailing:e.React.createElement(at,{value:c?.isWebhook||!1,onValueChange:function(l){return c.isWebhook=l}})})),u&&e.React.createElement(le,{style:[z.container,{paddingBottom:10}]},e.React.createElement(Ne,{onPress:function(){var l;return(l=ce.showUserProfile)===null||l===void 0?void 0:l.call(ce,{userId:u?.id})},onPressIn:C,onPressOut:_},e.React.createElement(Z.View,{style:w},e.React.createElement(qe,{source:{uri:(u==null||(f=u.getAvatarURL)===null||f===void 0||(i=f.call(u))===null||i===void 0||(g=i.replace)===null||g===void 0?void 0:g.call(i,"webp","png"))||"https://cdn.discordapp.com/embed/avatars/2.png"},style:{width:128,height:128,borderRadius:10}}))),e.React.createElement(le,{style:z.textContainer},e.React.createElement(Ne,{onPress:function(){return ce.showUserProfile({userId:u?.id})}},e.React.createElement(Ze,{style:[z.mainText,z.header]},u?.username||c?.username||"No Name"))),e.React.createElement(rt,null)),e.React.createElement(ie,{label:e.React.createElement(et,{text:"Remove User from Ignore List",style:{color:F.rawColors.RED_400}}),onPress:function(){var l,d;h.pop(),t.storage===null||t.storage===void 0||(d=t.storage.inputs)===null||d===void 0||(l=d.ignoredUserList)===null||l===void 0||l.splice(r,1)}}))))}const{ScrollView:ot,View:lt,Text:qt,TouchableOpacity:it,TextInput:ct}=L.General,{FormLabel:ea,FormIcon:dt,FormArrow:ut,FormRow:de,FormSwitch:ta,FormSwitchRow:aa,FormSection:gt,FormDivider:ft,FormInput:na}=L.Forms;function Me(n,r){return React.createElement(dt,{style:{opacity:1},source:r?n:A.getAssetIDByName(n)})}const ht=v.findByName("useIsFocused");v.findByProps("BottomSheetScrollView");const{getUser:vt}=v.findByProps("getUser"),Et=A.getAssetIDByName("ic_add_24px");A.getAssetIDByName("ic_arrow"),A.getAssetIDByName("ic_minus_circle_24px"),A.getAssetIDByName("Check"),A.getAssetIDByName("Small");const Rt=A.getAssetIDByName("ic_trash_24px"),V=e.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:F.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"3.5%",fontSize:24},sub:{color:F.semanticColors.TEXT_POSITIVE,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:F.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16},input:{fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM,color:F.semanticColors.TEXT_NORMAL},placeholder:{color:F.semanticColors.INPUT_PLACEHOLDER_TEXT}});function yt(){var n;re.useProxy(t.storage);let[r,a]=React.useState("");const g=e.NavigationNative.useNavigation();ht();let i=(t.storage===null||t.storage===void 0||(n=t.storage.inputs)===null||n===void 0?void 0:n.ignoredUserList)??[];const f=function(){if(r){if(isNaN(parseInt(r)))i.push({id:void 0,username:r});else{let c=vt(r);if(c)i.push({id:c?.id,username:"",showUser:!1,isWebhook:!1});else return se.showToast("Invalid User Id")}a(""),g.push("VendettaCustomPage",{title:"Adding User to Ignore List",render:function(){return React.createElement(Pe,{index:i?.length-1})}})}};return React.createElement(React.Fragment,null,React.createElement(ot,{style:{flex:1}},React.createElement(gt,{style:[V.header,V.basicPad]},React.createElement(lt,{style:[V.header,V.sub]},i.length>0&&React.createElement(de,{label:"Clear List",trailing:Me(Rt,!0),onPress:function(){i.length!==0&&Je.showConfirmationAlert({title:"Hol up, wait a minute!",content:`This will removes in total ${i.length} users from ignore list.`,confirmText:"Ye",cancelText:"Nah",confirmColor:"brand",onConfirm:function(){t.storage.inputs.ignoredUserList=[]}})}}),i?.map(function(c,m){return React.createElement(React.Fragment,null,React.createElement(de,{label:c?.username||c?.id||"No Data",trailing:React.createElement(ut,null),onPress:function(){return g.push("VendettaCustomPage",{title:"Editing User",render:function(){return React.createElement(Pe,{index:m})}})}}),m!==i?.length-1&&React.createElement(ft,null))}),React.createElement(de,{label:React.createElement(ct,{value:r,onChangeText:a,placeholder:"User ID or Username",placeholderTextColor:V.placeholder.color,selectionColor:e.constants.Colors.PRIMARY_DARK_100,onSubmitEditing:f,returnKeyType:"done",style:V.input}),trailing:React.createElement(it,{onPress:f},Me(Et,!0))})))))}const bt=v.findByName("CustomColorPickerActionSheet"),{ScrollView:St,View:$,Text:Le,TouchableOpacity:$e,TextInput:ra,Pressable:sa,Image:mt}=L.General,{FormLabel:oa,FormIcon:X,FormArrow:la,FormRow:H,FormSwitch:q,FormSwitchRow:ia,FormSection:Y,FormDivider:O,FormInput:Ct,FormSliderRow:xe}=L.Forms,x=e.stylesheet.createThemedStyleSheet({text:{color:F.semanticColors.HEADER_SECONDARY,paddingLeft:"5.5%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:e.constants.Fonts.PRIMARY_BOLD,fontSize:16},subText:{color:F.semanticColors.TEXT_POSITIVE,paddingLeft:"6%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,fontSize:12},input:{fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM,color:F.semanticColors.TEXT_NORMAL},placeholder:{color:F.semanticColors.INPUT_PLACEHOLDER_TEXT},container:{flex:1,justifyContent:"center",alignItems:"center"},colorPreview:{width:"75%",height:100,marginBottom:20},row:{flexDirection:"row",height:80,width:"90%",marginBottom:20},border:{borderRadius:12}}),pt=A.getAssetIDByName("ic_add_24px");v.findByProps("getUser");const It=v.findByName("useIsFocused"),Ue=[{id:"enableMD",default:!0,label:"Toggle Message Delete",subLabel:"Logs deleted message"},{id:"enableMU",default:!0,label:"Toggle Message Update",subLabel:"Logs edited message"}],ke=[{id:"minimalistic",default:!0,label:"Minimalistic Settings",subLabel:"Removes all Styling (Enabled by Default)"},{id:"useBackgroundColor",default:!1,label:"Enable Background Color",subLabel:"Background Color for Deleted Message, similiar to Mention but Customizeable"},{id:"ignoreBots",default:!1,label:"Ignore Bots",subLabel:"Ignore bot deleted messages."},{id:"removeDismissButton",default:!1,label:"Remove Dissmiss Message",subLabel:"Remove clickable Dismiss Message text from deleted ephemeral messages."},{id:"addTimestampForEdits",default:!1,label:"Add Edit Timestamp",subLabel:"Add Timestamp for edited messages."}],Oe=[{id:"textColor",label:"Deleted Message Text Color",subLabel:"Click to customize Deleted Message Text Color",defaultColor:"#E40303"},{id:"backgroundColor",label:"Deleted Message Background Color",subLabel:"Click to customize Background Color",defaultColor:"#FF2C2F"},{id:"gutterColor",label:"Deleted Message Background Gutter Color",subLabel:"Click to customize Background Gutter Color",defaultColor:"#FF2C2F"}],ze=[{id:"deletedMessageBuffer",title:"Customize Deleted Message",type:"default",placeholder:"This message is deleted"},{id:"editedMessageBuffer",title:"Customize Edited Separator",type:"default",placeholder:"`[ EDITED ]`"}];function ee(n){n=Number(n);const r=Math.min(Math.max(n,0),100),a=Math.round(r/100*255).toString(16).toUpperCase();return a.length===1?"0"+a:a}function Ge(n){const r=parseInt(n,16);return isNaN(r)?0:Math.round(r/255*100)}const U={toPercentage:function(n){return n=Number(n),n===0?0:n===1?100:Math.round(n*100)},toDecimal:function(n){n=Number(n);const r=Math.min(Math.max(n,0),100);return r===0?0:r===100?1:r/100},formatDecimal:function(n){return n=Number(n),n===0||n===1?n:n.toFixed(2)}};function ue(){var n,r,a,g,i,f,c,m,C,_,w,u,b,h,l;re.useProxy(t.storage);const[d,s]=e.React.useState(U.toDecimal(Ge(t.storage===null||t.storage===void 0||(n=t.storage.colors)===null||n===void 0?void 0:n.backgroundColorAlpha)??100)),[y,E]=e.React.useState(U.toDecimal(Ge(t.storage===null||t.storage===void 0||(r=t.storage.colors)===null||r===void 0?void 0:r.gutterColorAlpha)??100)),S=e.NavigationNative.useNavigation();It();const D=function(){S.push("VendettaCustomPage",{title:"List of Ignored Users",render:function(){return e.React.createElement(yt,null)}})};return e.React.createElement(St,null,e.React.createElement($,{style:{marginTop:20,marginBottom:20}},e.React.createElement(Y,{title:"Plugin Setting",style:[x.header]},e.React.createElement(H,{label:"Customization",subLabel:"Show customization for the plugin",leading:e.React.createElement(X,{style:{opacity:1},source:A.getAssetIDByName("ic_category_16px")}),trailing:e.React.createElement(q,{value:(t.storage===null||t.storage===void 0||(a=t.storage.switches)===null||a===void 0?void 0:a.customizeable)??!1,onValueChange:function(o){return t.storage.switches.customizeable=o}})}),(t.storage===null||t.storage===void 0||(g=t.storage.switches)===null||g===void 0?void 0:g.customizeable)&&e.React.createElement(e.React.Fragment,null,e.React.createElement(Y,{title:"Patches"}),e.React.createElement(O,null)),(t.storage===null||t.storage===void 0||(i=t.storage.switches)===null||i===void 0?void 0:i.customizeable)&&e.React.createElement(e.React.Fragment,null,e.React.createElement($,{style:[x.subText]},Ue?.map(function(o,R){return e.React.createElement(e.React.Fragment,null,e.React.createElement(H,{label:o?.label,subLabel:o?.subLabel,leading:o?.icon&&e.React.createElement(X,{style:{opacity:1},source:A.getAssetIDByName(o?.icon)}),trailing:"id"in o?e.React.createElement(q,{value:(t.storage===null||t.storage===void 0?void 0:t.storage.switches[o?.id])??o?.default,onValueChange:function(p){return t.storage.switches[o?.id]=p}}):void 0}),R!==Ue?.length-1&&e.React.createElement(O,null))}))),(t.storage===null||t.storage===void 0||(f=t.storage.switches)===null||f===void 0?void 0:f.customizeable)&&e.React.createElement(e.React.Fragment,null,e.React.createElement(Y,{title:"Switches"}),e.React.createElement(O,null)),(t.storage===null||t.storage===void 0||(c=t.storage.switches)===null||c===void 0?void 0:c.customizeable)&&e.React.createElement(e.React.Fragment,null,e.React.createElement($,{style:[x.subText]},ke?.map(function(o,R){return e.React.createElement(e.React.Fragment,null,e.React.createElement(H,{label:o?.label,subLabel:o?.subLabel,leading:o?.icon&&e.React.createElement(X,{style:{opacity:1},source:A.getAssetIDByName(o?.icon)}),trailing:"id"in o?e.React.createElement(q,{value:(t.storage===null||t.storage===void 0?void 0:t.storage.switches[o?.id])??o?.default,onValueChange:function(p){return t.storage.switches[o?.id]=p}}):void 0}),R!==ke?.length-1&&e.React.createElement(O,null))}))),(t.storage===null||t.storage===void 0||(m=t.storage.switches)===null||m===void 0?void 0:m.customizeable)&&e.React.createElement(e.React.Fragment,null,e.React.createElement(Y,{title:"Text Variables"}),e.React.createElement(O,null)),(t.storage===null||t.storage===void 0||(C=t.storage.switches)===null||C===void 0?void 0:C.customizeable)&&e.React.createElement(e.React.Fragment,null,e.React.createElement($,{style:[x.subText]},ze?.map(function(o,R){return e.React.createElement(e.React.Fragment,null,e.React.createElement(Ct,{title:o?.title,keyboardType:o?.type,placeholder:o?.placeholder,value:(t.storage===null||t.storage===void 0?void 0:t.storage.inputs[o.id])??o?.placeholder,onChange:function(p){return t.storage.inputs[o.id]=p.toString()}}),R!==ze.length-1&&e.React.createElement(O,null))}))),(t.storage===null||t.storage===void 0||(_=t.storage.switches)===null||_===void 0?void 0:_.customizeable)&&e.React.createElement(e.React.Fragment,null,e.React.createElement(Y,{title:"Color Pickers"}),e.React.createElement(O,null)),(t.storage===null||t.storage===void 0||(w=t.storage.switches)===null||w===void 0?void 0:w.customizeable)&&e.React.createElement(e.React.Fragment,null,e.React.createElement($,{style:[x.subText]},Oe?.map(function(o){var R;const p=function(){var T;return _e(bt,{color:De==null||(T=Q)===null||T===void 0?void 0:T.toInt(t.storage.colors[o.id]||o?.defaultColor||"#000"),onSelect:function(M){var B;const k=De==null||(B=Q)===null||B===void 0?void 0:B.toHex(M);t.storage.colors[o.id]=k}})};return e.React.createElement(e.React.Fragment,null,e.React.createElement(H,{label:o?.label,subLabel:o?.subLabel||"Click to Update",onPress:p,trailing:e.React.createElement($e,{onPress:p},e.React.createElement(mt,{source:{uri:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mJsrQAAAgwBAJ9P6qYAAAAASUVORK5CYII="},style:{width:32,height:32,borderRadius:10,backgroundColor:(t.storage===null||t.storage===void 0?void 0:t.storage.colors[o.id])||((R=Oe.find(function(T){return T?.id==o?.id}))===null||R===void 0?void 0:R.defaultColor)||"#000"}}))}))}))),(t.storage===null||t.storage===void 0||(u=t.storage.switches)===null||u===void 0?void 0:u.customizeable)&&e.React.createElement(e.React.Fragment,null,e.React.createElement($,{style:[x.subText]},e.React.createElement($,{style:x.container},e.React.createElement(H,{style:{justifyContent:"center",alignItems:"center"},label:`Preview Style: ${!(t.storage===null||t.storage===void 0||(b=t.storage.switches)===null||b===void 0)&&b.darkMode?"Light":"Dark"} Mode`,subLabel:"Click to Switch Mode",trailing:e.React.createElement(q,{value:(t.storage===null||t.storage===void 0||(h=t.storage.switches)===null||h===void 0?void 0:h.darkMode)??!0,onValueChange:function(o){return t.storage.switches.darkMode=o}})}),e.React.createElement($,{style:[x.row,x.border,{overflow:"hidden",marginRight:10}]},e.React.createElement($,{style:{width:"2%",backgroundColor:`${t.storage.colors.gutterColor}${ee(U.toPercentage(y))}`}}),e.React.createElement($,{style:{flex:1,backgroundColor:`${t.storage.colors.backgroundColor}${ee(U.toPercentage(d))}`,justifyContent:"center",alignItems:"center"}},e.React.createElement(Le,{style:{fontSize:20,color:!(t.storage===null||t.storage===void 0||(l=t.storage.switches)===null||l===void 0)&&l.darkMode?"black":"white"}}," Low Effort Normal Example Message "),e.React.createElement(Le,{style:{fontSize:20,color:t.storage.colors.textColor||"#000000"}}," Low Effort Deleted Example Message "))),e.React.createElement(xe,{label:`Background Color Alpha: ${U.toPercentage(d)}%`,value:d,style:{width:"90%"},onValueChange:function(o){s(Number(U.formatDecimal(o))),t.storage.colors.backgroundColorAlpha=ee(U.toPercentage(o))}}),e.React.createElement(O,null),e.React.createElement(xe,{label:`Background Gutter Alpha: ${U.toPercentage(y)}%`,value:y,style:{width:"90%"},onValueChange:function(o){E(Number(U.formatDecimal(o))),t.storage.colors.gutterColorAlpha=ee(U.toPercentage(o))}}))))),e.React.createElement(Y,{title:"Ignore List Setting",style:[x.header]},e.React.createElement(H,{label:"Add User to List",subLabel:"List of ignored users for the plugin",leading:e.React.createElement(X,{style:{opacity:1},source:A.getAssetIDByName("ic_members")}),onPress:D,trailing:e.React.createElement($e,{onPress:D},e.React.createElement(X,{style:{opacity:1},source:pt}))}),e.React.createElement(O,null))))}v.findByProps("openLazy","hideActionSheet");const ge=v.findByProps("getChannel","getDMFromUserId"),At=v.findByProps("_channelMessages"),_t=v.findByProps("getMessage","getMessages");function wt(n){return P.before("dispatch",e.FluxDispatcher,function(r){const[a]=r,g=a?.type;if(g=="MESSAGE_DELETE"){var i,f,c,m,C,_,w,u,b,h,l,d;if(t.storage.switches.enableMD==!1||a?.otherPluginBypass)return r;const N=At.get(a.channelId),I=N?.get(a.id);if(!I||a?.id&&((i=n[a?.id])===null||i===void 0?void 0:i.stage)==2)return r;if(a?.id&&((f=n[a?.id])===null||f===void 0?void 0:f.stage)==1){var s;return n[a?.id].stage=2,((s=n[a?.id])===null||s===void 0?void 0:s.message)??r}const Ce=I==null||(c=I.author)===null||c===void 0?void 0:c.id,pe=I==null||(m=I.author)===null||m===void 0?void 0:m.username,j=!I?.content&&(I==null||(C=I.attachments)===null||C===void 0?void 0:C.length)==0&&(I==null||(_=I.embeds)===null||_===void 0?void 0:_.length)==0;return!Ce||!pe||j||!(t.storage===null||t.storage===void 0||(w=t.storage.switches)===null||w===void 0)&&w.ignoreBots&&!(I==null||(u=I.author)===null||u===void 0)&&u.bot||(t.storage===null||t.storage===void 0||(h=t.storage.inputs)===null||h===void 0||(b=h.ignoredUserList)===null||b===void 0?void 0:b.length)>0&&!((l=t.storage.inputs.ignoredUserList)===null||l===void 0)&&l.some(function(te){var G;return te?.id==(I==null||(G=I.author)===null||G===void 0?void 0:G.id)||te.username==I.author.username})||(r[0]={type:"MESSAGE_UPDATE",channelId:I?.channel_id||a?.channelId,message:{...I,content:I?.content,type:0,flags:64,channel_id:I?.channel_id||a?.channelId,guild_id:ge==null||(d=ge.getChannel(I?.channel_id))===null||d===void 0?void 0:d.guild_id,timestamp:`${new Date().toJSON()}`,state:"SENT",was_deleted:!0},optimistic:!1,sendMessageOptions:{},isPushNotification:!1},n[a?.id||I?.id]={message:r,stage:1}),r}if(g=="MESSAGE_UPDATE"){var y,E,S,D,o,R,p,T,M,B,k,J,he,ve,Ee,Re,ye,be;if(t.storage.switches.enableMU==!1||a?.otherPluginBypass||!(a==null||(E=a.message)===null||E===void 0||(y=E.author)===null||y===void 0)&&y.bot)return r;const N=_t.getMessage((a==null||(S=a.message)===null||S===void 0?void 0:S.channel_id)||a?.channelId,(a==null||(D=a.message)===null||D===void 0?void 0:D.id)||a?.id),I=N==null||(o=N.author)===null||o===void 0?void 0:o.id,Ce=N==null||(R=N.author)===null||R===void 0?void 0:R.username,pe=!N?.content&&(N==null||(p=N.attachments)===null||p===void 0?void 0:p.length)==0&&(N==null||(T=N.embeds)===null||T===void 0?void 0:T.length)==0;if(!N||!I||!Ce||pe||!(!(a==null||(M=a.message)===null||M===void 0)&&M.content)||!N?.content||(a==null||(B=a.message)===null||B===void 0?void 0:B.content)==N?.content||(t.storage===null||t.storage===void 0||(J=t.storage.inputs)===null||J===void 0||(k=J.ignoredUserList)===null||k===void 0?void 0:k.length)>0&&!(t.storage===null||t.storage===void 0||(ve=t.storage.inputs)===null||ve===void 0||(he=ve.ignoredUserList)===null||he===void 0)&&he.some(function(ae){var K,Ie;return ae?.id==(N==null||(K=N.author)===null||K===void 0?void 0:K.id)||ae?.username==(N==null||(Ie=N.author)===null||Ie===void 0?void 0:Ie.username)}))return r;let j=(t.storage===null||t.storage===void 0||(Ee=t.storage.inputs)===null||Ee===void 0?void 0:Ee.editedMessageBuffer)||"`[ EDITED ]`";j=j+`

`;const te=a?.message||N;let G=`${N?.content}`;if(!(t.storage===null||t.storage===void 0||(Re=t.storage.switches)===null||Re===void 0)&&Re.addTimestampForEdits){var Se;const ae=Date.now(),K=`<t:${Math.abs(Math.round(ae/1e3))}:R>`;G+=`  (${K}) ${j}${(a==null||(Se=a.message)===null||Se===void 0?void 0:Se.content)??""}`}else{var me;G+=`  ${j}${(a==null||(me=a.message)===null||me===void 0?void 0:me.content)??""}`}return r[0]={type:"MESSAGE_UPDATE",message:{...te,content:G,guild_id:(ye=ge.getChannel(a?.channelId||(a==null||(be=a.message)===null||be===void 0?void 0:be.channel_id)||N?.channel_id))===null||ye===void 0?void 0:ye.guild_id,edited_timestamp:"invalid_timestamp"}},r}return r})}const Dt=v.findByProps("startEditMessage");function Nt(){return P.before("startEditMessage",Dt,function(n){var r;let a=(t.storage===null||t.storage===void 0||(r=t.storage.inputs)===null||r===void 0?void 0:r.editedMessageBuffer)||"`[ EDITED ]`";a=a+`

`;const[g,i,f]=n,c=f.split(a);return n[2]=c[c.length-1],n})}const{DCDChatManager:Tt}=e.ReactNative.NativeModules;function Ft(n){return P.before("updateRows",Tt,function(r){var a;let g=JSON.parse(r[1]);const{textColor:i,backgroundColor:f,backgroundColorAlpha:c,gutterColor:m,gutterColorAlpha:C}=t.storage.colors,_=(a=t.storage.inputs)===null||a===void 0?void 0:a.deletedMessageBuffer,{useBackgroundColor:w,minimalistic:u,removeDismissButton:b}=t.storage.switches;function h(s,y){s||(s=y);const E=s?.trim();if(E.startsWith("#")){const S=E.slice(1);if(/^[0-9A-Fa-f]{6}$/.test(S))return"#"+S.toUpperCase()}else if(/^[0-9A-Fa-f]{6}$/.test(E))return"#"+E.toUpperCase();return y||"#000"}function l(s,y){const E=y?.toString(),S=["text","heading","s","u","em","strong","list","blockQuote"];if(Array.isArray(s))return s.map(function(D){return l(D,E)});if(typeof s=="object"&&s!==null){const{content:D,type:o,target:R,items:p}=s;if(!S.includes(o))return s;if(o==="text"&&D&&D.length>=1)return{content:[{content:D,type:"text"}],target:"usernameOnClick",type:"link",context:{username:1,medium:!0,usernameOnClick:{action:"0",userId:"0",linkColor:e.ReactNative.processColor(E),messageChannelId:"0"}}};const T=l(D,E),M=p?p.map(l,E):void 0;if(T!==D||M!==p||!S.includes(o)){const B={...s,content:T};return o==="blockQuote"&&R&&(B.content=T,B.target=R),o==="list"&&B?.content&&delete B.content,p&&(B.items=M),B}}return s}function d(s,y,E){return s&&(y!=null&&(s.content[0].content[0].content=y+"  "),E==null&&s.content[0].content.splice(1)),s}return g.forEach(function(s){if(s?.type==1){var y;if(n[s==null||(y=s.message)===null||y===void 0?void 0:y.id]){if((_?.length>0||_!="")&&(s.message.edited=_),u==!1){var E;const S=h(i,"#E40303"),D=l(s==null||(E=s.message)===null||E===void 0?void 0:E.content,S);s.message.content=D}if(b&&(s.message.ephemeralIndication=d(s.message.ephemeralIndication,void 0,void 0)),u==!1&&w==!0){const S=h(`${f}`,"#FF2C2F"),D=h(`${m}`,"#FF2C2F");s.backgroundHighlight??={},s.backgroundHighlight={backgroundColor:e.ReactNative.processColor(`${S}${c}`),gutterColor:e.ReactNative.processColor(`${D}${C}`)}}}}}),r[1]=JSON.stringify(g),r[1]})}const Bt=v.findByProps("updateMessageRecord","createMessageRecord");function Pt(){return P.after("createMessageRecord",Bt,function(n,r){let[a]=n;r.was_deleted=a.was_deleted})}const Mt=v.findByName("MessageRecord",!1);function Lt(){return P.after("default",Mt,function(n,r){let[a]=n;r.was_deleted=!!a.was_deleted})}const Ve=v.findByProps("updateMessageRecord","createMessageRecord");function $t(){return P.instead("updateMessageRecord",Ve,function(n,r){let[a,g]=n;return g.was_deleted?Ve.createMessageRecord(g,a.reactions):r.apply(this,[a,g])})}const{FormSection:xt}=L.Forms,Ut=v.findByName("getScreens"),kt=v.findByName("UserSettingsOverviewWrapper",!1),Ot=e.stylesheet.createThemedStyleSheet({container:{flex:1,backgroundColor:F.semanticColors.BACKGROUND_MOBILE_PRIMARY}});function zt(n,r,a){const g=[],i=P.after("default",kt,function(f,c){i();const m=W.findInReactTree(c.props.children,function(C){return C.type&&C.type.name==="UserSettingsOverview"});g.push(P.after("render",m.type.prototype,function(C,_){let{props:{children:w}}=_;const u=[e.i18n.Messages.BILLING_SETTINGS,e.i18n.Messages.PREMIUM_SETTINGS];w=W.findInReactTree(w,function(h){return h.children[1].type===xt}).children;const b=w.findIndex(function(h){return u.includes(h?.props.label)});n()&&w.splice(b===-1?4:b,0,r({}))}))},!0);if(g.push(i),Ut&&a){const f=`VENDETTA_PLUGIN_${e.lodash.snakeCase(a.key).toUpperCase()}`,c=a.page.render,m=e.React.memo(function(u){let{navigation:b}=u;const h=b.addListener("focus",function(){h(),b.setOptions(W.without(a.page,"noErrorBoundary","render"))});return e.React.createElement(e.ReactNative.View,{style:Ot.container},a.page.noErrorBoundary?e.React.createElement(c,null):e.React.createElement(L.ErrorBoundary,null,e.React.createElement(c,null)))}),C={[f]:{type:"route",title:function(){return a.title},icon:a.icon,parent:null,screen:{route:`VendettaPlugin${e.lodash.chain(a.key).camelCase().upperFirst().value()}`,getComponent:function(){return m}}}},_=function(u,b){var h,l;const d=[...u],s=b?d==null||(h=d[0])===null||h===void 0?void 0:h.sections:d;if(!Array.isArray(s))return s;const y="Vendetta",E=s.find(function(S){return S?.title===y||S?.label===y});return E&&!(!(E==null||(l=E.settings)===null||l===void 0)&&l.includes(f))&&E.settings.push(f),d},w=function(){const u=v.findByProps("useOverviewSettings"),b=v.findByProps("getSettingTitleConfig"),h=v.findByProps("SETTING_RELATIONSHIPS","SETTING_RENDERER_CONFIGS"),l="getSettingSearchListItems",d="getSettingListItems",s=v.findByProps(l),y=s?l:d,E=s??v.findByProps(d);if(!E||!u)return!1;g.push(P.after("useOverviewSettings",u,function(o,R){return _(R)})),g.push(P.after("getSettingTitleConfig",b,function(o,R){return{...R,[f]:a.title}})),g.push(P.after(y,E,function(o,R){let[p]=o;return[...p.includes(f)?[{type:"setting_search_result",ancestorRendererData:C[f],setting:f,title:function(){return a.title},breadcrumbs:["Vendetta"],icon:C[f].icon}]:[],...R]}));const S=h.SETTING_RELATIONSHIPS,D=h.SETTING_RENDERER_CONFIGS;return h.SETTING_RELATIONSHIPS={...S,[f]:null},h.SETTING_RENDERER_CONFIGS={...D,...C},g.push(function(){h.SETTING_RELATIONSHIPS=S,h.SETTING_RENDERER_CONFIGS=S}),!0};(function(){const u=v.findByProps("SearchableSettingsList"),b=v.findByProps("SETTING_RENDERER_CONFIG"),h=v.findByProps("getSettingListItems");if(!h||!u||!b)return!1;g.push(P.before("type",u.SearchableSettingsList,function(d){return _(d,!0)})),g.push(P.after("getSettingListSearchResultItems",h,function(d,s){for(const y of s)y.setting===f&&(y.breadcrumbs=["Vendetta"])}));const l=b.SETTING_RENDERER_CONFIG;return b.SETTING_RENDERER_CONFIG={...l,...C},g.push(function(){b.SETTING_RENDERER_CONFIG=l}),!0})()||w()}return function(){return g.forEach(function(f){return f()})}}const{FormRow:fe}=L.Forms;function Gt(){const n=e.NavigationNative.useNavigation();return React.createElement(L.ErrorBoundary,null,React.createElement(fe,{label:"Antied",leading:React.createElement(fe.Icon,{source:A.getAssetIDByName("ic_edit_24px")}),trailing:fe.Arrow,onPress:function(){return n.push("VendettaCustomPage",{title:"Antied",render:ue})}}))}function Vt(){const n=[];return n.push(zt(function(){return!0},function(){return React.createElement(Gt,null)},{key:Ae.plugin.manifest.name,icon:A.getAssetIDByName("ic_edit_24px"),title:"Anti Edit & Delete",page:{title:"Antied",render:ue}})),function(){return n.forEach(function(r){return r()})}}const He=v.findByProps("openLazy","hideActionSheet"),Ht=v.findByProps("getMessage","getMessages"),Yt=v.findByProps("getChannel","getDMFromUserId"),Ye=v.findByProps("_channelMessages"),{FormRow:jt,FormIcon:Xt}=L.Forms;oe(t.storage,{switches:{customizeable:!1,enableMD:!0,enableMU:!0,useBackgroundColor:!1,ignoreBots:!1,minimalistic:!0,alwaysAdd:!1,darkMode:!0,removeDismissButton:!1,addTimestampForEdits:!1,timestampStyle:"R"},colors:{textColor:"#E40303",backgroundColor:"#FF2C2F",backgroundColorAlpha:"33",gutterColor:"#FF2C2F",gutterColorAlpha:"CC"},inputs:{deletedMessageBuffer:"This message is deleted",editedMessageBuffer:"`[ EDITED ]`",ignoredUserList:[]}});let je=[],Xe={};var Jt={onLoad:function(){je.push(Vt(),wt(Xe),Ft(Xe),Nt(),Pt(),Lt(),$t(),P.before("openLazy",He,function(n){let[r,a,g]=n;const i=g?.message;a!=="MessageLongPressActionSheet"||!i||r.then(function(f){const c=P.after("default",f,function(m,C){var _;e.React.useEffect(function(){return function(){c()}},[]);const w=W.findInReactTree(C,function(l){var d,s;return(l==null||(s=l[0])===null||s===void 0||(d=s.type)===null||d===void 0?void 0:d.name)==="ButtonRow"});if(!w)return C;const u=Math.max(w.findIndex(function(l){var d,s;return(l==null||(d=l.props)===null||d===void 0?void 0:d.message)===(e.i18n===null||e.i18n===void 0||(s=e.i18n.Messages)===null||s===void 0?void 0:s.MESSAGE_ACTION_REPLY)}),0),b=Ht.getMessage(i.channel_id,i?.id),h=function(l){return l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}((t.storage===null||t.storage===void 0||(_=t.storage.inputs)===null||_===void 0?void 0:_.editedMessageBuffer)||"`[ EDITED ]`");if(new RegExp(h,"gmi").test(i.content)){const l=u||1;w.splice(l,0,e.React.createElement(jt,{label:"Remove Edit History",leading:e.React.createElement(Xt,{style:{opacity:1},source:A.getAssetIDByName("ic_edit_24px")}),onPress:function(){var d,s,y;let E=(t.storage===null||t.storage===void 0||(d=t.storage.inputs)===null||d===void 0?void 0:d.editedMessageBuffer)||"`[ EDITED ]`";E=E+`

`;const S=i==null||(s=i.content)===null||s===void 0?void 0:s.split(E),D=S[S.length-1],o=i==null||(y=i.embeds)===null||y===void 0?void 0:y.map(function(R){var p,T,M;const B=R==null||(M=R.color)===null||M===void 0||(T=M.replace(/.+\(/,""))===null||T===void 0||(p=T.replace(/\%/g,""))===null||p===void 0?void 0:p.replace(")",""),k=B?.split(", "),J=e.ReactNative.processColor(`${we(Q.HSLtoHEX(k[0],k[1],k[2]),k[3])}`);return{...R,author:R.author,title:R.rawTitle,description:R.rawDescription,url:R.url,type:R.type,image:R.image,thumbnail:R.thumbnail,color:J,content_scan_version:1}});e.FluxDispatcher.dispatch({type:"MESSAGE_UPDATE",message:{...i,content:`${D}`,embeds:o??[],attachments:i.attachments??[],mentions:i.mentions??[],guild_id:Yt.getChannel(b.channel_id).guild_id},otherPluginBypass:!0}),He.hideActionSheet(),se.showToast("[ANTI ED] History Removed",A.getAssetIDByName("ic_edit_24px"))}}))}})})}))},onUnload:function(){for(const n of je)n();for(const n in Ye._channelMessages)for(const r of Ye._channelMessages[n]._array)r.was_deleted&&e.FluxDispatcher.dispatch({type:"MESSAGE_DELETE",id:r.id,channelId:r.channel_id,otherPluginBypass:!0})},settings:ue};return ne.default=Jt,Object.defineProperty(ne,"__esModule",{value:!0}),ne})({},vendetta,vendetta.metro,vendetta.plugin,vendetta.storage,vendetta.ui.components,vendetta.ui.assets,vendetta.metro.common,vendetta.ui,vendetta.ui.toasts,vendetta.ui.alerts,vendetta.patcher,vendetta.utils);
