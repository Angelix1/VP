(function(le,Ae,v,t,ie,L,_,e,F,de,Je,M,ee){"use strict";const{openLazy:Ke,hideActionSheet:Kt}=v.findByProps("openLazy","hideActionSheet");function ce(n,r){if(n!=null&&r!=null)for(const a of Object.keys(r))typeof r[a]=="object"&&!Array.isArray(r[a])?(typeof n[a]!="object"&&(n[a]={}),ce(n[a],r[a])):n[a]??=r[a]}function _e(n,r){try{Ke(new Promise(function(a){return a({default:n})}),"ActionSheet",r)}catch(a){Ae.logger.error(a.stack),showToast("Got error when opening ActionSheet! Please check debug logs")}}function We(n,r){let a=n+r;a=Math.min(a,255);const g=n.toString(16).padStart(2,"0"),i=a.toString(16).padStart(2,"0");return{main:g,secondary:i}}const we=function(n,r){return`${n}${Math.floor(r*255).toString(16).padStart(2,0)}`},te={toInt(n){return n=n.replace(/^#/,""),parseInt(n,16)},toHex(n){return"#"+n.toString(16).toUpperCase()},HSLtoHEX(n,r,a){a/=100;const g=r*Math.min(a,1-a)/100,i=function(f){const d=(f+n/30)%12,p=a-g*Math.max(Math.min(d-3,9-d,1),-1);return Math.round(255*p).toString(16).padStart(2,"0")};return`#${i(0)}${i(8)}${i(4)}`}};var De=Object.freeze({__proto__:null,calculateLighterValue:We,colorConverter:te,makeDefaults:ce,openSheet:_e,setOpacity:we});const{ScrollView:Qe,View:ue,Text:Ze,TouchableOpacity:Ne,TextInput:Wt,Image:qe,Animated:ae}=L.General,{FormLabel:et,FormIcon:tt,FormArrow:Qt,FormRow:ge,FormSwitch:at,FormSwitchRow:Zt,FormSection:nt,FormDivider:rt,FormInput:Te}=L.Forms,st=v.findByName("useIsFocused");v.findByProps("BottomSheetScrollView");const Fe=v.findByStoreName("UserStore"),fe=v.findByProps("showUserProfile");_.getAssetIDByName("ic_add_24px"),_.getAssetIDByName("ic_arrow"),_.getAssetIDByName("ic_minus_circle_24px"),_.getAssetIDByName("Check"),_.getAssetIDByName("Small");function Me(n){return e.React.createElement(tt,{style:{opacity:1},source:_.getAssetIDByName(n)})}const G=e.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:F.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"3%",fontSize:24},sub:{color:F.semanticColors.TEXT_POSITIVE,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:F.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16},container:{marginTop:25,marginLeft:"5%",marginBottom:-15,flexDirection:"row"},textContainer:{paddingLeft:15,paddingTop:5,flexDirection:"column",flexWrap:"wrap",shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:.2,shadowRadius:4.65,elevation:8},image:{width:75,height:75,borderRadius:10,shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:.2,shadowRadius:4.65,elevation:8},mainText:{opacity:.975,letterSpacing:.25},header:{color:F.semanticColors.HEADER_PRIMARY,fontFamily:e.constants.Fonts.DISPLAY_BOLD,fontSize:25,letterSpacing:.25},subHeader:{color:F.semanticColors.HEADER_SECONDARY,fontSize:12.75}});function Pe(n){let{index:r}=n;var a,g,i,f;ie.useProxy(t.storage);let d=t.storage===null||t.storage===void 0||(a=t.storage.inputs)===null||a===void 0?void 0:a.ignoredUserList[r];const p=e.React.useRef(new ae.Value(1)).current,I=function(){return ae.spring(p,{toValue:1.1,duration:10,useNativeDriver:!0}).start()},w=function(){return ae.spring(p,{toValue:1,duration:250,useNativeDriver:!0}).start()},D={transform:[{scale:p}]};let u=Fe.getUser(d?.id),y=Object.values(Fe.getUsers());u||(u=y.find(function(l){return l?.username==d?.username})),u||(u=y.find(function(l){var c,s;return(l==null||(c=l.username)===null||c===void 0?void 0:c.toLowerCase())==(d==null||(s=d.username)===null||s===void 0?void 0:s.toLowerCase())}));const h=e.NavigationNative.useNavigation();return st(),e.React.createElement(e.React.Fragment,null,e.React.createElement(Qe,null,e.React.createElement(ue,{style:[G.basicPad,G.sub]},e.React.createElement(nt,{title:"User Setting",style:[G.header]},e.React.createElement(ge,{label:"Find User Id or Username",leading:Me("ic_search"),onPress:function(){var l,c;u&&!(!((l=d.username)===null||l===void 0)&&l.length)?d.username=u.username:u&&!(!((c=d.id)===null||c===void 0)&&c.length)?d.id=u.id:de.showToast("Cannot find User Id/Username.")}}),e.React.createElement(Te,{title:"User Username | Case Sensitive",placeholder:"Missing No",value:d?.username,onChange:function(l){return d.username=l}}),e.React.createElement(Te,{title:"User Id",placeholder:"Missing No",value:d?.id,onChange:function(l){return d.id=l}}),e.React.createElement(ge,{label:"User is webhook?",subLabel:"User is webhook or system, and not BOT or Normal User.",leading:Me("ic_webhook_24px"),trailing:e.React.createElement(at,{value:d?.isWebhook||!1,onValueChange:function(l){return d.isWebhook=l}})})),u&&e.React.createElement(ue,{style:[G.container,{paddingBottom:10}]},e.React.createElement(Ne,{onPress:function(){var l;return(l=fe.showUserProfile)===null||l===void 0?void 0:l.call(fe,{userId:u?.id})},onPressIn:I,onPressOut:w},e.React.createElement(ae.View,{style:D},e.React.createElement(qe,{source:{uri:(u==null||(f=u.getAvatarURL)===null||f===void 0||(i=f.call(u))===null||i===void 0||(g=i.replace)===null||g===void 0?void 0:g.call(i,"webp","png"))||"https://cdn.discordapp.com/embed/avatars/2.png"},style:{width:128,height:128,borderRadius:10}}))),e.React.createElement(ue,{style:G.textContainer},e.React.createElement(Ne,{onPress:function(){return fe.showUserProfile({userId:u?.id})}},e.React.createElement(Ze,{style:[G.mainText,G.header]},u?.username||d?.username||"No Name"))),e.React.createElement(rt,null)),e.React.createElement(ge,{label:e.React.createElement(et,{text:"Remove User from Ignore List",style:{color:F.rawColors.RED_400}}),onPress:function(){var l,c;h.pop(),t.storage===null||t.storage===void 0||(c=t.storage.inputs)===null||c===void 0||(l=c.ignoredUserList)===null||l===void 0||l.splice(r,1)}}))))}const{ScrollView:ot,View:lt,Text:qt,TouchableOpacity:it,TextInput:dt}=L.General,{FormLabel:ea,FormIcon:ct,FormArrow:ut,FormRow:he,FormSwitch:ta,FormSwitchRow:aa,FormSection:gt,FormDivider:ft,FormInput:na}=L.Forms;function Be(n,r){return React.createElement(ct,{style:{opacity:1},source:r?n:_.getAssetIDByName(n)})}const ht=v.findByName("useIsFocused");v.findByProps("BottomSheetScrollView");const{getUser:vt}=v.findByProps("getUser"),Et=_.getAssetIDByName("ic_add_24px");_.getAssetIDByName("ic_arrow"),_.getAssetIDByName("ic_minus_circle_24px"),_.getAssetIDByName("Check"),_.getAssetIDByName("Small");const Rt=_.getAssetIDByName("ic_trash_24px"),j=e.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:F.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"3.5%",fontSize:24},sub:{color:F.semanticColors.TEXT_POSITIVE,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:F.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16},input:{fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM,color:F.semanticColors.TEXT_NORMAL},placeholder:{color:F.semanticColors.INPUT_PLACEHOLDER_TEXT}});function yt(){var n;ie.useProxy(t.storage);let[r,a]=React.useState("");const g=e.NavigationNative.useNavigation();ht();let i=(t.storage===null||t.storage===void 0||(n=t.storage.inputs)===null||n===void 0?void 0:n.ignoredUserList)??[];const f=function(){if(r){if(isNaN(parseInt(r)))i.push({id:void 0,username:r});else{let d=vt(r);if(d)i.push({id:d?.id,username:"",showUser:!1,isWebhook:!1});else return de.showToast("Invalid User Id")}a(""),g.push("VendettaCustomPage",{title:"Adding User to Ignore List",render:function(){return React.createElement(Pe,{index:i?.length-1})}})}};return React.createElement(React.Fragment,null,React.createElement(ot,{style:{flex:1}},React.createElement(gt,{style:[j.header,j.basicPad]},React.createElement(lt,{style:[j.header,j.sub]},i.length>0&&React.createElement(he,{label:"Clear List",trailing:Be(Rt,!0),onPress:function(){i.length!==0&&Je.showConfirmationAlert({title:"Hol up, wait a minute!",content:`This will removes in total ${i.length} users from ignore list.`,confirmText:"Ye",cancelText:"Nah",confirmColor:"brand",onConfirm:function(){t.storage.inputs.ignoredUserList=[]}})}}),i?.map(function(d,p){return React.createElement(React.Fragment,null,React.createElement(he,{label:d?.username||d?.id||"No Data",trailing:React.createElement(ut,null),onPress:function(){return g.push("VendettaCustomPage",{title:"Editing User",render:function(){return React.createElement(Pe,{index:p})}})}}),p!==i?.length-1&&React.createElement(ft,null))}),React.createElement(he,{label:React.createElement(dt,{value:r,onChangeText:a,placeholder:"User ID or Username",placeholderTextColor:j.placeholder.color,selectionColor:e.constants.Colors.PRIMARY_DARK_100,onSubmitEditing:f,returnKeyType:"done",style:j.input}),trailing:React.createElement(it,{onPress:f},Be(Et,!0))})))))}const bt=v.findByName("CustomColorPickerActionSheet"),{ScrollView:St,View:$,Text:Le,TouchableOpacity:$e,TextInput:ra,Pressable:sa,Image:mt}=L.General,{FormLabel:oa,FormIcon:W,FormArrow:la,FormRow:X,FormSwitch:ne,FormSwitchRow:ia,FormSection:J,FormDivider:k,FormInput:Ct,FormSliderRow:xe}=L.Forms,x=e.stylesheet.createThemedStyleSheet({text:{color:F.semanticColors.HEADER_SECONDARY,paddingLeft:"5.5%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:e.constants.Fonts.PRIMARY_BOLD,fontSize:16},subText:{color:F.semanticColors.TEXT_POSITIVE,paddingLeft:"6%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,fontSize:12},input:{fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM,color:F.semanticColors.TEXT_NORMAL},placeholder:{color:F.semanticColors.INPUT_PLACEHOLDER_TEXT},container:{flex:1,justifyContent:"center",alignItems:"center"},colorPreview:{width:"75%",height:100,marginBottom:20},row:{flexDirection:"row",height:80,width:"90%",marginBottom:20},border:{borderRadius:12}}),pt=_.getAssetIDByName("ic_add_24px");v.findByProps("getUser");const It=v.findByName("useIsFocused"),Ue=[{id:"enableMD",default:!0,label:"Toggle Message Delete",subLabel:"Logs deleted message"},{id:"enableMU",default:!0,label:"Toggle Message Update",subLabel:"Logs edited message"}],ke=[{id:"minimalistic",default:!0,label:"Minimalistic Settings",subLabel:"Removes all Styling (Enabled by Default)"},{id:"useBackgroundColor",default:!1,label:"Enable Background Color",subLabel:"Background Color for Deleted Message, similiar to Mention but Customizeable"},{id:"ignoreBots",default:!1,label:"Ignore Bots",subLabel:"Ignore bot deleted messages."},{id:"removeDismissButton",default:!1,label:"Remove Dissmiss Message",subLabel:"Remove clickable Dismiss Message text from deleted ephemeral messages."},{id:"addTimestampForEdits",default:!1,label:"Add Edit Timestamp",subLabel:"Add Timestamp for edited messages."}],Oe=[{id:"textColor",label:"Deleted Message Text Color",subLabel:"Click to customize Deleted Message Text Color",defaultColor:"#E40303"},{id:"backgroundColor",label:"Deleted Message Background Color",subLabel:"Click to customize Background Color",defaultColor:"#FF2C2F"},{id:"gutterColor",label:"Deleted Message Background Gutter Color",subLabel:"Click to customize Background Gutter Color",defaultColor:"#FF2C2F"}],ze=[{id:"deletedMessageBuffer",title:"Customize Deleted Message",type:"default",placeholder:"This message is deleted"},{id:"editedMessageBuffer",title:"Customize Edited Separator",type:"default",placeholder:"`[ EDITED ]`"},{id:"historyToast",title:"Customize Remove History Toast Message",type:"default",placeholder:"History Removed"}];function re(n){n=Number(n);const r=Math.min(Math.max(n,0),100),a=Math.round(r/100*255).toString(16).toUpperCase();return a.length===1?"0"+a:a}function Ge(n){const r=parseInt(n,16);return isNaN(r)?0:Math.round(r/255*100)}const U={toPercentage:function(n){return n=Number(n),n===0?0:n===1?100:Math.round(n*100)},toDecimal:function(n){n=Number(n);const r=Math.min(Math.max(n,0),100);return r===0?0:r===100?1:r/100},formatDecimal:function(n){return n=Number(n),n===0||n===1?n:n.toFixed(2)}};function ve(){var n,r,a,g,i,f,d,p,I,w,D,u,y,h,l;ie.useProxy(t.storage);const[c,s]=e.React.useState(U.toDecimal(Ge(t.storage===null||t.storage===void 0||(n=t.storage.colors)===null||n===void 0?void 0:n.backgroundColorAlpha)??100)),[R,E]=e.React.useState(U.toDecimal(Ge(t.storage===null||t.storage===void 0||(r=t.storage.colors)===null||r===void 0?void 0:r.gutterColorAlpha)??100)),b=e.NavigationNative.useNavigation();It();const C=function(){b.push("VendettaCustomPage",{title:"List of Ignored Users",render:function(){return e.React.createElement(yt,null)}})};return e.React.createElement(St,null,e.React.createElement($,{style:{marginTop:20,marginBottom:20}},e.React.createElement(J,{title:"Plugin Setting",style:[x.header]},e.React.createElement(X,{label:"Customization",subLabel:"Show customization for the plugin",leading:e.React.createElement(W,{style:{opacity:1},source:_.getAssetIDByName("ic_category_16px")}),trailing:e.React.createElement(ne,{value:(t.storage===null||t.storage===void 0||(a=t.storage.switches)===null||a===void 0?void 0:a.customizeable)??!1,onValueChange:function(o){return t.storage.switches.customizeable=o}})}),(t.storage===null||t.storage===void 0||(g=t.storage.switches)===null||g===void 0?void 0:g.customizeable)&&e.React.createElement(e.React.Fragment,null,e.React.createElement(J,{title:"Patches"}),e.React.createElement(k,null)),(t.storage===null||t.storage===void 0||(i=t.storage.switches)===null||i===void 0?void 0:i.customizeable)&&e.React.createElement(e.React.Fragment,null,e.React.createElement($,{style:[x.subText]},Ue?.map(function(o,S){return e.React.createElement(e.React.Fragment,null,e.React.createElement(X,{label:o?.label,subLabel:o?.subLabel,leading:o?.icon&&e.React.createElement(W,{style:{opacity:1},source:_.getAssetIDByName(o?.icon)}),trailing:"id"in o?e.React.createElement(ne,{value:(t.storage===null||t.storage===void 0?void 0:t.storage.switches[o?.id])??o?.default,onValueChange:function(N){return t.storage.switches[o?.id]=N}}):void 0}),S!==Ue?.length-1&&e.React.createElement(k,null))}))),(t.storage===null||t.storage===void 0||(f=t.storage.switches)===null||f===void 0?void 0:f.customizeable)&&e.React.createElement(e.React.Fragment,null,e.React.createElement(J,{title:"Switches"}),e.React.createElement(k,null)),(t.storage===null||t.storage===void 0||(d=t.storage.switches)===null||d===void 0?void 0:d.customizeable)&&e.React.createElement(e.React.Fragment,null,e.React.createElement($,{style:[x.subText]},ke?.map(function(o,S){return e.React.createElement(e.React.Fragment,null,e.React.createElement(X,{label:o?.label,subLabel:o?.subLabel,leading:o?.icon&&e.React.createElement(W,{style:{opacity:1},source:_.getAssetIDByName(o?.icon)}),trailing:"id"in o?e.React.createElement(ne,{value:(t.storage===null||t.storage===void 0?void 0:t.storage.switches[o?.id])??o?.default,onValueChange:function(N){return t.storage.switches[o?.id]=N}}):void 0}),S!==ke?.length-1&&e.React.createElement(k,null))}))),(t.storage===null||t.storage===void 0||(p=t.storage.switches)===null||p===void 0?void 0:p.customizeable)&&e.React.createElement(e.React.Fragment,null,e.React.createElement(J,{title:"Text Variables"}),e.React.createElement(k,null)),(t.storage===null||t.storage===void 0||(I=t.storage.switches)===null||I===void 0?void 0:I.customizeable)&&e.React.createElement(e.React.Fragment,null,e.React.createElement($,{style:[x.subText]},ze?.map(function(o,S){return e.React.createElement(e.React.Fragment,null,e.React.createElement(Ct,{title:o?.title,keyboardType:o?.type,placeholder:o?.placeholder,value:(t.storage===null||t.storage===void 0?void 0:t.storage.inputs[o.id])??o?.placeholder,onChange:function(N){return t.storage.inputs[o.id]=N.toString()}}),S!==ze.length-1&&e.React.createElement(k,null))}))),(t.storage===null||t.storage===void 0||(w=t.storage.switches)===null||w===void 0?void 0:w.customizeable)&&e.React.createElement(e.React.Fragment,null,e.React.createElement(J,{title:"Color Pickers"}),e.React.createElement(k,null)),(t.storage===null||t.storage===void 0||(D=t.storage.switches)===null||D===void 0?void 0:D.customizeable)&&e.React.createElement(e.React.Fragment,null,e.React.createElement($,{style:[x.subText]},Oe?.map(function(o){var S;const N=function(){var P;return _e(bt,{color:De==null||(P=te)===null||P===void 0?void 0:P.toInt(t.storage.colors[o.id]||o?.defaultColor||"#000"),onSelect:function(B){var m;const O=De==null||(m=te)===null||m===void 0?void 0:m.toHex(B);t.storage.colors[o.id]=O}})};return e.React.createElement(e.React.Fragment,null,e.React.createElement(X,{label:o?.label,subLabel:o?.subLabel||"Click to Update",onPress:N,trailing:e.React.createElement($e,{onPress:N},e.React.createElement(mt,{source:{uri:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mJsrQAAAgwBAJ9P6qYAAAAASUVORK5CYII="},style:{width:32,height:32,borderRadius:10,backgroundColor:(t.storage===null||t.storage===void 0?void 0:t.storage.colors[o.id])||((S=Oe.find(function(P){return P?.id==o?.id}))===null||S===void 0?void 0:S.defaultColor)||"#000"}}))}))}))),(t.storage===null||t.storage===void 0||(u=t.storage.switches)===null||u===void 0?void 0:u.customizeable)&&e.React.createElement(e.React.Fragment,null,e.React.createElement($,{style:[x.subText]},e.React.createElement($,{style:x.container},e.React.createElement(X,{style:{justifyContent:"center",alignItems:"center"},label:`Preview Style: ${!(t.storage===null||t.storage===void 0||(y=t.storage.switches)===null||y===void 0)&&y.darkMode?"Light":"Dark"} Mode`,subLabel:"Click to Switch Mode",trailing:e.React.createElement(ne,{value:(t.storage===null||t.storage===void 0||(h=t.storage.switches)===null||h===void 0?void 0:h.darkMode)??!0,onValueChange:function(o){return t.storage.switches.darkMode=o}})}),e.React.createElement($,{style:[x.row,x.border,{overflow:"hidden",marginRight:10}]},e.React.createElement($,{style:{width:"2%",backgroundColor:`${t.storage.colors.gutterColor}${re(U.toPercentage(R))}`}}),e.React.createElement($,{style:{flex:1,backgroundColor:`${t.storage.colors.backgroundColor}${re(U.toPercentage(c))}`,justifyContent:"center",alignItems:"center"}},e.React.createElement(Le,{style:{fontSize:20,color:!(t.storage===null||t.storage===void 0||(l=t.storage.switches)===null||l===void 0)&&l.darkMode?"black":"white"}}," Low Effort Normal Example Message "),e.React.createElement(Le,{style:{fontSize:20,color:t.storage.colors.textColor||"#000000"}}," Low Effort Deleted Example Message "))),e.React.createElement(xe,{label:`Background Color Alpha: ${U.toPercentage(c)}%`,value:c,style:{width:"90%"},onValueChange:function(o){s(Number(U.formatDecimal(o))),t.storage.colors.backgroundColorAlpha=re(U.toPercentage(o))}}),e.React.createElement(k,null),e.React.createElement(xe,{label:`Background Gutter Alpha: ${U.toPercentage(R)}%`,value:R,style:{width:"90%"},onValueChange:function(o){E(Number(U.formatDecimal(o))),t.storage.colors.gutterColorAlpha=re(U.toPercentage(o))}}))))),e.React.createElement(J,{title:"Ignore List Setting",style:[x.header]},e.React.createElement(X,{label:"Add User to List",subLabel:"List of ignored users for the plugin",leading:e.React.createElement(W,{style:{opacity:1},source:_.getAssetIDByName("ic_members")}),onPress:C,trailing:e.React.createElement($e,{onPress:C},e.React.createElement(W,{style:{opacity:1},source:pt}))}),e.React.createElement(k,null))))}v.findByProps("openLazy","hideActionSheet");const Ee=v.findByProps("getChannel","getDMFromUserId"),At=v.findByProps("_channelMessages"),_t=v.findByProps("getMessage","getMessages");function wt(n){return M.before("dispatch",e.FluxDispatcher,function(r){const[a]=r,g=a?.type;if(g=="MESSAGE_DELETE"){var i,f,d,p,I,w,D,u,y,h,l,c;if(t.storage.switches.enableMD==!1||a?.otherPluginBypass)return r;const T=At.get(a.channelId),A=T?.get(a.id);if(!A||a?.id&&((i=n[a?.id])===null||i===void 0?void 0:i.stage)==2)return r;if(a?.id&&((f=n[a?.id])===null||f===void 0?void 0:f.stage)==1){var s;return n[a?.id].stage=2,((s=n[a?.id])===null||s===void 0?void 0:s.message)??r}const Ce=A==null||(d=A.author)===null||d===void 0?void 0:d.id,pe=A==null||(p=A.author)===null||p===void 0?void 0:p.username,K=!A?.content&&(A==null||(I=A.attachments)===null||I===void 0?void 0:I.length)==0&&(A==null||(w=A.embeds)===null||w===void 0?void 0:w.length)==0;return!Ce||!pe||K||!(t.storage===null||t.storage===void 0||(D=t.storage.switches)===null||D===void 0)&&D.ignoreBots&&!(A==null||(u=A.author)===null||u===void 0)&&u.bot||(t.storage===null||t.storage===void 0||(h=t.storage.inputs)===null||h===void 0||(y=h.ignoredUserList)===null||y===void 0?void 0:y.length)>0&&!((l=t.storage.inputs.ignoredUserList)===null||l===void 0)&&l.some(function(se){var Y;return se?.id==(A==null||(Y=A.author)===null||Y===void 0?void 0:Y.id)||se.username==A.author.username})||(r[0]={type:"MESSAGE_UPDATE",channelId:A?.channel_id||a?.channelId,message:{...A,content:A?.content,type:0,flags:64,channel_id:A?.channel_id||a?.channelId,guild_id:Ee==null||(c=Ee.getChannel(A?.channel_id))===null||c===void 0?void 0:c.guild_id,timestamp:`${new Date().toJSON()}`,state:"SENT",was_deleted:!0},optimistic:!1,sendMessageOptions:{},isPushNotification:!1},n[a?.id||A?.id]={message:r,stage:1}),r}if(g=="MESSAGE_UPDATE"){var R,E,b,C,o,S,N,P,B,m,O,V,H,Q,z,Z,ye,be;if(t.storage.switches.enableMU==!1||a?.otherPluginBypass||!(a==null||(E=a.message)===null||E===void 0||(R=E.author)===null||R===void 0)&&R.bot)return r;const T=_t.getMessage((a==null||(b=a.message)===null||b===void 0?void 0:b.channel_id)||a?.channelId,(a==null||(C=a.message)===null||C===void 0?void 0:C.id)||a?.id),A=T==null||(o=T.author)===null||o===void 0?void 0:o.id,Ce=T==null||(S=T.author)===null||S===void 0?void 0:S.username,pe=!T?.content&&(T==null||(N=T.attachments)===null||N===void 0?void 0:N.length)==0&&(T==null||(P=T.embeds)===null||P===void 0?void 0:P.length)==0;if(!T||!A||!Ce||pe||!(!(a==null||(B=a.message)===null||B===void 0)&&B.content)||!T?.content||(a==null||(m=a.message)===null||m===void 0?void 0:m.content)==T?.content||(t.storage===null||t.storage===void 0||(V=t.storage.inputs)===null||V===void 0||(O=V.ignoredUserList)===null||O===void 0?void 0:O.length)>0&&!(t.storage===null||t.storage===void 0||(Q=t.storage.inputs)===null||Q===void 0||(H=Q.ignoredUserList)===null||H===void 0)&&H.some(function(oe){var q,Ie;return oe?.id==(T==null||(q=T.author)===null||q===void 0?void 0:q.id)||oe?.username==(T==null||(Ie=T.author)===null||Ie===void 0?void 0:Ie.username)}))return r;let K=(t.storage===null||t.storage===void 0||(z=t.storage.inputs)===null||z===void 0?void 0:z.editedMessageBuffer)||"`[ EDITED ]`";K=K+`

`;const se=a?.message||T;let Y=`${T?.content}`;if(!(t.storage===null||t.storage===void 0||(Z=t.storage.switches)===null||Z===void 0)&&Z.addTimestampForEdits){var Se;const oe=Date.now(),q=`<t:${Math.abs(Math.round(oe/1e3))}:R>`;Y+=`  (${q}) ${K}${(a==null||(Se=a.message)===null||Se===void 0?void 0:Se.content)??""}`}else{var me;Y+=`  ${K}${(a==null||(me=a.message)===null||me===void 0?void 0:me.content)??""}`}return r[0]={type:"MESSAGE_UPDATE",message:{...se,content:Y,guild_id:(ye=Ee.getChannel(a?.channelId||(a==null||(be=a.message)===null||be===void 0?void 0:be.channel_id)||T?.channel_id))===null||ye===void 0?void 0:ye.guild_id,edited_timestamp:"invalid_timestamp"}},r}return r})}const Dt=v.findByProps("startEditMessage");function Nt(){return M.before("startEditMessage",Dt,function(n){var r;let a=(t.storage===null||t.storage===void 0||(r=t.storage.inputs)===null||r===void 0?void 0:r.editedMessageBuffer)||"`[ EDITED ]`";a=a+`

`;const[g,i,f]=n,d=f.split(a);return n[2]=d[d.length-1],n})}const{DCDChatManager:Tt}=e.ReactNative.NativeModules;function Ft(n){return M.before("updateRows",Tt,function(r){var a;let g=JSON.parse(r[1]);const{textColor:i,backgroundColor:f,backgroundColorAlpha:d,gutterColor:p,gutterColorAlpha:I}=t.storage.colors,w=(a=t.storage.inputs)===null||a===void 0?void 0:a.deletedMessageBuffer,{useBackgroundColor:D,minimalistic:u,removeDismissButton:y}=t.storage.switches;function h(s,R){s||(s=R);const E=s?.trim();if(E.startsWith("#")){const b=E.slice(1);if(/^[0-9A-Fa-f]{6}$/.test(b))return"#"+b.toUpperCase()}else if(/^[0-9A-Fa-f]{6}$/.test(E))return"#"+E.toUpperCase();return R||"#000"}function l(s,R){const E=R?.toString(),b=["text","heading","s","u","em","strong","list","blockQuote"];if(Array.isArray(s))return s.map(function(C){return l(C,E)});if(typeof s=="object"&&s!==null){const{content:C,type:o,target:S,items:N}=s;if(!b.includes(o))return s;if(o==="text"&&C&&C.length>=1)return{content:[{content:C,type:"text"}],target:"usernameOnClick",type:"link",context:{username:1,medium:!0,usernameOnClick:{action:"0",userId:"0",linkColor:e.ReactNative.processColor(E),messageChannelId:"0"}}};const P=l(C,E),B=N?N.map(l,E):void 0;if(P!==C||B!==N||!b.includes(o)){const m={...s,content:P};return o==="blockQuote"&&S&&(m.content=P,m.target=S),o==="list"&&m?.content&&delete m.content,N&&(m.items=B),m}}return s}function c(s,R,E){return s&&(R!=null&&(s.content[0].content[0].content=R+"  "),E==null&&s.content[0].content.splice(1)),s}return g.forEach(function(s){if(s?.type==1){var R;if(n[s==null||(R=s.message)===null||R===void 0?void 0:R.id]){if((w?.length>0||w!="")&&(s.message.edited=w),u==!1){var E;const b=h(i,"#E40303"),C=l(s==null||(E=s.message)===null||E===void 0?void 0:E.content,b);s.message.content=C}if(y&&(s.message.ephemeralIndication=c(s.message.ephemeralIndication,void 0,void 0)),u==!1&&D==!0){const b=h(`${f}`,"#FF2C2F"),C=h(`${p}`,"#FF2C2F");s.backgroundHighlight??={},s.backgroundHighlight={backgroundColor:e.ReactNative.processColor(`${b}${d}`),gutterColor:e.ReactNative.processColor(`${C}${I}`)}}}}}),r[1]=JSON.stringify(g),r[1]})}const Mt=v.findByProps("updateMessageRecord","createMessageRecord");function Pt(){return M.after("createMessageRecord",Mt,function(n,r){let[a]=n;r.was_deleted=a.was_deleted})}const Bt=v.findByName("MessageRecord",!1);function Lt(){return M.after("default",Bt,function(n,r){let[a]=n;r.was_deleted=!!a.was_deleted})}const Ve=v.findByProps("updateMessageRecord","createMessageRecord");function $t(){return M.instead("updateMessageRecord",Ve,function(n,r){let[a,g]=n;return g.was_deleted?Ve.createMessageRecord(g,a.reactions):r.apply(this,[a,g])})}const{FormSection:xt}=L.Forms,Ut=v.findByName("getScreens"),kt=v.findByName("UserSettingsOverviewWrapper",!1),Ot=e.stylesheet.createThemedStyleSheet({container:{flex:1,backgroundColor:F.semanticColors.BACKGROUND_MOBILE_PRIMARY}});function zt(n,r,a){const g=[],i=M.after("default",kt,function(f,d){i();const p=ee.findInReactTree(d.props.children,function(I){return I.type&&I.type.name==="UserSettingsOverview"});g.push(M.after("render",p.type.prototype,function(I,w){let{props:{children:D}}=w;const u=[e.i18n.Messages.BILLING_SETTINGS,e.i18n.Messages.PREMIUM_SETTINGS];D=ee.findInReactTree(D,function(h){return h.children[1].type===xt}).children;const y=D.findIndex(function(h){return u.includes(h?.props.label)});n()&&D.splice(y===-1?4:y,0,r({}))}))},!0);if(g.push(i),Ut&&a){const f=`VENDETTA_PLUGIN_${e.lodash.snakeCase(a.key).toUpperCase()}`,d=a.page.render,p=e.React.memo(function(u){let{navigation:y}=u;const h=y.addListener("focus",function(){h(),y.setOptions(ee.without(a.page,"noErrorBoundary","render"))});return e.React.createElement(e.ReactNative.View,{style:Ot.container},a.page.noErrorBoundary?e.React.createElement(d,null):e.React.createElement(L.ErrorBoundary,null,e.React.createElement(d,null)))}),I={[f]:{type:"route",title:function(){return a.title},icon:a.icon,parent:null,screen:{route:`VendettaPlugin${e.lodash.chain(a.key).camelCase().upperFirst().value()}`,getComponent:function(){return p}}}},w=function(u,y){var h,l;const c=[...u],s=y?c==null||(h=c[0])===null||h===void 0?void 0:h.sections:c;if(!Array.isArray(s))return s;const R="Vendetta",E=s.find(function(b){return b?.title===R||b?.label===R});return E&&!(!(E==null||(l=E.settings)===null||l===void 0)&&l.includes(f))&&E.settings.push(f),c},D=function(){const u=v.findByProps("useOverviewSettings"),y=v.findByProps("getSettingTitleConfig"),h=v.findByProps("SETTING_RELATIONSHIPS","SETTING_RENDERER_CONFIGS"),l="getSettingSearchListItems",c="getSettingListItems",s=v.findByProps(l),R=s?l:c,E=s??v.findByProps(c);if(!E||!u)return!1;g.push(M.after("useOverviewSettings",u,function(o,S){return w(S)})),g.push(M.after("getSettingTitleConfig",y,function(o,S){return{...S,[f]:a.title}})),g.push(M.after(R,E,function(o,S){let[N]=o;return[...N.includes(f)?[{type:"setting_search_result",ancestorRendererData:I[f],setting:f,title:function(){return a.title},breadcrumbs:["Vendetta"],icon:I[f].icon}]:[],...S]}));const b=h.SETTING_RELATIONSHIPS,C=h.SETTING_RENDERER_CONFIGS;return h.SETTING_RELATIONSHIPS={...b,[f]:null},h.SETTING_RENDERER_CONFIGS={...C,...I},g.push(function(){h.SETTING_RELATIONSHIPS=b,h.SETTING_RENDERER_CONFIGS=b}),!0};(function(){const u=v.findByProps("SearchableSettingsList"),y=v.findByProps("SETTING_RENDERER_CONFIG"),h=v.findByProps("getSettingListItems");if(!h||!u||!y)return!1;g.push(M.before("type",u.SearchableSettingsList,function(c){return w(c,!0)})),g.push(M.after("getSettingListSearchResultItems",h,function(c,s){for(const R of s)R.setting===f&&(R.breadcrumbs=["Vendetta"])}));const l=y.SETTING_RENDERER_CONFIG;return y.SETTING_RENDERER_CONFIG={...l,...I},g.push(function(){y.SETTING_RENDERER_CONFIG=l}),!0})()||D()}return function(){return g.forEach(function(f){return f()})}}const{FormRow:Re}=L.Forms;function Gt(){const n=e.NavigationNative.useNavigation();return React.createElement(L.ErrorBoundary,null,React.createElement(Re,{label:"Antied",leading:React.createElement(Re.Icon,{source:_.getAssetIDByName("ic_edit_24px")}),trailing:Re.Arrow,onPress:function(){return n.push("VendettaCustomPage",{title:"Antied",render:ve})}}))}function Vt(){const n=[];return n.push(zt(function(){return!0},function(){return React.createElement(Gt,null)},{key:Ae.plugin.manifest.name,icon:_.getAssetIDByName("ic_edit_24px"),title:"Anti Edit & Delete",page:{title:"Antied",render:ve}})),function(){return n.forEach(function(r){return r()})}}const He=v.findByProps("openLazy","hideActionSheet"),Ht=v.findByProps("getMessage","getMessages"),Yt=v.findByProps("getChannel","getDMFromUserId"),Ye=v.findByProps("_channelMessages"),{FormRow:jt,FormIcon:Xt}=L.Forms;ce(t.storage,{switches:{customizeable:!1,enableMD:!0,enableMU:!0,useBackgroundColor:!1,ignoreBots:!1,minimalistic:!0,alwaysAdd:!1,darkMode:!0,removeDismissButton:!1,addTimestampForEdits:!1,timestampStyle:"R"},colors:{textColor:"#E40303",backgroundColor:"#FF2C2F",backgroundColorAlpha:"33",gutterColor:"#FF2C2F",gutterColorAlpha:"CC"},inputs:{deletedMessageBuffer:"This message is deleted",editedMessageBuffer:"`[ EDITED ]`",historyToast:"History Removed",ignoredUserList:[]}});let je=[],Xe={};var Jt={onLoad:function(){je.push(Vt(),wt(Xe),Ft(Xe),Nt(),Pt(),Lt(),$t(),M.before("openLazy",He,function(n){let[r,a,g]=n;const i=g?.message;a!=="MessageLongPressActionSheet"||!i||r.then(function(f){const d=M.after("default",f,function(p,I){var w;e.React.useEffect(function(){return function(){d()}},[]);const D=ee.findInReactTree(I,function(l){var c,s;return(l==null||(s=l[0])===null||s===void 0||(c=s.type)===null||c===void 0?void 0:c.name)==="ButtonRow"});if(!D)return I;const u=Math.max(D.findIndex(function(l){var c,s;return(l==null||(c=l.props)===null||c===void 0?void 0:c.message)===(e.i18n===null||e.i18n===void 0||(s=e.i18n.Messages)===null||s===void 0?void 0:s.MESSAGE_ACTION_REPLY)}),0),y=Ht.getMessage(i.channel_id,i?.id),h=function(l){return l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}((t.storage===null||t.storage===void 0||(w=t.storage.inputs)===null||w===void 0?void 0:w.editedMessageBuffer)||"`[ EDITED ]`");if(new RegExp(h,"gmi").test(i.content)){const l=u||1;D.splice(l,0,e.React.createElement(jt,{label:"Remove Edit History",leading:e.React.createElement(Xt,{style:{opacity:1},source:_.getAssetIDByName("ic_edit_24px")}),onPress:function(){var c,s,R,E,b,C;let o=(t.storage===null||t.storage===void 0||(c=t.storage.inputs)===null||c===void 0?void 0:c.editedMessageBuffer)||"`[ EDITED ]`";o=o+`

`;const S=i==null||(s=i.content)===null||s===void 0?void 0:s.split(o),N=S[S.length-1],P=i==null||(R=i.embeds)===null||R===void 0?void 0:R.map(function(m){var O,V,H;const Q=m==null||(H=m.color)===null||H===void 0||(V=H.replace(/.+\(/,""))===null||V===void 0||(O=V.replace(/\%/g,""))===null||O===void 0?void 0:O.replace(")",""),z=Q?.split(", "),Z=e.ReactNative.processColor(`${we(te.HSLtoHEX(z[0],z[1],z[2]),z[3])}`);return{...m,author:m.author,title:m.rawTitle,description:m.rawDescription,url:m.url,type:m.type,image:m.image,thumbnail:m.thumbnail,color:Z,content_scan_version:1}});if(e.FluxDispatcher.dispatch({type:"MESSAGE_UPDATE",message:{...i,content:`${N}`,embeds:P??[],attachments:i.attachments??[],mentions:i.mentions??[],guild_id:Yt.getChannel(y.channel_id).guild_id},otherPluginBypass:!0}),He.hideActionSheet(),(t.storage===null||t.storage===void 0||(b=t.storage.inputs)===null||b===void 0||(E=b.historyToast)===null||E===void 0?void 0:E.length)>0||(t.storage===null||t.storage===void 0||(C=t.storage.inputs)===null||C===void 0?void 0:C.historyToast)!=""){var B;de.showToast(`[ANTI ED] ${t.storage===null||t.storage===void 0||(B=t.storage.inputs)===null||B===void 0?void 0:B.historyToast}`,_.getAssetIDByName("ic_edit_24px"))}}}))}})})}))},onUnload:function(){for(const n of je)n();for(const n in Ye._channelMessages)for(const r of Ye._channelMessages[n]._array)r.was_deleted&&e.FluxDispatcher.dispatch({type:"MESSAGE_DELETE",id:r.id,channelId:r.channel_id,otherPluginBypass:!0})},settings:ve};return le.default=Jt,Object.defineProperty(le,"__esModule",{value:!0}),le})({},vendetta,vendetta.metro,vendetta.plugin,vendetta.storage,vendetta.ui.components,vendetta.ui.assets,vendetta.metro.common,vendetta.ui,vendetta.ui.toasts,vendetta.ui.alerts,vendetta.patcher,vendetta.utils);
