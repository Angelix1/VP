(function(z,we,g,s,V,w,R,e,E,Y,Ie,I,Z){"use strict";const{openLazy:Be,hideActionSheet:At}=g.findByProps("openLazy","hideActionSheet");function ee(a,n){if(a!=null&&n!=null)for(const t of Object.keys(n))typeof n[t]=="object"&&!Array.isArray(n[t])?(typeof a[t]!="object"&&(a[t]={}),ee(a[t],n[t])):a[t]??=n[t]}function De(a,n){try{Be(new Promise(function(t){return t({default:a})}),"ActionSheet",n)}catch(t){we.logger.error(t.stack),showToast("Got error when opening ActionSheet! Please check debug logs")}}const te={toInt(a){return a=a.replace(/^#/,""),parseInt(a,16)},toHex(a){return"#"+a.toString(16).toUpperCase()}},{ScrollView:Fe,View:G,Text:_e,TouchableOpacity:ae,TextInput:St,Image:Pe,Animated:x}=w.General,{FormLabel:Me,FormIcon:Te,FormArrow:wt,FormRow:H,FormSwitch:Le,FormSwitchRow:It,FormSection:Ne,FormDivider:ve,FormInput:ne}=w.Forms,xe=g.findByName("useIsFocused");g.findByProps("BottomSheetScrollView");const re=g.findByStoreName("UserStore"),se=g.findByProps("showUserProfile");R.getAssetIDByName("ic_add_24px"),R.getAssetIDByName("ic_arrow"),R.getAssetIDByName("ic_minus_circle_24px"),R.getAssetIDByName("Check"),R.getAssetIDByName("Small");function oe(a){return e.React.createElement(Te,{style:{opacity:1},source:R.getAssetIDByName(a)})}const P=e.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:E.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"3%",fontSize:24},sub:{color:E.semanticColors.TEXT_POSITIVE,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:E.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16},container:{marginTop:25,marginLeft:"5%",marginBottom:-15,flexDirection:"row"},textContainer:{paddingLeft:15,paddingTop:5,flexDirection:"column",flexWrap:"wrap",shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:.2,shadowRadius:4.65,elevation:8},image:{width:75,height:75,borderRadius:10,shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:.2,shadowRadius:4.65,elevation:8},mainText:{opacity:.975,letterSpacing:.25},header:{color:E.semanticColors.HEADER_PRIMARY,fontFamily:e.constants.Fonts.DISPLAY_BOLD,fontSize:25,letterSpacing:.25},subHeader:{color:E.semanticColors.HEADER_SECONDARY,fontSize:12.75}});function ie(a){let{index:n}=a;V.useProxy(s.storage);let t=s.storage?.inputs?.ignoredUserList[n];const d=e.React.useRef(new x.Value(1)).current,r=function(){return x.spring(d,{toValue:1.1,duration:10,useNativeDriver:!0}).start()},f=function(){return x.spring(d,{toValue:1,duration:250,useNativeDriver:!0}).start()},o={transform:[{scale:d}]};let l=re.getUser(t?.id),u=Object.values(re.getUsers());l||(l=u.find(function(p){return p?.username==t?.username})),l||(l=u.find(function(p){return p?.username?.toLowerCase()==t?.username?.toLowerCase()}));const C=e.NavigationNative.useNavigation();return xe(),e.React.createElement(e.React.Fragment,null,e.React.createElement(Fe,null,e.React.createElement(G,{style:[P.basicPad,P.sub]},e.React.createElement(Ne,{title:"User Setting",style:[P.header]},e.React.createElement(H,{label:"Find User Id or Username",leading:oe("ic_search"),onPress:function(){l&&!t.username?.length?t.username=l.username:l&&!t.id?.length?t.id=l.id:Y.showToast("Cannot find User Id/Username.")}}),e.React.createElement(ne,{title:"User Username | Case Sensitive",placeholder:"Missing No",value:t?.username,onChange:function(p){return t.username=p}}),e.React.createElement(ne,{title:"User Id",placeholder:"Missing No",value:t?.id,onChange:function(p){return t.id=p}}),e.React.createElement(H,{label:"User is webhook?",subLabel:"User is webhook or system, and not BOT or Normal User.",leading:oe("ic_webhook_24px"),trailing:e.React.createElement(Le,{value:t?.isWebhook||!1,onValueChange:function(p){return t.isWebhook=p}})})),l&&e.React.createElement(G,{style:[P.container,{paddingBottom:10}]},e.React.createElement(ae,{onPress:function(){return se.showUserProfile?.({userId:l?.id})},onPressIn:r,onPressOut:f},e.React.createElement(x.View,{style:o},e.React.createElement(Pe,{source:{uri:l?.getAvatarURL?.()?.replace?.("webp","png")||"https://cdn.discordapp.com/embed/avatars/2.png"},style:{width:128,height:128,borderRadius:10}}))),e.React.createElement(G,{style:P.textContainer},e.React.createElement(ae,{onPress:function(){return se.showUserProfile({userId:l?.id})}},e.React.createElement(_e,{style:[P.mainText,P.header]},l?.username||t?.username||"No Name"))),e.React.createElement(ve,null)),e.React.createElement(H,{label:e.React.createElement(Me,{text:"Remove User from Ignore List",style:{color:E.rawColors.RED_400}}),onPress:function(){C.pop(),s.storage?.inputs?.ignoredUserList?.splice(n,1)}}))))}const{ScrollView:$e,View:Ue,Text:Bt,TouchableOpacity:ke,TextInput:Oe}=w.General,{FormLabel:Dt,FormIcon:ze,FormArrow:Ve,FormRow:j,FormSwitch:Ft,FormSwitchRow:_t,FormSection:Ye,FormDivider:Ge,FormInput:Pt}=w.Forms;function le(a,n){return React.createElement(ze,{style:{opacity:1},source:n?a:R.getAssetIDByName(a)})}const He=g.findByName("useIsFocused");g.findByProps("BottomSheetScrollView");const{getUser:je}=g.findByProps("getUser"),Xe=R.getAssetIDByName("ic_add_24px");R.getAssetIDByName("ic_arrow"),R.getAssetIDByName("ic_minus_circle_24px"),R.getAssetIDByName("Check"),R.getAssetIDByName("Small");const Ke=R.getAssetIDByName("ic_trash_24px"),L=e.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:E.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"3.5%",fontSize:24},sub:{color:E.semanticColors.TEXT_POSITIVE,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:E.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16},input:{fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM,color:E.semanticColors.TEXT_NORMAL},placeholder:{color:E.semanticColors.INPUT_PLACEHOLDER_TEXT}});function Qe(){V.useProxy(s.storage);let[a,n]=React.useState("");const t=e.NavigationNative.useNavigation();He();let d=s.storage?.inputs?.ignoredUserList??[];const r=function(){if(a){if(isNaN(parseInt(a)))d.push({id:void 0,username:a});else{let f=je(a);if(f)d.push({id:f?.id,username:"",showUser:!1,isWebhook:!1});else return Y.showToast("Invalid User Id")}n(""),t.push("VendettaCustomPage",{title:"Adding User to Ignore List",render:function(){return React.createElement(ie,{index:d?.length-1})}})}};return React.createElement(React.Fragment,null,React.createElement($e,{style:{flex:1}},React.createElement(Ye,{style:[L.header,L.basicPad]},React.createElement(Ue,{style:[L.header,L.sub]},d.length>0&&React.createElement(j,{label:"Clear List",trailing:le(Ke,!0),onPress:function(){d.length!==0&&Ie.showConfirmationAlert({title:"Hol up, wait a minute!",content:`This will removes in total ${d.length} users from ignore list.`,confirmText:"Ye",cancelText:"Nah",confirmColor:"brand",onConfirm:function(){s.storage.inputs.ignoredUserList=[]}})}}),d?.map(function(f,o){return React.createElement(React.Fragment,null,React.createElement(j,{label:f?.username||f?.id||"No Data",trailing:React.createElement(Ve,null),onPress:function(){return t.push("VendettaCustomPage",{title:"Editing User",render:function(){return React.createElement(ie,{index:o})}})}}),o!==d?.length-1&&React.createElement(Ge,null))}),React.createElement(j,{label:React.createElement(Oe,{value:a,onChangeText:n,placeholder:"User ID or Username",placeholderTextColor:L.placeholder.color,selectionColor:e.constants.Colors.PRIMARY_DARK_100,onSubmitEditing:r,returnKeyType:"done",style:L.input}),trailing:React.createElement(ke,{onPress:r},le(Xe,!0))})))))}const{StyleSheet:We,PanResponder:Je}=e.ReactNative,X=g.findByStoreName("ThemeStore"),{meta:{resolveSemanticColor:K}}=g.findByProps("colors","meta"),{View:Q}=w.General,{useState:qe,useRef:Ze}=e.React,W={sliderOff:K(X.theme,E.semanticColors.DEPRECATED_QUICKSWITCHER_INPUT_BACKGROUND),sliderOn:K(X.theme,E.semanticColors.REDESIGN_BUTTON_PRIMARY_BACKGROUND),thumb:K(X.theme,E.semanticColors.MENTION_FOREGROUND)},ce=function(a){let{onSlide:n,min:t,max:d,value:r}=a;const f=r||0,[o,l]=qe(0),u=Ze(null);function C(c){u.current&&u.current.measure(function(h,i,m,y,F,_){let T=(c-F)/(m-F)*100;const k=Math.min(Math.max(0,Math.round(T/1)*1),100);n&&n(k)})}const p=e.React.useRef(Je.create({onStartShouldSetPanResponder:function(c,h){return!0},onStartShouldSetPanResponderCapture:function(c,h){return!0},onMoveShouldSetPanResponder:function(c,h){return!0},onMoveShouldSetPanResponderCapture:function(c,h){return!0},onPanResponderGrant:function(c,h){C(h.x0)},onPanResponderMove:function(c,h){C(h.moveX)},onPanResponderTerminationRequest:function(c,h){return!0},onPanResponderRelease:function(c,h){},onPanResponderTerminate:function(c,h){},onShouldBlockNativeResponder:function(c,h){return!0}})).current;function D(c){l(c.nativeEvent.layout.width)}const b=We.create({container:{marginLeft:"5%",width:"80%",height:20,borderRadius:25,backgroundColor:W.sliderOff,marginBottom:25},slid:{width:f+"%",height:"100%",borderTopLeftRadius:25,borderBottomLeftRadius:25,borderRadius:f===100?25:0,backgroundColor:W.sliderOn,justifyContent:"center"},thumb:{height:"150%",aspectRatio:1,alignSelf:"flex-end",right:-(o/2),borderRadius:100,backgroundColor:W.thumb}});return e.React.createElement(Q,{style:b.container,...p.panHandlers,ref:u},e.React.createElement(Q,{style:b.slid},e.React.createElement(Q,{style:b.thumb,onLayout:D})))},et=g.findByName("CustomColorPickerActionSheet"),{ScrollView:tt,View:A,Text:de,TouchableOpacity:ue,TextInput:Mt,Pressable:Tt,Image:at}=w.General,{FormLabel:Lt,FormIcon:$,FormArrow:Nt,FormRow:M,FormSwitch:J,FormSwitchRow:vt,FormSection:v,FormDivider:B,FormInput:nt}=w.Forms,S=e.stylesheet.createThemedStyleSheet({text:{color:E.semanticColors.HEADER_SECONDARY,paddingLeft:"5.5%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:e.constants.Fonts.PRIMARY_BOLD,fontSize:16},subText:{color:E.semanticColors.TEXT_POSITIVE,paddingLeft:"6%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,fontSize:12},input:{fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM,color:E.semanticColors.TEXT_NORMAL},placeholder:{color:E.semanticColors.INPUT_PLACEHOLDER_TEXT},container:{flex:1,justifyContent:"center",alignItems:"center"},colorPreview:{width:"75%",height:100,marginBottom:20},row:{flexDirection:"row",height:80,width:"90%",marginBottom:20},border:{borderRadius:12}}),rt=R.getAssetIDByName("ic_add_24px");g.findByProps("getUser");const st=g.findByName("useIsFocused"),ge=[{id:"minimalistic",default:!0,label:"Minimalistic Settings",subLabel:"Removes all Styling (Enabled by Default)"},{id:"useBackgroundColor",default:!1,label:"Enable Background Color",subLabel:"Background Color for Deleted Message, similiar to Mention but Customizeable"},{id:"ignoreBots",default:!1,label:"Ignore Bots",subLabel:"Ignore bot deleted messages."},{id:"removeDismissButton",default:!1,label:"Remove Dissmiss Message",subLabel:"Remove clickable Dismiss Message text from deleted ephemeral messages."},{id:"addTimestampForEdits",default:!1,label:"Add Edit Timestamp",subLabel:"Add Timestamp for edited messages."}],fe=[{id:"textColor",label:"Deleted Message Text Color",subLabel:"Click to customize Deleted Message Text Color",defaultColor:"#E40303"},{id:"backgroundColor",label:"Deleted Message Background Color",subLabel:"Click to customize Background Color",defaultColor:"#FF2C2F"},{id:"gutterColor",label:"Deleted Message Background Gutter Color",subLabel:"Click to customize Background Gutter Color",defaultColor:"#FF2C2F"}],he=[{id:"deletedMessageBuffer",title:"Customize Deleted Message",type:"default",placeholder:"This message is deleted"},{id:"editedMessageBuffer",title:"Customize Edited Separator",type:"default",placeholder:"`[ EDITED ]`"}];function U(a){if(a<0)return"00";if(a>100)return"FF";{const n=Math.round(a/100*255).toString(16);return n.length===1?`0${n}`:n}}function Re(a){const n=parseInt(a,16);return isNaN(n)?0:Math.round(n/255*100)}function ot(){V.useProxy(s.storage);const[a,n]=e.React.useState(Re(s.storage?.colors?.backgroundColorAlpha)??100),[t,d]=e.React.useState(Re(s.storage?.colors?.gutterColorAlpha)??100),r=e.NavigationNative.useNavigation();st();const f=function(){r.push("VendettaCustomPage",{title:"List of Ignored Users",render:function(){return e.React.createElement(Qe,null)}})};return e.React.createElement(tt,null,e.React.createElement(A,{style:{marginTop:20,marginBottom:20}},e.React.createElement(v,{title:"Plugin Setting",style:[S.header]},e.React.createElement(M,{label:"Customization",subLabel:"Show customization for the plugin",leading:e.React.createElement($,{style:{opacity:1},source:R.getAssetIDByName("ic_category_16px")}),trailing:e.React.createElement(J,{value:s.storage?.switches?.customizeable??!1,onValueChange:function(o){return s.storage.switches.customizeable=o}})}),s.storage?.switches?.customizeable&&e.React.createElement(e.React.Fragment,null,e.React.createElement(v,{title:"Switches"}),e.React.createElement(B,null)),s.storage?.switches?.customizeable&&e.React.createElement(e.React.Fragment,null,e.React.createElement(A,{style:[S.subText]},ge?.map(function(o,l){return e.React.createElement(e.React.Fragment,null,e.React.createElement(M,{label:o?.label,subLabel:o?.subLabel,leading:o?.icon&&e.React.createElement($,{style:{opacity:1},source:R.getAssetIDByName(o?.icon)}),trailing:"id"in o?e.React.createElement(J,{value:s.storage?.switches[o?.id]??o?.default,onValueChange:function(u){return s.storage.switches[o?.id]=u}}):void 0}),l!==ge?.length-1&&e.React.createElement(B,null))}))),s.storage?.switches?.customizeable&&e.React.createElement(e.React.Fragment,null,e.React.createElement(v,{title:"Text Variables"}),e.React.createElement(B,null)),s.storage?.switches?.customizeable&&e.React.createElement(e.React.Fragment,null,e.React.createElement(A,{style:[S.subText]},he?.map(function(o,l){return e.React.createElement(e.React.Fragment,null,e.React.createElement(nt,{title:o?.title,keyboardType:o?.type,placeholder:o?.placeholder,value:s.storage?.inputs[o.id]??o?.placeholder,onChange:function(u){return s.storage.inputs[o.id]=u.toString()}}),l!==he.length-1&&e.React.createElement(B,null))}))),s.storage?.switches?.customizeable&&e.React.createElement(e.React.Fragment,null,e.React.createElement(v,{title:"Color Pickers"}),e.React.createElement(B,null)),s.storage?.switches?.customizeable&&e.React.createElement(e.React.Fragment,null,e.React.createElement(A,{style:[S.subText]},fe?.map(function(o){const l=function(){return De(et,{color:te?.toInt(s.storage.colors[o.id]||o?.defaultColor||"#000"),onSelect:function(u){const C=te?.toHex(u);s.storage.colors[o.id]=C}})};return e.React.createElement(e.React.Fragment,null,e.React.createElement(M,{label:o?.label,subLabel:o?.subLabel||"Click to Update",onPress:l,trailing:e.React.createElement(ue,{onPress:l},e.React.createElement(at,{source:{uri:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mJsrQAAAgwBAJ9P6qYAAAAASUVORK5CYII="},style:{width:32,height:32,borderRadius:10,backgroundColor:s.storage?.colors[o.id]||fe.find(function(u){return u?.id==o?.id})?.defaultColor||"#000"}}))}))}))),s.storage?.switches?.customizeable&&e.React.createElement(e.React.Fragment,null,e.React.createElement(A,{style:[S.subText]},e.React.createElement(A,{style:S.container},e.React.createElement(M,{style:{justifyContent:"center",alignItems:"center"},label:`Preview Style: ${s.storage?.switches?.darkMode?"Light":"Dark"} Mode`,subLabel:"Click to Switch Mode",trailing:e.React.createElement(J,{value:s.storage?.switches?.darkMode??!0,onValueChange:function(o){return s.storage.switches.darkMode=o}})}),e.React.createElement(A,{style:[S.row,S.border,{overflow:"hidden",marginRight:10}]},e.React.createElement(A,{style:{width:"2%",backgroundColor:`${s.storage.colors.gutterColor}${U(t)}`}}),e.React.createElement(A,{style:{flex:1,backgroundColor:`${s.storage.colors.backgroundColor}${U(a)}`,justifyContent:"center",alignItems:"center"}},e.React.createElement(de,{style:{fontSize:20,color:s.storage?.switches?.darkMode?"black":"white"}}," Low Effort Normal Example Message "),e.React.createElement(de,{style:{fontSize:20,color:s.storage.colors.textColor||"#000000"}}," Low Effort Deleted Example Message "))),e.React.createElement(B,null),e.React.createElement(M,{label:`Background Color Alpha: ${a}%`}),e.React.createElement(ce,{style:{marginBottom:0,marginRight:10},value:a,onSlide:function(o){n(o),s.storage.colors.backgroundColorAlpha=U(o)}}),e.React.createElement(B,null),e.React.createElement(M,{label:`Background Gutter Alpha: ${t}%`}),e.React.createElement(ce,{style:{marginBottom:0,marginRight:10},value:t,onSlide:function(o){d(o),s.storage.colors.gutterColorAlpha=U(o)}}))))),e.React.createElement(v,{title:"Ignore List Setting",style:[S.header]},e.React.createElement(M,{label:"Add User to List",subLabel:"List of ignored users for the plugin",leading:e.React.createElement($,{style:{opacity:1},source:R.getAssetIDByName("ic_members")}),onPress:f,trailing:e.React.createElement(ue,{onPress:f},e.React.createElement($,{style:{opacity:1},source:rt}))}),e.React.createElement(B,null))))}g.findByProps("openLazy","hideActionSheet");const Ee=g.findByProps("getChannel","getDMFromUserId"),pe=g.findByProps("_channelMessages");function it(a){return I.before("dispatch",e.FluxDispatcher,function(n){const[t]=n,d=t?.type;if(d=="MESSAGE_DELETE"){if(t?.otherPluginBypass)return n;const r=pe.get(t.channelId)?.get(t.id);if(!r||t?.id&&a[t?.id]?.stage==2)return n;if(t?.id&&a[t?.id]?.stage==1)return a[t?.id].stage=2,a[t?.id]?.message??n;const f=r?.author?.id,o=r?.author?.username,l=!r?.content&&r?.attachments?.length==0&&r?.embeds?.length==0;return!f||!o||l||s.storage?.switches?.ignoreBots&&r?.author?.bot||s.storage?.inputs?.ignoredUserList?.length>0&&s.storage.inputs.ignoredUserList?.some(function(u){return u?.id==r?.author?.id||u.username==r.author.username})||(n[0]={type:"MESSAGE_UPDATE",channelId:r?.channel_id||t?.channelId,message:{...r,content:r?.content,type:0,flags:64,channel_id:r?.channel_id||t?.channelId,guild_id:Ee?.getChannel(r?.channel_id)?.guild_id,timestamp:`${new Date().toJSON()}`,state:"SENT",was_deleted:!0},optimistic:!1,sendMessageOptions:{},isPushNotification:!1},a[t?.id||r?.id]={message:n,stage:1}),n}if(d=="MESSAGE_UPDATE"){if(t?.otherPluginBypass||t?.message?.author?.bot)return n;const r=pe.get(t?.message?.channel_id)?.get(t?.message?.id),f=r?.author?.id,o=r?.author?.username,l=!r?.content&&r?.attachments?.length==0&&r?.embeds?.length==0;if(!r||!f||!o||l)return n;const u=t?.message?.content==r?.content,C=t?.message?.embeds.some(function(i){return i?.url==r?.content||i?.thumbnail?.url==r?.content||r?.content.includes(i?.url)||r?.content.includes(i?.thumbnail?.url)}),p=t?.message?.embeds?.size||t?.message?.embeds?.length,D=r?.embeds?.size||r?.embeds?.length;if(u||C||!t?.message?.content&&p!=D||s.storage?.inputs?.ignoredUserList?.length>0&&s.storage.inputs.ignoredUserList?.some(function(i){return i?.id==r?.author?.id||i.username==r.author.username}))return n;let b=s.storage?.inputs?.editedMessageBuffer||"`[ EDITED ]`";b=b+`

`;const c=t?.message||r;let h=`${r?.content}`;if(s.storage?.switches?.addTimestampForEdits){const i=Date.now(),m=`<t:${Math.abs(Math.round(i/1e3))}:R>`;h+=`  (${m}) ${b}${t?.message?.content??""}`}else h+=`  ${b}${t?.message?.content??""}`;return n[0]={type:"MESSAGE_UPDATE",message:{...c,content:h,guild_id:Ee.getChannel(r?.channel_id)?.guild_id,edited_timestamp:"invalid_timestamp"}},n}})}const lt=g.findByProps("startEditMessage");function ct(){return I.before("startEditMessage",lt,function(a){let n=s.storage?.inputs?.editedMessageBuffer||"`[ EDITED ]`";n=n+`

`;const[t,d,r]=a,f=r.split(n);return a[2]=f[f.length-1],a})}const{DCDChatManager:dt}=e.ReactNative.NativeModules;function ut(a){return I.before("updateRows",dt,function(n){let t=JSON.parse(n[1]);const{textColor:d,backgroundColor:r,backgroundColorAlpha:f,gutterColor:o,gutterColorAlpha:l}=s.storage.colors,u=s.storage.inputs?.deletedMessageBuffer,{useBackgroundColor:C,minimalistic:p,removeDismissButton:D}=s.storage.switches;function b(i,m){i||(i=m);const y=i?.trim();if(y.startsWith("#")){const F=y.slice(1);if(/^[0-9A-Fa-f]{6}$/.test(F))return"#"+F.toUpperCase()}else if(/^[0-9A-Fa-f]{6}$/.test(y))return"#"+y.toUpperCase();return m||"#000"}function c(i,m){const y=m?.toString(),F=["text","heading","s","u","em","strong","list","blockQuote"];if(Array.isArray(i))return i.map(function(_){return c(_,y)});if(typeof i=="object"&&i!==null){const{content:_,type:T,target:k,items:O}=i;if(!F.includes(T))return i;if(T==="text"&&_&&_.length>=1)return{content:[{content:_,type:"text"}],target:"usernameOnClick",type:"link",context:{username:1,medium:!0,usernameOnClick:{action:"0",userId:"0",linkColor:e.ReactNative.processColor(y),messageChannelId:"0"}}};const q=c(_,y),Se=O?O.map(c,y):void 0;if(q!==_||Se!==O||!F.includes(T)){const N={...i,content:q};return T==="blockQuote"&&k&&(N.content=q,N.target=k),T==="list"&&N?.content&&delete N.content,O&&(N.items=Se),N}}return i}function h(i,m,y){return i&&(m!=null&&(i.content[0].content[0].content=m+"  "),y==null&&i.content[0].content.splice(1)),i}return t.forEach(function(i){if(i?.type==1&&a[i?.message?.id]){if(i.message.edited=u?.length>0?u:"This message is deleted",p==!1){const m=b(d,"#E40303"),y=c(i?.message?.content,m);i.message.content=y}if(D&&(i.message.ephemeralIndication=h(i.message.ephemeralIndication,void 0,void 0)),p==!1&&C==!0){const m=b(`${r}`,"#FF2C2F"),y=b(`${o}`,"#FF2C2F");i.backgroundHighlight={backgroundColor:e.ReactNative.processColor(`${m}${f}`),gutterColor:e.ReactNative.processColor(`${y}${l}`)}}}}),n[1]=JSON.stringify(t),n[1]})}const gt=g.findByProps("updateMessageRecord","createMessageRecord");function ft(){return I.after("createMessageRecord",gt,function(a,n){let[t]=a;n.was_deleted=t.was_deleted})}const ht=g.findByName("MessageRecord",!1);function Rt(){return I.after("default",ht,function(a,n){let[t]=a;n.was_deleted=!!t.was_deleted})}const me=g.findByProps("updateMessageRecord","createMessageRecord");function Et(){return I.instead("updateMessageRecord",me,function(a,n){let[t,d]=a;return d.was_deleted?me.createMessageRecord(d,t.reactions):n.apply(this,[t,d])})}const ye=g.findByProps("openLazy","hideActionSheet"),pt=g.findByProps("getMessage","getMessages"),mt=g.findByProps("getChannel","getDMFromUserId"),be=g.findByProps("_channelMessages"),{FormRow:yt,FormIcon:bt}=w.Forms;ee(s.storage,{switches:{customizeable:!1,useBackgroundColor:!1,ignoreBots:!1,minimalistic:!0,alwaysAdd:!1,darkMode:!0,removeDismissButton:!1,addTimestampForEdits:!1,timestampStyle:"R"},colors:{textColor:"#E40303",backgroundColor:"#FF2C2F",backgroundColorAlpha:"33",gutterColor:"#FF2C2F",gutterColorAlpha:"CC"},inputs:{deletedMessageBuffer:"This message is deleted",editedMessageBuffer:"`[ EDITED ]`",ignoredUserList:[]}});let Ce=[],Ae={};var Ct={onLoad:function(){Ce.push(it(Ae),ut(Ae),ct(),ft(),Rt(),Et(),I.before("openLazy",ye,function(a){let[n,t,d]=a;const r=d?.message;t!=="MessageLongPressActionSheet"||!r||n.then(function(f){const o=I.after("default",f,function(l,u){e.React.useEffect(function(){return function(){o()}},[]);const C=Z.findInReactTree(u,function(c){return c?.[0]?.type?.name==="ButtonRow"});if(!C)return u;const p=Math.max(C.findIndex(function(c){return c.props.message===e.i18n.Messages.MESSAGE_ACTION_REPLY}),0),D=pt.getMessage(r.channel_id,r?.id),b=function(c){return c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(s.storage?.inputs?.editedMessageBuffer||"`[ EDITED ]`");if(new RegExp(b,"gmi").test(r.content)){const c=Z.findInReactTree(u,function(h){return h?.[0]?.type?.name==="ButtonRow"});if(!c)return;c.splice(p,0,e.React.createElement(yt,{label:"Remove Edit History",subLabel:s.storage?.switches?.alwaysAdd?"(Added by alwaysAdd option)":void 0,leading:e.React.createElement(bt,{style:{opacity:1},source:R.getAssetIDByName("ic_edit_24px")}),onPress:function(){let h=s.storage?.inputs?.editedMessageBuffer||"`[ EDITED ]`";h=h+`

`;const i=r?.content?.split(h),m=i[i.length-1];e.FluxDispatcher.dispatch({type:"MESSAGE_UPDATE",message:{...D,content:`${m}`,guild_id:mt.getChannel(D.channel_id).guild_id},otherPluginBypass:!0}),ye.hideActionSheet(),Y.showToast("[ANTI ED] History Removed",R.getAssetIDByName("ic_edit_24px"))}}))}})})}))},onUnload:function(){for(const a of Ce)a();for(const a in be._channelMessages)for(const n of be._channelMessages[a]._array)n.was_deleted&&e.FluxDispatcher.dispatch({type:"MESSAGE_DELETE",id:n.id,channelId:n.channel_id,otherPluginBypass:!0})},settings:ot};return z.default=Ct,Object.defineProperty(z,"__esModule",{value:!0}),z})({},vendetta,vendetta.metro,vendetta.plugin,vendetta.storage,vendetta.ui.components,vendetta.ui.assets,vendetta.metro.common,vendetta.ui,vendetta.ui.toasts,vendetta.ui.alerts,vendetta.patcher,vendetta.utils);
