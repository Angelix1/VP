(function(z,Se,f,o,V,B,R,e,p,H,we,_,Ie){"use strict";const{openLazy:De,hideActionSheet:St}=f.findByProps("openLazy","hideActionSheet");function ee(a,n){if(a!=null&&n!=null)for(const t of Object.keys(n))typeof n[t]=="object"&&!Array.isArray(n[t])?(typeof a[t]!="object"&&(a[t]={}),ee(a[t],n[t])):a[t]??=n[t]}function Be(a,n){try{De(new Promise(function(t){return t({default:a})}),"ActionSheet",n)}catch(t){Se.logger.error(t.stack),showToast("Got error when opening ActionSheet! Please check debug logs")}}const _e=function(a,n){return`${a}${Math.floor(n*255).toString(16).padStart(2,0)}`},Y={toInt(a){return a=a.replace(/^#/,""),parseInt(a,16)},toHex(a){return"#"+a.toString(16).toUpperCase()},HSLtoHEX(a,n,t){t/=100;const c=n*Math.min(t,1-t)/100,r=function(u){const s=(u+a/30)%12,l=t-c*Math.max(Math.min(s-3,9-s,1),-1);return Math.round(255*l).toString(16).padStart(2,"0")};return`#${r(0)}${r(8)}${r(4)}`}},{ScrollView:Fe,View:G,Text:Me,TouchableOpacity:te,TextInput:wt,Image:Pe,Animated:$}=B.General,{FormLabel:Te,FormIcon:Le,FormArrow:It,FormRow:j,FormSwitch:ve,FormSwitchRow:Dt,FormSection:Ne,FormDivider:$e,FormInput:ae}=B.Forms,xe=f.findByName("useIsFocused");f.findByProps("BottomSheetScrollView");const ne=f.findByStoreName("UserStore"),re=f.findByProps("showUserProfile");R.getAssetIDByName("ic_add_24px"),R.getAssetIDByName("ic_arrow"),R.getAssetIDByName("ic_minus_circle_24px"),R.getAssetIDByName("Check"),R.getAssetIDByName("Small");function se(a){return e.React.createElement(Le,{style:{opacity:1},source:R.getAssetIDByName(a)})}const M=e.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:p.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"3%",fontSize:24},sub:{color:p.semanticColors.TEXT_POSITIVE,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:p.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16},container:{marginTop:25,marginLeft:"5%",marginBottom:-15,flexDirection:"row"},textContainer:{paddingLeft:15,paddingTop:5,flexDirection:"column",flexWrap:"wrap",shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:.2,shadowRadius:4.65,elevation:8},image:{width:75,height:75,borderRadius:10,shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:.2,shadowRadius:4.65,elevation:8},mainText:{opacity:.975,letterSpacing:.25},header:{color:p.semanticColors.HEADER_PRIMARY,fontFamily:e.constants.Fonts.DISPLAY_BOLD,fontSize:25,letterSpacing:.25},subHeader:{color:p.semanticColors.HEADER_SECONDARY,fontSize:12.75}});function oe(a){let{index:n}=a;V.useProxy(o.storage);let t=o.storage?.inputs?.ignoredUserList[n];const c=e.React.useRef(new $.Value(1)).current,r=function(){return $.spring(c,{toValue:1.1,duration:10,useNativeDriver:!0}).start()},u=function(){return $.spring(c,{toValue:1,duration:250,useNativeDriver:!0}).start()},s={transform:[{scale:c}]};let l=ne.getUser(t?.id),g=Object.values(ne.getUsers());l||(l=g.find(function(m){return m?.username==t?.username})),l||(l=g.find(function(m){return m?.username?.toLowerCase()==t?.username?.toLowerCase()}));const C=e.NavigationNative.useNavigation();return xe(),e.React.createElement(e.React.Fragment,null,e.React.createElement(Fe,null,e.React.createElement(G,{style:[M.basicPad,M.sub]},e.React.createElement(Ne,{title:"User Setting",style:[M.header]},e.React.createElement(j,{label:"Find User Id or Username",leading:se("ic_search"),onPress:function(){l&&!t.username?.length?t.username=l.username:l&&!t.id?.length?t.id=l.id:H.showToast("Cannot find User Id/Username.")}}),e.React.createElement(ae,{title:"User Username | Case Sensitive",placeholder:"Missing No",value:t?.username,onChange:function(m){return t.username=m}}),e.React.createElement(ae,{title:"User Id",placeholder:"Missing No",value:t?.id,onChange:function(m){return t.id=m}}),e.React.createElement(j,{label:"User is webhook?",subLabel:"User is webhook or system, and not BOT or Normal User.",leading:se("ic_webhook_24px"),trailing:e.React.createElement(ve,{value:t?.isWebhook||!1,onValueChange:function(m){return t.isWebhook=m}})})),l&&e.React.createElement(G,{style:[M.container,{paddingBottom:10}]},e.React.createElement(te,{onPress:function(){return re.showUserProfile?.({userId:l?.id})},onPressIn:r,onPressOut:u},e.React.createElement($.View,{style:s},e.React.createElement(Pe,{source:{uri:l?.getAvatarURL?.()?.replace?.("webp","png")||"https://cdn.discordapp.com/embed/avatars/2.png"},style:{width:128,height:128,borderRadius:10}}))),e.React.createElement(G,{style:M.textContainer},e.React.createElement(te,{onPress:function(){return re.showUserProfile({userId:l?.id})}},e.React.createElement(Me,{style:[M.mainText,M.header]},l?.username||t?.username||"No Name"))),e.React.createElement($e,null)),e.React.createElement(j,{label:e.React.createElement(Te,{text:"Remove User from Ignore List",style:{color:p.rawColors.RED_400}}),onPress:function(){C.pop(),o.storage?.inputs?.ignoredUserList?.splice(n,1)}}))))}const{ScrollView:Ue,View:ke,Text:Bt,TouchableOpacity:Oe,TextInput:ze}=B.General,{FormLabel:_t,FormIcon:Ve,FormArrow:He,FormRow:X,FormSwitch:Ft,FormSwitchRow:Mt,FormSection:Ye,FormDivider:Ge,FormInput:Pt}=B.Forms;function ie(a,n){return React.createElement(Ve,{style:{opacity:1},source:n?a:R.getAssetIDByName(a)})}const je=f.findByName("useIsFocused");f.findByProps("BottomSheetScrollView");const{getUser:Xe}=f.findByProps("getUser"),Ke=R.getAssetIDByName("ic_add_24px");R.getAssetIDByName("ic_arrow"),R.getAssetIDByName("ic_minus_circle_24px"),R.getAssetIDByName("Check"),R.getAssetIDByName("Small");const Qe=R.getAssetIDByName("ic_trash_24px"),L=e.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:p.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"3.5%",fontSize:24},sub:{color:p.semanticColors.TEXT_POSITIVE,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:p.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16},input:{fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM,color:p.semanticColors.TEXT_NORMAL},placeholder:{color:p.semanticColors.INPUT_PLACEHOLDER_TEXT}});function Je(){V.useProxy(o.storage);let[a,n]=React.useState("");const t=e.NavigationNative.useNavigation();je();let c=o.storage?.inputs?.ignoredUserList??[];const r=function(){if(a){if(isNaN(parseInt(a)))c.push({id:void 0,username:a});else{let u=Xe(a);if(u)c.push({id:u?.id,username:"",showUser:!1,isWebhook:!1});else return H.showToast("Invalid User Id")}n(""),t.push("VendettaCustomPage",{title:"Adding User to Ignore List",render:function(){return React.createElement(oe,{index:c?.length-1})}})}};return React.createElement(React.Fragment,null,React.createElement(Ue,{style:{flex:1}},React.createElement(Ye,{style:[L.header,L.basicPad]},React.createElement(ke,{style:[L.header,L.sub]},c.length>0&&React.createElement(X,{label:"Clear List",trailing:ie(Qe,!0),onPress:function(){c.length!==0&&we.showConfirmationAlert({title:"Hol up, wait a minute!",content:`This will removes in total ${c.length} users from ignore list.`,confirmText:"Ye",cancelText:"Nah",confirmColor:"brand",onConfirm:function(){o.storage.inputs.ignoredUserList=[]}})}}),c?.map(function(u,s){return React.createElement(React.Fragment,null,React.createElement(X,{label:u?.username||u?.id||"No Data",trailing:React.createElement(He,null),onPress:function(){return t.push("VendettaCustomPage",{title:"Editing User",render:function(){return React.createElement(oe,{index:s})}})}}),s!==c?.length-1&&React.createElement(Ge,null))}),React.createElement(X,{label:React.createElement(ze,{value:a,onChangeText:n,placeholder:"User ID or Username",placeholderTextColor:L.placeholder.color,selectionColor:e.constants.Colors.PRIMARY_DARK_100,onSubmitEditing:r,returnKeyType:"done",style:L.input}),trailing:React.createElement(Oe,{onPress:r},ie(Ke,!0))})))))}const{StyleSheet:We,PanResponder:qe}=e.ReactNative,K=f.findByStoreName("ThemeStore"),{meta:{resolveSemanticColor:Q}}=f.findByProps("colors","meta"),{View:J}=B.General,{useState:Ze,useRef:et}=e.React,W={sliderOff:Q(K.theme,p.semanticColors.DEPRECATED_QUICKSWITCHER_INPUT_BACKGROUND),sliderOn:Q(K.theme,p.semanticColors.REDESIGN_BUTTON_PRIMARY_BACKGROUND),thumb:Q(K.theme,p.semanticColors.MENTION_FOREGROUND)},le=function(a){let{onSlide:n,min:t,max:c,value:r}=a;const u=r||0,[s,l]=Ze(0),g=et(null);function C(d){g.current&&g.current.measure(function(h,i,b,E,y,S){let D=(d-y)/(b-y)*100;const k=Math.min(Math.max(0,Math.round(D/1)*1),100);n&&n(k)})}const m=e.React.useRef(qe.create({onStartShouldSetPanResponder:function(d,h){return!0},onStartShouldSetPanResponderCapture:function(d,h){return!0},onMoveShouldSetPanResponder:function(d,h){return!0},onMoveShouldSetPanResponderCapture:function(d,h){return!0},onPanResponderGrant:function(d,h){C(h.x0)},onPanResponderMove:function(d,h){C(h.moveX)},onPanResponderTerminationRequest:function(d,h){return!0},onPanResponderRelease:function(d,h){},onPanResponderTerminate:function(d,h){},onShouldBlockNativeResponder:function(d,h){return!0}})).current;function T(d){l(d.nativeEvent.layout.width)}const A=We.create({container:{marginLeft:"5%",width:"80%",height:20,borderRadius:25,backgroundColor:W.sliderOff,marginBottom:25},slid:{width:u+"%",height:"100%",borderTopLeftRadius:25,borderBottomLeftRadius:25,borderRadius:u===100?25:0,backgroundColor:W.sliderOn,justifyContent:"center"},thumb:{height:"150%",aspectRatio:1,alignSelf:"flex-end",right:-(s/2),borderRadius:100,backgroundColor:W.thumb}});return e.React.createElement(J,{style:A.container,...m.panHandlers,ref:g},e.React.createElement(J,{style:A.slid},e.React.createElement(J,{style:A.thumb,onLayout:T})))},tt=f.findByName("CustomColorPickerActionSheet"),{ScrollView:at,View:w,Text:ce,TouchableOpacity:de,TextInput:Tt,Pressable:Lt,Image:nt}=B.General,{FormLabel:vt,FormIcon:x,FormArrow:Nt,FormRow:P,FormSwitch:q,FormSwitchRow:$t,FormSection:N,FormDivider:F,FormInput:rt}=B.Forms,I=e.stylesheet.createThemedStyleSheet({text:{color:p.semanticColors.HEADER_SECONDARY,paddingLeft:"5.5%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:e.constants.Fonts.PRIMARY_BOLD,fontSize:16},subText:{color:p.semanticColors.TEXT_POSITIVE,paddingLeft:"6%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,fontSize:12},input:{fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM,color:p.semanticColors.TEXT_NORMAL},placeholder:{color:p.semanticColors.INPUT_PLACEHOLDER_TEXT},container:{flex:1,justifyContent:"center",alignItems:"center"},colorPreview:{width:"75%",height:100,marginBottom:20},row:{flexDirection:"row",height:80,width:"90%",marginBottom:20},border:{borderRadius:12}}),st=R.getAssetIDByName("ic_add_24px");f.findByProps("getUser");const ot=f.findByName("useIsFocused"),ue=[{id:"minimalistic",default:!0,label:"Minimalistic Settings",subLabel:"Removes all Styling (Enabled by Default)"},{id:"useBackgroundColor",default:!1,label:"Enable Background Color",subLabel:"Background Color for Deleted Message, similiar to Mention but Customizeable"},{id:"ignoreBots",default:!1,label:"Ignore Bots",subLabel:"Ignore bot deleted messages."},{id:"removeDismissButton",default:!1,label:"Remove Dissmiss Message",subLabel:"Remove clickable Dismiss Message text from deleted ephemeral messages."},{id:"addTimestampForEdits",default:!1,label:"Add Edit Timestamp",subLabel:"Add Timestamp for edited messages."}],ge=[{id:"textColor",label:"Deleted Message Text Color",subLabel:"Click to customize Deleted Message Text Color",defaultColor:"#E40303"},{id:"backgroundColor",label:"Deleted Message Background Color",subLabel:"Click to customize Background Color",defaultColor:"#FF2C2F"},{id:"gutterColor",label:"Deleted Message Background Gutter Color",subLabel:"Click to customize Background Gutter Color",defaultColor:"#FF2C2F"}],fe=[{id:"deletedMessageBuffer",title:"Customize Deleted Message",type:"default",placeholder:"This message is deleted"},{id:"editedMessageBuffer",title:"Customize Edited Separator",type:"default",placeholder:"`[ EDITED ]`"}];function U(a){if(a<0)return"00";if(a>100)return"FF";{const n=Math.round(a/100*255).toString(16);return n.length===1?`0${n}`:n}}function he(a){const n=parseInt(a,16);return isNaN(n)?0:Math.round(n/255*100)}function it(){V.useProxy(o.storage);const[a,n]=e.React.useState(he(o.storage?.colors?.backgroundColorAlpha)??100),[t,c]=e.React.useState(he(o.storage?.colors?.gutterColorAlpha)??100),r=e.NavigationNative.useNavigation();ot();const u=function(){r.push("VendettaCustomPage",{title:"List of Ignored Users",render:function(){return e.React.createElement(Je,null)}})};return e.React.createElement(at,null,e.React.createElement(w,{style:{marginTop:20,marginBottom:20}},e.React.createElement(N,{title:"Plugin Setting",style:[I.header]},e.React.createElement(P,{label:"Customization",subLabel:"Show customization for the plugin",leading:e.React.createElement(x,{style:{opacity:1},source:R.getAssetIDByName("ic_category_16px")}),trailing:e.React.createElement(q,{value:o.storage?.switches?.customizeable??!1,onValueChange:function(s){return o.storage.switches.customizeable=s}})}),o.storage?.switches?.customizeable&&e.React.createElement(e.React.Fragment,null,e.React.createElement(N,{title:"Switches"}),e.React.createElement(F,null)),o.storage?.switches?.customizeable&&e.React.createElement(e.React.Fragment,null,e.React.createElement(w,{style:[I.subText]},ue?.map(function(s,l){return e.React.createElement(e.React.Fragment,null,e.React.createElement(P,{label:s?.label,subLabel:s?.subLabel,leading:s?.icon&&e.React.createElement(x,{style:{opacity:1},source:R.getAssetIDByName(s?.icon)}),trailing:"id"in s?e.React.createElement(q,{value:o.storage?.switches[s?.id]??s?.default,onValueChange:function(g){return o.storage.switches[s?.id]=g}}):void 0}),l!==ue?.length-1&&e.React.createElement(F,null))}))),o.storage?.switches?.customizeable&&e.React.createElement(e.React.Fragment,null,e.React.createElement(N,{title:"Text Variables"}),e.React.createElement(F,null)),o.storage?.switches?.customizeable&&e.React.createElement(e.React.Fragment,null,e.React.createElement(w,{style:[I.subText]},fe?.map(function(s,l){return e.React.createElement(e.React.Fragment,null,e.React.createElement(rt,{title:s?.title,keyboardType:s?.type,placeholder:s?.placeholder,value:o.storage?.inputs[s.id]??s?.placeholder,onChange:function(g){return o.storage.inputs[s.id]=g.toString()}}),l!==fe.length-1&&e.React.createElement(F,null))}))),o.storage?.switches?.customizeable&&e.React.createElement(e.React.Fragment,null,e.React.createElement(N,{title:"Color Pickers"}),e.React.createElement(F,null)),o.storage?.switches?.customizeable&&e.React.createElement(e.React.Fragment,null,e.React.createElement(w,{style:[I.subText]},ge?.map(function(s){const l=function(){return Be(tt,{color:Y?.toInt(o.storage.colors[s.id]||s?.defaultColor||"#000"),onSelect:function(g){const C=Y?.toHex(g);o.storage.colors[s.id]=C}})};return e.React.createElement(e.React.Fragment,null,e.React.createElement(P,{label:s?.label,subLabel:s?.subLabel||"Click to Update",onPress:l,trailing:e.React.createElement(de,{onPress:l},e.React.createElement(nt,{source:{uri:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mJsrQAAAgwBAJ9P6qYAAAAASUVORK5CYII="},style:{width:32,height:32,borderRadius:10,backgroundColor:o.storage?.colors[s.id]||ge.find(function(g){return g?.id==s?.id})?.defaultColor||"#000"}}))}))}))),o.storage?.switches?.customizeable&&e.React.createElement(e.React.Fragment,null,e.React.createElement(w,{style:[I.subText]},e.React.createElement(w,{style:I.container},e.React.createElement(P,{style:{justifyContent:"center",alignItems:"center"},label:`Preview Style: ${o.storage?.switches?.darkMode?"Light":"Dark"} Mode`,subLabel:"Click to Switch Mode",trailing:e.React.createElement(q,{value:o.storage?.switches?.darkMode??!0,onValueChange:function(s){return o.storage.switches.darkMode=s}})}),e.React.createElement(w,{style:[I.row,I.border,{overflow:"hidden",marginRight:10}]},e.React.createElement(w,{style:{width:"2%",backgroundColor:`${o.storage.colors.gutterColor}${U(t)}`}}),e.React.createElement(w,{style:{flex:1,backgroundColor:`${o.storage.colors.backgroundColor}${U(a)}`,justifyContent:"center",alignItems:"center"}},e.React.createElement(ce,{style:{fontSize:20,color:o.storage?.switches?.darkMode?"black":"white"}}," Low Effort Normal Example Message "),e.React.createElement(ce,{style:{fontSize:20,color:o.storage.colors.textColor||"#000000"}}," Low Effort Deleted Example Message "))),e.React.createElement(F,null),e.React.createElement(P,{label:`Background Color Alpha: ${a}%`}),e.React.createElement(le,{style:{marginBottom:0,marginRight:10},value:a,onSlide:function(s){n(s),o.storage.colors.backgroundColorAlpha=U(s)}}),e.React.createElement(F,null),e.React.createElement(P,{label:`Background Gutter Alpha: ${t}%`}),e.React.createElement(le,{style:{marginBottom:0,marginRight:10},value:t,onSlide:function(s){c(s),o.storage.colors.gutterColorAlpha=U(s)}}))))),e.React.createElement(N,{title:"Ignore List Setting",style:[I.header]},e.React.createElement(P,{label:"Add User to List",subLabel:"List of ignored users for the plugin",leading:e.React.createElement(x,{style:{opacity:1},source:R.getAssetIDByName("ic_members")}),onPress:u,trailing:e.React.createElement(de,{onPress:u},e.React.createElement(x,{style:{opacity:1},source:st}))}),e.React.createElement(F,null))))}f.findByProps("openLazy","hideActionSheet");const Re=f.findByProps("getChannel","getDMFromUserId"),Ee=f.findByProps("_channelMessages");function lt(a){return _.before("dispatch",e.FluxDispatcher,function(n){const[t]=n,c=t?.type;if(c=="MESSAGE_DELETE"){if(t?.otherPluginBypass)return n;const r=Ee.get(t.channelId)?.get(t.id);if(!r||t?.id&&a[t?.id]?.stage==2)return n;if(t?.id&&a[t?.id]?.stage==1)return a[t?.id].stage=2,a[t?.id]?.message??n;const u=r?.author?.id,s=r?.author?.username,l=!r?.content&&r?.attachments?.length==0&&r?.embeds?.length==0;return!u||!s||l||o.storage?.switches?.ignoreBots&&r?.author?.bot||o.storage?.inputs?.ignoredUserList?.length>0&&o.storage.inputs.ignoredUserList?.some(function(g){return g?.id==r?.author?.id||g.username==r.author.username})||(n[0]={type:"MESSAGE_UPDATE",channelId:r?.channel_id||t?.channelId,message:{...r,content:r?.content,type:0,flags:64,channel_id:r?.channel_id||t?.channelId,guild_id:Re?.getChannel(r?.channel_id)?.guild_id,timestamp:`${new Date().toJSON()}`,state:"SENT",was_deleted:!0},optimistic:!1,sendMessageOptions:{},isPushNotification:!1},a[t?.id||r?.id]={message:n,stage:1}),n}if(c=="MESSAGE_UPDATE"){if(t?.otherPluginBypass||t?.message?.author?.bot)return n;const r=Ee.get(t?.message?.channel_id)?.get(t?.message?.id),u=r?.author?.id,s=r?.author?.username,l=!r?.content&&r?.attachments?.length==0&&r?.embeds?.length==0;if(!r||!u||!s||l)return n;const g=t?.message?.content==r?.content,C=t?.message?.embeds.some(function(i){return i?.url==r?.content||i?.thumbnail?.url==r?.content||r?.content.includes(i?.url)||r?.content.includes(i?.thumbnail?.url)}),m=t?.message?.embeds?.size||t?.message?.embeds?.length,T=r?.embeds?.size||r?.embeds?.length;if(g||C||!t?.message?.content&&m!=T||o.storage?.inputs?.ignoredUserList?.length>0&&o.storage.inputs.ignoredUserList?.some(function(i){return i?.id==r?.author?.id||i.username==r.author.username}))return n;let A=o.storage?.inputs?.editedMessageBuffer||"`[ EDITED ]`";A=A+`

`;const d=t?.message||r;let h=`${r?.content}`;if(o.storage?.switches?.addTimestampForEdits){const i=Date.now(),b=`<t:${Math.abs(Math.round(i/1e3))}:R>`;h+=`  (${b}) ${A}${t?.message?.content??""}`}else h+=`  ${A}${t?.message?.content??""}`;return n[0]={type:"MESSAGE_UPDATE",message:{...d,content:h,guild_id:Re.getChannel(r?.channel_id)?.guild_id,edited_timestamp:"invalid_timestamp"}},n}})}const ct=f.findByProps("startEditMessage");function dt(){return _.before("startEditMessage",ct,function(a){let n=o.storage?.inputs?.editedMessageBuffer||"`[ EDITED ]`";n=n+`

`;const[t,c,r]=a,u=r.split(n);return a[2]=u[u.length-1],a})}const{DCDChatManager:ut}=e.ReactNative.NativeModules;function gt(a){return _.before("updateRows",ut,function(n){let t=JSON.parse(n[1]);const{textColor:c,backgroundColor:r,backgroundColorAlpha:u,gutterColor:s,gutterColorAlpha:l}=o.storage.colors,g=o.storage.inputs?.deletedMessageBuffer,{useBackgroundColor:C,minimalistic:m,removeDismissButton:T}=o.storage.switches;function A(i,b){i||(i=b);const E=i?.trim();if(E.startsWith("#")){const y=E.slice(1);if(/^[0-9A-Fa-f]{6}$/.test(y))return"#"+y.toUpperCase()}else if(/^[0-9A-Fa-f]{6}$/.test(E))return"#"+E.toUpperCase();return b||"#000"}function d(i,b){const E=b?.toString(),y=["text","heading","s","u","em","strong","list","blockQuote"];if(Array.isArray(i))return i.map(function(S){return d(S,E)});if(typeof i=="object"&&i!==null){const{content:S,type:D,target:k,items:O}=i;if(!y.includes(D))return i;if(D==="text"&&S&&S.length>=1)return{content:[{content:S,type:"text"}],target:"usernameOnClick",type:"link",context:{username:1,medium:!0,usernameOnClick:{action:"0",userId:"0",linkColor:e.ReactNative.processColor(E),messageChannelId:"0"}}};const Z=d(S,E),Ae=O?O.map(d,E):void 0;if(Z!==S||Ae!==O||!y.includes(D)){const v={...i,content:Z};return D==="blockQuote"&&k&&(v.content=Z,v.target=k),D==="list"&&v?.content&&delete v.content,O&&(v.items=Ae),v}}return i}function h(i,b,E){return i&&(b!=null&&(i.content[0].content[0].content=b+"  "),E==null&&i.content[0].content.splice(1)),i}return t.forEach(function(i){if(i?.type==1&&a[i?.message?.id]){if(i.message.edited=g?.length>0?g:"This message is deleted",m==!1){const b=A(c,"#E40303"),E=d(i?.message?.content,b);i.message.content=E}if(T&&(i.message.ephemeralIndication=h(i.message.ephemeralIndication,void 0,void 0)),m==!1&&C==!0){const b=A(`${r}`,"#FF2C2F"),E=A(`${s}`,"#FF2C2F");i.backgroundHighlight={backgroundColor:e.ReactNative.processColor(`${b}${u}`),gutterColor:e.ReactNative.processColor(`${E}${l}`)}}}}),n[1]=JSON.stringify(t),n[1]})}const ft=f.findByProps("updateMessageRecord","createMessageRecord");function ht(){return _.after("createMessageRecord",ft,function(a,n){let[t]=a;n.was_deleted=t.was_deleted})}const Rt=f.findByName("MessageRecord",!1);function Et(){return _.after("default",Rt,function(a,n){let[t]=a;n.was_deleted=!!t.was_deleted})}const pe=f.findByProps("updateMessageRecord","createMessageRecord");function pt(){return _.instead("updateMessageRecord",pe,function(a,n){let[t,c]=a;return c.was_deleted?pe.createMessageRecord(c,t.reactions):n.apply(this,[t,c])})}const me=f.findByProps("openLazy","hideActionSheet"),mt=f.findByProps("getMessage","getMessages"),yt=f.findByProps("getChannel","getDMFromUserId"),ye=f.findByProps("_channelMessages"),{FormRow:bt,FormIcon:Ct}=B.Forms;ee(o.storage,{switches:{customizeable:!1,useBackgroundColor:!1,ignoreBots:!1,minimalistic:!0,alwaysAdd:!1,darkMode:!0,removeDismissButton:!1,addTimestampForEdits:!1,timestampStyle:"R"},colors:{textColor:"#E40303",backgroundColor:"#FF2C2F",backgroundColorAlpha:"33",gutterColor:"#FF2C2F",gutterColorAlpha:"CC"},inputs:{deletedMessageBuffer:"This message is deleted",editedMessageBuffer:"`[ EDITED ]`",ignoredUserList:[]}});let be=[],Ce={};var At={onLoad:function(){be.push(lt(Ce),gt(Ce),dt(),ht(),Et(),pt(),_.before("openLazy",me,function(a){let[n,t,c]=a;const r=c?.message;t!=="MessageLongPressActionSheet"||!r||n.then(function(u){const s=_.after("default",u,function(l,g){e.React.useEffect(function(){return function(){s()}},[]);const C=Ie.findInReactTree(g,function(d){return d?.[0]?.type?.name==="ButtonRow"});if(!C)return g;const m=Math.max(C.findIndex(function(d){return d?.props?.message===e.i18n?.Messages?.MESSAGE_ACTION_REPLY}),0),T=mt.getMessage(r.channel_id,r?.id),A=function(d){return d.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(o.storage?.inputs?.editedMessageBuffer||"`[ EDITED ]`");if(new RegExp(A,"gmi").test(r.content)){const d=m||1;C.splice(d,0,e.React.createElement(bt,{label:"Remove Edit History",subLabel:o.storage?.switches?.alwaysAdd?"(Added by alwaysAdd option)":void 0,leading:e.React.createElement(Ct,{style:{opacity:1},source:R.getAssetIDByName("ic_edit_24px")}),onPress:function(){let h=o.storage?.inputs?.editedMessageBuffer||"`[ EDITED ]`";h=h+`

`;const i=r?.content?.split(h),b=i[i.length-1];console.log(r.embeds);const E=r?.embeds?.map(function(y){const S=y?.color?.replace(/.+\(/,"")?.replace(/\%/g,"")?.replace(")","")?.split(", "),D=e.ReactNative.processColor(`${_e(Y.HSLtoHEX(S[0],S[1],S[2]),S[3])}`);return{...y,author:y.author,title:y.rawTitle,description:y.rawDescription,url:y.url,type:y.type,image:y.image,thumbnail:y.thumbnail,color:D,content_scan_version:1}});console.log(E),e.FluxDispatcher.dispatch({type:"MESSAGE_UPDATE",message:{...r,content:`${b}`,embeds:E??[],attachments:r.attachments??[],mentions:r.mentions??[],guild_id:yt.getChannel(T.channel_id).guild_id},otherPluginBypass:!0}),me.hideActionSheet(),H.showToast("[ANTI ED] History Removed",R.getAssetIDByName("ic_edit_24px"))}}))}})})}))},onUnload:function(){for(const a of be)a();for(const a in ye._channelMessages)for(const n of ye._channelMessages[a]._array)n.was_deleted&&e.FluxDispatcher.dispatch({type:"MESSAGE_DELETE",id:n.id,channelId:n.channel_id,otherPluginBypass:!0})},settings:it};return z.default=At,Object.defineProperty(z,"__esModule",{value:!0}),z})({},vendetta,vendetta.metro,vendetta.plugin,vendetta.storage,vendetta.ui.components,vendetta.ui.assets,vendetta.metro.common,vendetta.ui,vendetta.ui.toasts,vendetta.ui.alerts,vendetta.patcher,vendetta.utils);
