(function(k,z,a,j,e,w,U,P,B,J){"use strict";const{default:K,GuildIconSizes:ee}=a.findByProps("GuildIconSizes"),te=a.findByName("Icon"),{FormRow:ae}=w.Forms,ne=a.findByProps("uploadEmoji"),re=a.findByProps("openLazy","hideActionSheet");function ie(i,t){fetch(i).then(function(l){l.blob().then(function(c){const s=new FileReader;s.readAsDataURL(c),s.onloadend=function(){t(s.result)}})})}function le(i){let{guild:t,emoji:l}=i;return React.createElement(ae,{leading:React.createElement(K,{guild:t,size:ee.MEDIUM,animate:!1}),label:t.name,trailing:React.createElement(te,{source:B.getAssetIDByName("ic_add_24px")}),onPress:function(){J.showInputAlert({title:"Emoji name",initialValue:l.name,placeholder:"bleh",onConfirm:function(c){ie(l.url,function(s){ne.uploadEmoji({guildId:t.id,image:s,name:c,roles:void 0}).then(function(){P.showToast(`Added ${l.name} ${l.name!==c?`as ${c} `:""}to ${t.name}`,B.getAssetIDByName("Check"))}).catch(function(f){P.showToast(f.body.message,B.getAssetIDByName("Small"))})})},confirmText:`Add to ${t.name}`,confirmColor:"brand",cancelText:"Cancel"}),re.hideActionSheet()}})}const G=a.findByProps("openLazy","hideActionSheet"),{default:ce}=a.find(function(i){return i.default?.render?.name==="ActionSheet"}),{BottomSheetFlatList:se}=a.findByProps("BottomSheetScrollView"),{ActionSheetTitleHeader:oe,ActionSheetCloseButton:de}=a.findByProps("ActionSheetTitleHeader"),{FormDivider:ue,FormIcon:fe}=w.Forms,he=a.findByProps("getGuilds"),pe=a.findByProps("can","_dispatcher"),ge=function(i){return G.openLazy(new Promise(function(t){return t({default:Re})}),"AddToServerActionSheet",{emoji:i})};function Re(i){let{emoji:t}=i;const l=Object.values(he.getGuilds()).filter(function(c){return pe.can(e.constants.Permissions.MANAGE_GUILD_EXPRESSIONS,c)});return React.createElement(ce,{scrollable:!0},React.createElement(oe,{title:`Stealing ${t.name}`,leading:React.createElement(fe,{style:{marginRight:12},source:{uri:t.url},disableColor:!0}),trailing:React.createElement(de,{onPress:function(){return G.hideActionSheet()}})}),React.createElement(se,{style:{flex:1},contentContainerStyle:{paddingBottom:24},data:l,renderItem:function(c){let{item:s}=c;return React.createElement(le,{guild:s,emoji:t})},ItemSeparatorComponent:ue,keyExtractor:function(c){return c.id}}))}const v=a.findByProps("openLazy","hideActionSheet"),{downloadMediaAsset:ye}=a.findByProps("downloadMediaAsset"),{default:Ee}=a.find(function(i){return i.default?.render?.name==="ActionSheet"}),{BottomSheetFlatList:Se}=a.findByProps("BottomSheetScrollView"),{ActionSheetTitleHeader:Be,ActionSheetCloseButton:be}=a.findByProps("ActionSheetTitleHeader"),{default:Ae,ButtonColors:we,ButtonLooks:ze,ButtonSizes:Pe}=a.findByProps("ButtonColors","ButtonLooks","ButtonSizes"),{FormDivider:ve,FormIcon:me}=w.Forms,V=function(i,t){return v.openLazy(new Promise(function(l){return l({default:Le})}),"ShowOptions",{data:i,guild:t})};function Le(i){let{data:t,guild:l}=i,c={text:"Add to Server",callback:function(){return ge(t)}},s=[{text:"Copy URL to clipboard",callback:function(){e.clipboard.setString(t.url),v.hideActionSheet(),P.showToast(`Copied ${t.name}'s URL to clipboard`,B.getAssetIDByName("ic_copy_message_link"))}},{text:`Save image to ${e.ReactNative.Platform.select({android:"Downloads",default:"Camera Roll"})}`,callback:function(){ye(t.url,t.url.includes(".gif")?1:0),v.hideActionSheet(),P.showToast(`Saved ${t.name}'s image to ${e.ReactNative.Platform.select({android:"Downloads",default:"Camera Roll"})}`,B.getAssetIDByName("toast_image_saved"))}}];return t.type=="emoji"&&s.unshift(c),React.createElement(React.Fragment,null,React.createElement(Ee,{scrollable:!0},React.createElement(Be,{title:t.name||"Options",leading:React.createElement(me,{style:{marginRight:12},source:B.getAssetIDByName("ic_forum_channel_list_view_24px"),disableColor:!0}),trailing:React.createElement(be,{onPress:function(){return v.hideActionSheet()}})}),React.createElement(Se,{style:{flex:1},contentContainerStyle:{paddingBottom:24},data:s,renderItem:function(f){let{item:h}=f;return React.createElement(React.Fragment,null,React.createElement(Ae,{color:we.BRAND,size:Pe.SMALL,text:h.text,onPress:h.callback,style:{margin:e.ReactNative.Platform.select({android:12,default:16})}}))},ItemSeparatorComponent:ve,keyExtractor:function(f){return f.id}})))}const $e=a.findByStoreName("EmojiStore"),Ne=a.findByStoreName("StickersStore"),{openMediaModal:xe}=a.findByName("MediaModal",!1),{FormLabel:_e,FormArrow:Me,FormRow:p,FormSwitch:H,FormSwitchRow:Oe,FormSection:Fe,FormDivider:g,FormInput:je}=w.Forms,{ScrollView:Ie,TextInput:Ue,TouchableOpacity:b,View:u,Image:_,Text:W,Animated:m}=w.General,r=e.stylesheet.createThemedStyleSheet({container:{marginTop:25,marginLeft:"5%",marginBottom:-15,flexDirection:"row"},textContainer:{paddingLeft:15,paddingTop:5,flexDirection:"column",flexWrap:"wrap",shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:.1,shadowRadius:4.65,elevation:8},shadow:{shadowColor:"#444",shadowOffset:{width:1,height:4},shadowOpacity:.1,shadowRadius:4.65,elevation:8},image:{borderRadius:10,shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:.1,shadowRadius:4.65,elevation:8},mainText:{opacity:.975,letterSpacing:.25},header:{color:U.semanticColors.HEADER_PRIMARY,fontFamily:e.constants.Fonts.DISPLAY_BOLD,fontSize:24,letterSpacing:.25},greenText:{color:U.semanticColors.TEXT_POSITIVE,fontFamily:e.constants.Fonts.DISPLAY_BOLD},buffer:{padding:14},bg:{backgroundColor:"#FFF"},bg2:{backgroundColor:"#DAF0FA"}});function Y(i){let{guild:t}=i,[l,c]=e.React.useState(!1),[s,f]=e.React.useState(!1);const h=$e.getGuildEmoji(t?.id),o=Ne.getStickersByGuildId(t?.id);let R=[],y=[];if(h?.length>0)for(let n of h){let d=`https://cdn.discordapp.com/emojis/${n.id}.${n.animated?"gif":"png"}?size=4096`;R.push({name:n?.name,url:d,type:"emoji"})}if(o?.length>0){for(let n of o)if(n?.format_type!=3){let d=`https://media.discordapp.net/stickers/${n.id}.${n.format_type==1||n.format_type==2?"png":"gif"}?size=4096`;y.push({name:n.name,url:d,type:"sticker"})}}let E="https://cdn.discordapp.com",F=`${E}/icons/${t?.id}/${t?.icon}${t?.icon?.startsWith?.("a_")?".gif":".png"}?size=4096`,A,I,C;t?.banner&&(A=`${E}/banners/${t?.id}/${t?.banner}${t?.icon?.startsWith?.("a_")?".gif":".png"}?size=4096`),t?.splash&&(I=`${E}/splashes/${t?.id}/${t?.splash}.png?size=4096`),t?.discoverySplash&&(C=`${E}/discovery-splashes/${t?.id}/${t?.discoverySplash}.png?size=4096`);function D(n){e.ReactNative.Image.getSize(n,function(d,q){xe({initialSources:[{uri:n,sourceURI:n,width:d,height:q,guildId:"1",channelId:"1"}],initialIndex:0,originLayout:{width:d,height:q,x:1,y:1,resizeMode:"auto"}})})}const O={transform:[{scale:e.React.useRef(new m.Value(1)).current}]};function T(n){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:256;return e.React.createElement(e.React.Fragment,null,e.React.createElement(m.View,{style:O},e.React.createElement(_,{style:[r.image,{height:d,width:d+192}],source:{uri:n}})))}let S=[r.header,r.greenText,r.buffer];return e.React.createElement(e.React.Fragment,null,e.React.createElement(Ie,null,e.React.createElement(u,{style:{marginBottom:60}},e.React.createElement(u,{style:[{marginBottom:20}]},e.React.createElement(Fe,{style:[r.shadow]},e.React.createElement(u,{style:{paddingLeft:16}},e.React.createElement(p,{label:"Server Name",style:[...S],subLabel:t.name||"naem"}),e.React.createElement(g,null),e.React.createElement(p,{label:"Server Description",style:[...S],subLabel:t.description||"No Description"}),e.React.createElement(g,null),e.React.createElement(p,{label:"Member Count",style:[...S],subLabel:t.memberCount||"No Data"}),e.React.createElement(g,null),e.React.createElement(p,{label:"Presence Count",style:[...S],subLabel:t.presenceCount||"No Data"}),e.React.createElement(g,null),e.React.createElement(p,{label:"Server Icon",style:[...S]}),e.React.createElement(u,{style:[r.buffer,{paddingBottom:16}]},e.React.createElement(b,{onPress:function(){return D(F)}},T(F))),e.React.createElement(g,null),A&&e.React.createElement(e.React.Fragment,null,e.React.createElement(p,{label:"Server Banner",style:[...S]}),e.React.createElement(u,{style:[r.buffer,{paddingBottom:16}]},e.React.createElement(b,{onPress:function(){return D(A)}},T(A))),e.React.createElement(g,null)),I&&e.React.createElement(e.React.Fragment,null,e.React.createElement(p,{label:"Server Splash",style:[...S]}),e.React.createElement(u,{style:[r.buffer,{paddingBottom:16}]},e.React.createElement(b,{onPress:function(){return D(I)}},T(I))),e.React.createElement(g,null)),C&&e.React.createElement(e.React.Fragment,null,e.React.createElement(p,{label:"Server Discovery",style:[...S]}),e.React.createElement(u,{style:[r.buffer,{paddingBottom:16}]},e.React.createElement(b,{onPress:function(){return D(C)}},T(C))),e.React.createElement(g,null)),R?.length>0&&e.React.createElement(p,{label:"Emoji",subLabel:"Show emojis of this guild",trailing:e.React.createElement(H,{value:l,onValueChange:function(n){return c(n)}}),style:[r.mainText,r.buffer,r.header]}),l&&R.map(function(n,d){return e.React.createElement(e.React.Fragment,null,e.React.createElement(u,{style:[r.container,{padding:12,flexDirection:"row",textAlign:"center"}]},e.React.createElement(b,{onPress:function(){return V(n,t)}},e.React.createElement(m.View,{style:O},e.React.createElement(_,{style:[r.image,{height:128,width:128}],source:{uri:n.url}}))),e.React.createElement(u,{style:r.textContainer},e.React.createElement(W,{style:[r.mainText,r.header]},n.name||"No Name")),d!==R?.length-1&&e.React.createElement(g,null)))}),y?.length>0&&e.React.createElement(p,{label:"Stickers",subLabel:"Show stickers of this guild",trailing:e.React.createElement(H,{value:s,onValueChange:function(n){return f(n)}}),style:[r.mainText,r.buffer,r.header]}),s&&y.map(function(n,d){return e.React.createElement(e.React.Fragment,null,e.React.createElement(u,{style:[r.container,{padding:12,flexDirection:"row",textAlign:"center"}]},e.React.createElement(b,{onPress:function(){return V(n,t)}},e.React.createElement(m.View,{style:O},e.React.createElement(_,{style:[r.image,{height:256,width:256}],source:{uri:n.url}}))),e.React.createElement(u,{style:r.textContainer},e.React.createElement(W,{style:[r.mainText,r.header]},n.name||"No Name")),d!==R?.length-1&&e.React.createElement(g,null)))})))))))}const Ce=a.findByProps("GuildDetails");a.findByStoreName("GuildStore"),a.findByStoreName("UserSettingsProtoStore"),a.findByProps("favoriteSticker","unfavoriteSticker");const X=a.findByProps("openLazy","hideActionSheet"),{default:De}=a.find(function(i){return i.default?.render?.name==="ActionSheet"});a.findByProps("hideActionSheet"),a.findByProps("downloadMediaAsset"),a.findByProps("openURL","openDeeplink");const{default:L,ButtonColors:$,ButtonLooks:Ge,ButtonSizes:N}=a.findByProps("ButtonColors","ButtonLooks","ButtonSizes"),Te=a.findByProps("getRenderCloseButton"),x=a.findByProps("push","pushLazy","pop"),{default:Q,getRenderCloseButton:Z}=Te;let M=[];var ke={onLoad:function(){M.push(z.after("default",Ce,function(i,t){let[{emojiNode:l}]=i;if(!l.src)return;const c=t?.props?.children?.props?.children?.props?.children,s=z.after("type",c,function(f,h){e.React.useEffect(function(){return function(){s()}},[]);let o=h?.props?.children[4];if(!o)return console.log("[NULL]");let R=o?.props?.children[1]?.props?.guild;if(!R)return;let y=[].map(function(E){let{text:F,callback:A}=E;return e.React.createElement(L,{color:$.BRAND,text:F,size:N.SMALL,onPress:A,style:{marginTop:e.ReactNative.Platform.select({android:12,default:16})}})});y.unshift(e.React.createElement(e.React.Fragment,null,e.React.createElement(L,{color:$.BRAND,size:N.SMALL,text:"Preview Server",onPress:function(){X.hideActionSheet();const E=function(){return e.React.createElement(Q,{initialRouteName:"Page",goBackOnBackPress:!0,screens:{Page:{title:"Server Information",headerLeft:Z(function(){return x.pop()}),render:function(){return e.React.createElement(Y,{guild:R})}}}})};x.push(E)},style:{marginTop:e.ReactNative.Platform.select({android:12,default:16})}}))),h.props?.children?.push(...y)})})),M.push(z.before("render",De,function(i){let[t]=i;const l=j.findInReactTree(t,function(o){return Array.isArray(o?.children)}),c=j.findInReactTree(t,function(o){return typeof o?.sticker=="object"&&o?.sticker?.hasOwnProperty("guild_id")})?.sticker;if(!l||!c)return;let s=l.children[3];if(!s)return console.log("[NULL]");let f=s?.props?.children[1]?.props?.guild;if(!f)return;let h=[].map(function(o){let{text:R,callback:y}=o;return e.React.createElement(L,{color:$.BRAND,text:R,size:N.SMALL,onPress:y,style:{marginTop:e.ReactNative.Platform.select({android:12,default:16})}})});h.unshift(e.React.createElement(e.React.Fragment,null,e.React.createElement(L,{color:$.BRAND,size:N.SMALL,text:"Preview Server",onPress:function(){X.hideActionSheet();const o=function(){return e.React.createElement(Q,{initialRouteName:"Page",goBackOnBackPress:!0,screens:{Page:{title:"Server Information",headerLeft:Z(function(){return x.pop()}),render:function(){return e.React.createElement(Y,{guild:f})}}}})};x.push(o)},style:{marginTop:e.ReactNative.Platform.select({android:12,default:16})}}))),l?.children?.push?.(...h)}))},onUnload:function(){for(const i of M)i()}};return k.default=ke,Object.defineProperty(k,"__esModule",{value:!0}),k})({},vendetta.patcher,vendetta.metro,vendetta.utils,vendetta.metro.common,vendetta.ui.components,vendetta.ui,vendetta.ui.toasts,vendetta.ui.assets,vendetta.ui.alerts);
