(function(S,n,A,m,E,e,x,d,R){"use strict";const{ScrollView:V,View:$,Text:k,TouchableOpacity:ne,TextInput:re}=m.General,{FormLabel:U,FormIcon:se,FormArrow:oe,FormRow:G,FormSwitch:ue,FormSwitchRow:C,FormSection:y,FormDivider:F,FormInput:h}=m.Forms,i=e.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:d.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"3%",fontSize:24},sub:{color:d.semanticColors.TEXT_POSITIVE,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:d.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16}});function I(u){let{index:a}=u,s=n.storage.soundDatas[a];A.useProxy(n.storage);const t=e.NavigationNative.useNavigation(),c=1e4;return React.createElement(V,null,React.createElement(y,{style:[i.basicPad]},React.createElement($,{style:[i.basicPad,i.sub]},React.createElement(y,{title:"Sound ID",style:[i.header]},React.createElement(k,{style:[i.basicPad,i.flagsText]},`${s.sound_id-c}`),React.createElement(h,{title:"Assign a Name",placeholder:"Meow!",value:s?.sound_name,onChange:function(r){return s.sound_name=r}}),React.createElement(h,{title:"Sound URL",placeholder:"https://example.com/audio/im_cool.ogg",value:s?.sound_url,onChange:function(r){return s.sound_url=r}}),!n.storage.soundDatas[a].use_regex&&React.createElement(React.Fragment,null,React.createElement(h,{title:"Normal Match (if included once in a message)",placeholder:"cat",value:s?.sound_match,onChange:function(r){return s.sound_match=r}})),n.storage.soundDatas[a].use_regex&&React.createElement(React.Fragment,null,React.createElement(F,null),React.createElement(h,{title:"Regex Syntax",placeholder:"c(a)+t",value:s?.sound_regex,onChange:function(r){return s.sound_regex=r}})),n.storage.soundDatas[a].use_regex&&React.createElement(React.Fragment,null,React.createElement(F,null),React.createElement(h,{title:"Flags",placeholder:"gi",value:s?.regex_flag,onChange:function(r){return s.regex_flag=r}})),n.storage.soundDatas[a].use_regex&&React.createElement(React.Fragment,null,React.createElement(F,null),React.createElement(C,{label:"Repeat sound for every match",value:n.storage.soundDatas[a].repeat_sound,onValueChange:function(r){return n.storage.soundDatas[a].repeat_sound=r}}))),React.createElement(y,null,React.createElement(C,{label:"Regular expression",subLabel:"Turn on to use regular expression",value:n.storage.soundDatas[a].use_regex,onValueChange:function(r){return n.storage.soundDatas[a].use_regex=r}})))),React.createElement(G,{label:React.createElement(U,{text:"Delete",style:{color:d.rawColors.RED_400}}),onPress:function(){t.pop(),setTimeout(function(){return n.storage.soundDatas.splice(a,1)},300)}}))}const{ScrollView:K,View:p,Text:le,TouchableOpacity:Y,TextInput:X,Animated:b}=m.General,{FormLabel:ce,FormIcon:z,FormArrow:P,FormRow:w,FormSwitch:de,FormSwitchRow:ie,FormSection:O,FormDivider:H,FormInput:ge}=m.Forms,j=x.findByName("useIsFocused"),q=x.findByName("LinearGradient"),J=E.getAssetIDByName("ic_add_24px"),L=E.getAssetIDByName("ic_unread_checkmark"),v=E.getAssetIDByName("Small"),g=e.stylesheet.createThemedStyleSheet({border:{borderRadius:12,overflow:"hidden"},shadowTemplate:{shadowOffset:{width:1,height:3},shadowOpacity:.9,shadowRadius:24,elevation:16},input:{fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM,color:d.semanticColors.TEXT_NORMAL},placeholder:{color:d.semanticColors.INPUT_PLACEHOLDER_TEXT}});function Q(){A.useProxy(n.storage),n.storage.soundDatas??=[];const u=e.NavigationNative.useNavigation();j();const[a,s]=e.React.useState(""),[t,c]=e.React.useState(new b.Value(0));e.React.useEffect(function(){b.loop(b.timing(t,{toValue:4,duration:8e3,useNativeDriver:!0})).start()},[]);const r={backgroundColor:t.interpolate({inputRange:[0,1,2,3,4],outputRange:["rgba(188,31,31,0.5)","rgba(46,168,30,0.5)","rgba(48,179,173,0.5)","rgba(183,40,198,0.5)","rgba(188,31,31,0.5)"]})},l=1e4,D=[{label:"Vine Boom SFX",callback:function(){n.storage.soundDatas.push({sound_id:l+n.storage.soundDatas.length,sound_name:"Vine Boom SFX",sound_url:"https://raw.githubusercontent.com/Metastruct/garrysmod-chatsounds/master/sound/chatsounds/autoadd/memes/overused%20thud.ogg",sound_match:"moyai",sound_regex:"((<a?:)?.*?moy?ai.*?(:>)?|\u{1F5FF})",regex_flag:"gi",repeat_sound:!1,use_regex:!1}),R.showToast("Vine Boom Added",L)}},{label:"Discordo",callback:function(){n.storage.soundDatas.push({sound_id:l+n.storage.soundDatas.length,sound_name:"Discordo SFX",sound_url:"https://discord.com/assets/ae7d16bb2eea76b9b9977db0fad66658.mp3",sound_match:"discordo",sound_regex:"(dc|discord(o)?)",regex_flag:"gi",repeat_sound:!1,use_regex:!1}),R.showToast("Discordo Added",L)}}],f=function(){if(n.storage.soundDatas.some(function(o){return o.sound_id==a}))return R.showToast("[SOUNDBANKS] Sound ID must be unique.",v);if(a){let o=Number(a);if(isNaN(o))return R.showToast("[SOUNDBANKS] Sound ID must be Number.",v);if(o<0)return R.showToast("[SOUNDBANKS] Sound ID cannot be negative",v);o=Math.round(Math.abs(o)),o=o+l,n.storage.soundDatas.push({sound_id:o,sound_name:"",sound_url:"",sound_match:"",sound_regex:"",regex_flag:"gi",repeat_sound:!1,use_regex:!1}),s(""),u.push("VendettaCustomPage",{title:"Adding Sound",render:function(){return e.React.createElement(I,{index:n.storage.soundDatas?.length-1})}})}};return e.React.createElement(e.React.Fragment,null,e.React.createElement(K,null,e.React.createElement(q,{start:{x:.8,y:0},end:{x:0,y:.8},colors:["#b8ff34","#4bff61","#44f6ff","#4dafff","#413dff","#d63efd"],style:[g.border,g.shadowTemplate,{flex:1,margin:"1%",shadowColor:"#b8ff34"}]},e.React.createElement(p,{style:[g.border,r,{backgroundColor:"rgba(10, 10, 10, 0.9)",margin:2,padding:"3%"}]},e.React.createElement(O,{title:"Preconfigured Rules, click to use"},e.React.createElement(b.View,{style:[g.border,r]},e.React.createElement(p,{style:[]},D.map(function(o){return e.React.createElement(e.React.Fragment,null,e.React.createElement(w,{label:o?.label,trailing:e.React.createElement(P,null),onPress:o?.callback}))})))),e.React.createElement(O,{title:"Sound List",style:[]},e.React.createElement(p,{style:[]},n.storage.soundDatas.length>0&&n.storage.soundDatas?.map(function(o,M){return e.React.createElement(e.React.Fragment,null,e.React.createElement(w,{label:(o?.sound_name.length>0?`${o?.sound_name} [ ${o?.sound_id-l} ]`:o?.sound_id-l)||"Unknown",trailing:e.React.createElement(P,null),onPress:function(){return u.push("VendettaCustomPage",{title:"Editing Sound",render:function(){return e.React.createElement(I,{index:M})}})}}),M!==n.storage.soundDatas?.length-1&&e.React.createElement(H,null))}),e.React.createElement(w,{label:e.React.createElement(X,{value:a,onChangeText:s,placeholder:"Sound ID",placeholderTextColor:g.placeholder.color,selectionColor:e.constants.Colors.PRIMARY_DARK_100,onSubmitEditing:f,returnKeyType:"done",style:[g.input]}),trailing:e.React.createElement(Y,{onPress:f},e.React.createElement(z,{style:{opacity:1},source:J}))})))))))}const{DCDSoundManager:_}=e.ReactNative.NativeModules,W=x.findByStoreName("SelectedChannelStore");E.getAssetIDByName("ic_warning_24px");const Z=/((http(s)?\:\/\/)(((?!\?).)+\.(mp3|ogg|wav)))/i;let N=!1;n.storage.soundDatas??=[];const ee=n.storage.soundDatas,te=function(u,a){return new Promise(function(s){return _.prepare(u,"notification",a,function(t,c){return s(c)})})};function T(u,a){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,t;const c=2e3;N=!0,te(u,a).then(async function(r){t=r?.duration??c;let l=!1,D=null;for(let f=0;f<s;f++)setTimeout(async function(){l&&(l=!1,_.stop(a),clearTimeout(D)),l=!0,await _.play(a),D=setTimeout(function(){l=!1,_.stop(a),N=!1,setTimeout(function(){return _.release(a)},100)},t)},f*400)}).catch(function(r){alert("[SOUNDBANKS] ERROR!!! CHECK DEBUG LOGS"),console.log("[SOUNDBANKS LOG] "+r)})}function B(u){if(u.message.content&&u.channelId==W.getChannelId()&&!u.message.state){const a=u.message;if(!N){const s=ee.filter(function(t){return t?.sound_url?.match(Z)});for(let t of s)if(!(!t?.sound_id||!t?.sound_url)){if(!t?.use_regex&&t?.sound_match&&a.content.includes(t?.sound_match)){T(t?.sound_url,t?.sound_id);break}else if(t?.use_regex){if(!t?.regex_flag||!t?.sound_regex)continue;const c=new RegExp(t?.sound_regex,t?.regex_flag||"gi");if(c.test(a.content)){if(t?.repeat_sound){const r=a?.content?.match?.(c)?.length??null;T(t?.sound_url,t?.sound_id,r)}else T(t?.sound_url,t?.sound_id);break}continue}}}}}var ae={onLoad:async function(){n.storage.soundDatas??=[],e.FluxDispatcher.subscribe("MESSAGE_CREATE",B)},onUnload:async function(){e.FluxDispatcher.unsubscribe("MESSAGE_CREATE",B)},settings:Q};return S.default=ae,Object.defineProperty(S,"__esModule",{value:!0}),S})({},vendetta.plugin,vendetta.storage,vendetta.ui.components,vendetta.ui.assets,vendetta.metro.common,vendetta.metro,vendetta.ui,vendetta.ui.toasts);
