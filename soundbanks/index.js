(function(D,r,T,h,_,e,S,c,E){"use strict";const{ScrollView:B,View:$,Text:V,TouchableOpacity:ae,TextInput:ne}=h.General,{FormLabel:k,FormIcon:re,FormArrow:se,FormRow:U,FormSwitch:oe,FormSwitchRow:C,FormSection:y,FormDivider:x,FormInput:f}=h.Forms,i=e.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:c.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"3%",fontSize:24},sub:{color:c.semanticColors.TEXT_POSITIVE,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:c.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16}});function N(o){let{index:a}=o,s=r.storage.soundDatas[a];T.useProxy(r.storage);const t=e.NavigationNative.useNavigation();return React.createElement(B,null,React.createElement(y,{style:[i.basicPad]},React.createElement($,{style:[i.basicPad,i.sub]},React.createElement(y,{title:"Sound ID",style:[i.header]},React.createElement(V,{style:[i.basicPad,i.flagsText]},`${s.sound_id??0}`),React.createElement(f,{title:"Assign a Name",placeholder:"Meow!",value:s?.sound_name,onChange:function(n){return s.sound_name=n}}),React.createElement(f,{title:"Sound URL",placeholder:"https://example.com/audio/im_cool.ogg",value:s?.sound_url,onChange:function(n){return s.sound_url=n}}),!r.storage.soundDatas[a].use_regex&&React.createElement(React.Fragment,null,React.createElement(f,{title:"Normal Match (if included once)",placeholder:"cat",value:s?.sound_match,onChange:function(n){return s.sound_match=n}})),r.storage.soundDatas[a].use_regex&&React.createElement(React.Fragment,null,React.createElement(x,null),React.createElement(f,{title:"Regex Syntax",placeholder:"c(a)+t",value:s?.sound_regex,onChange:function(n){return s.sound_regex=n}})),r.storage.soundDatas[a].use_regex&&React.createElement(React.Fragment,null,React.createElement(x,null),React.createElement(f,{title:"Flags",placeholder:"gi",value:s?.regex_flag,onChange:function(n){return s.regex_flag=n}})),r.storage.soundDatas[a].use_regex&&React.createElement(React.Fragment,null,React.createElement(x,null),React.createElement(C,{label:"Repeat sound for every match",value:r.storage.soundDatas[a].repeat_sound,onValueChange:function(n){return r.storage.soundDatas[a].repeat_sound=n}}))),React.createElement(y,null,React.createElement(C,{label:"Regular expression",subLabel:"Turn on to use regular expression",value:r.storage.soundDatas[a].use_regex,onValueChange:function(n){return r.storage.soundDatas[a].use_regex=n}})))),React.createElement(U,{label:React.createElement(k,{text:"Delete",style:{color:c.rawColors.RED_400}}),onPress:function(){t.pop(),setTimeout(function(){return r.storage.soundDatas.splice(a,1)},300)}}))}const{ScrollView:G,View:p,Text:le,TouchableOpacity:Y,TextInput:K,Animated:m}=h.General,{FormLabel:ue,FormIcon:X,FormArrow:A,FormRow:F,FormSwitch:ce,FormSwitchRow:ie,FormSection:I,FormDivider:z,FormInput:de}=h.Forms,H=S.findByName("useIsFocused"),j=S.findByName("LinearGradient"),Q=_.getAssetIDByName("ic_add_24px"),P=_.getAssetIDByName("ic_unread_checkmark"),L=_.getAssetIDByName("Small"),d=e.stylesheet.createThemedStyleSheet({border:{borderRadius:12,overflow:"hidden"},shadowTemplate:{shadowOffset:{width:1,height:3},shadowOpacity:.9,shadowRadius:24,elevation:16},input:{fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM,color:c.semanticColors.TEXT_NORMAL},placeholder:{color:c.semanticColors.INPUT_PLACEHOLDER_TEXT}});function q(){T.useProxy(r.storage),r.storage.soundDatas??=[];const o=e.NavigationNative.useNavigation();H();const[a,s]=e.React.useState(""),[t,n]=e.React.useState(new m.Value(0));e.React.useEffect(function(){m.loop(m.timing(t,{toValue:4,duration:8e3,useNativeDriver:!0})).start()},[]);const u={backgroundColor:t.interpolate({inputRange:[0,1,2,3,4],outputRange:["rgba(188,31,31,0.5)","rgba(46,168,30,0.5)","rgba(48,179,173,0.5)","rgba(183,40,198,0.5)","rgba(188,31,31,0.5)"]})},b=[{label:"Vine Boom SFX",callback:function(){e.clipboard.setString("https://raw.githubusercontent.com/Metastruct/garrysmod-chatsounds/master/sound/chatsounds/autoadd/memes/overused%20thud.ogg"),E.showToast("Copied Vine Boom SFX Sound",P)}},{label:"Discordo",callback:function(){e.clipboard.setString("https://discord.com/assets/ae7d16bb2eea76b9b9977db0fad66658.mp3"),E.showToast("Copied Discordo Sound",P)}}],g=function(){if(r.storage.soundDatas.some(function(l){return l.sound_id==a}))return E.showToast("Sound ID must be unique.",L);if(a){const l=Number(a);if(isNaN(l))return E.showToast("[SOUNDBANKS] Sound ID must be Number.",L);r.storage.soundDatas.push({sound_id:l,sound_name:"",sound_url:"",sound_match:"",sound_regex:"",regex_flag:"gi",repeat_sound:!1,use_regex:!1}),s(""),o.push("VendettaCustomPage",{title:"Adding Sound",render:function(){return e.React.createElement(N,{index:r.storage.soundDatas?.length-1})}})}};return e.React.createElement(e.React.Fragment,null,e.React.createElement(G,null,e.React.createElement(j,{start:{x:.8,y:0},end:{x:0,y:.8},colors:["#b8ff34","#4bff61","#44f6ff","#4dafff","#413dff","#d63efd"],style:[d.border,d.shadowTemplate,{flex:1,margin:"1%",shadowColor:"#b8ff34"}]},e.React.createElement(p,{style:[d.border,u,{backgroundColor:"rgba(10, 10, 10, 0.9)",margin:2,padding:"3%"}]},e.React.createElement(I,{title:"Quick Urls"},e.React.createElement(m.View,{style:[d.border,u]},e.React.createElement(p,{style:[]},b.map(function(l){return e.React.createElement(e.React.Fragment,null,e.React.createElement(F,{label:l?.label,trailing:e.React.createElement(A,null),onPress:l?.callback}))})))),e.React.createElement(I,{title:"Sound List",style:[]},e.React.createElement(p,{style:[]},r.storage.soundDatas.length>0&&r.storage.soundDatas?.map(function(l,M){return e.React.createElement(e.React.Fragment,null,e.React.createElement(F,{label:(l?.sound_name.length>0?`${l?.sound_name} [ ${l?.sound_id} ]`:l?.sound_id)||"Unknown",trailing:e.React.createElement(A,null),onPress:function(){return o.push("VendettaCustomPage",{title:"Editing Sound",render:function(){return e.React.createElement(N,{index:M})}})}}),M!==r.storage.soundDatas?.length-1&&e.React.createElement(z,null))}),e.React.createElement(F,{label:e.React.createElement(K,{value:a,onChangeText:s,placeholder:"Sound ID",placeholderTextColor:d.placeholder.color,selectionColor:e.constants.Colors.PRIMARY_DARK_100,onSubmitEditing:g,returnKeyType:"done",style:[d.input]}),trailing:e.React.createElement(Y,{onPress:g},e.React.createElement(X,{style:{opacity:1},source:Q}))})))))))}const{DCDSoundManager:R}=e.ReactNative.NativeModules,J=S.findByStoreName("SelectedChannelStore");_.getAssetIDByName("ic_warning_24px");const W=/((http(s)?\:\/\/)(((?!\?).)+\.(mp3|ogg|wav)))/i;let w=!1;r.storage.soundDatas??=[];const Z=r.storage.soundDatas,ee=function(o,a){return new Promise(function(s){return R.prepare(o,"notification",a,function(t,n){return s(n)})})};function v(o,a){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,t;w=!0,ee(o,a).then(async function(n){t=n.duration;let u=!1,b=null;for(let g=0;g<s;g++)setTimeout(async function(){u&&(u=!1,R.stop(a),clearTimeout(b)),u=!0,await R.play(a),b=setTimeout(function(){u=!1,R.stop(a),w=!1,setTimeout(function(){return R.release(a)},100)},t)},g*400)}).catch(function(n){alert("[SOUNDBANKS] ERROR!!! CHECK DEBUG LOGS"),console.log(n)})}function O(o){if(o.message.content&&o.channelId==J.getChannelId()&&!o.message.state){const a=o.message;if(!w){const s=Z.filter(function(t){return t?.sound_url?.match(W)});for(let t of s)if(!(!t?.sound_id||!t?.sound_url)){if(!t?.use_regex&&t?.sound_match&&a.content.includes(t?.sound_match)){v(t?.sound_url,t?.sound_id);break}else if(t?.use_regex){if(!t?.regex_flag||!t?.sound_regex)continue;const n=new RegExp(t?.sound_regex,t?.regex_flag||"gi");if(n.test(a.content)){if(t?.repeat_sound){const u=a?.content?.match?.(n)?.length??null;v(t?.sound_url,t?.sound_id,u)}else v(t?.sound_url,t?.sound_id);break}continue}}}}}var te={onLoad:async function(){r.storage.soundDatas??=[],e.FluxDispatcher.subscribe("MESSAGE_CREATE",O)},onUnload:async function(){e.FluxDispatcher.unsubscribe("MESSAGE_CREATE",O)},settings:q};return D.default=te,Object.defineProperty(D,"__esModule",{value:!0}),D})({},vendetta.plugin,vendetta.storage,vendetta.ui.components,vendetta.ui.assets,vendetta.metro.common,vendetta.metro,vendetta.ui,vendetta.ui.toasts);
