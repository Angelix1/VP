(function(S,a,I,b,y,e,D,f,h,k){"use strict";const{ScrollView:U,View:$,Text:K}=b.General,{FormLabel:Y,FormRow:X,FormSwitchRow:P,FormSection:x,FormDivider:F,FormInput:m}=b.Forms;D.findByName("useIsFocused");const _=e.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:f.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"3%",fontSize:24},sub:{color:f.semanticColors.TEXT_POSITIVE,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:f.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16}});function M(l){let{index:n}=l;const s=a.storage.soundDatas[n];I.useProxy(a.storage);const u=e.NavigationNative.useNavigation(),d=1e4;return React.createElement(U,null,React.createElement(x,{style:[_.basicPad]},React.createElement($,{style:[_.basicPad,_.sub]},React.createElement(x,{title:"Sound ID",style:[_.header]},React.createElement(K,{style:[_.basicPad,_.flagsText]},`${s.sound_id-d}`),React.createElement(m,{title:"Assign a Name",placeholder:"Meow!",value:s?.sound_name,onChange:function(r){return s.sound_name=r}}),React.createElement(m,{title:"Sound URL",placeholder:"https://example.com/audio/im_cool.ogg",value:s?.sound_url,onChange:function(r){return s.sound_url=r}}),!a.storage.soundDatas[n].use_regex&&React.createElement(React.Fragment,null,React.createElement(m,{title:"Normal Match (if included once in a message)",placeholder:"cat",value:s?.sound_match,onChange:function(r){return s.sound_match=r}})),a.storage.soundDatas[n].use_regex&&React.createElement(React.Fragment,null,React.createElement(F,null),React.createElement(m,{title:"Regex Syntax",placeholder:"c(a)+t",value:s?.sound_regex,onChange:function(r){return s.sound_regex=r}})),a.storage.soundDatas[n].use_regex&&React.createElement(React.Fragment,null,React.createElement(F,null),React.createElement(m,{title:"Flags",placeholder:"gi",value:s?.regex_flag,onChange:function(r){return s.regex_flag=r}})),a.storage.soundDatas[n].use_regex&&React.createElement(React.Fragment,null,React.createElement(F,null),React.createElement(P,{label:"Repeat sound for every match",value:a.storage.soundDatas[n].repeat_sound,onValueChange:function(r){return a.storage.soundDatas[n].repeat_sound=r}}))),React.createElement(x,null,React.createElement(P,{label:"Regular expression",subLabel:"Turn on to use regular expression",value:a.storage.soundDatas[n].use_regex,onValueChange:function(r){return a.storage.soundDatas[n].use_regex=r}})))),React.createElement(X,{label:React.createElement(Y,{text:"Delete",style:{color:f.rawColors.RED_400}}),onPress:function(){u.pop(),setTimeout(function(){return a.storage.soundDatas.splice(n,1)},300)}}))}const{ScrollView:G,View:p,TouchableOpacity:z,TextInput:H,Animated:v}=b.General,{FormIcon:j,FormArrow:B,FormRow:N,FormSection:L,FormDivider:q}=b.Forms,J=D.findByName("useIsFocused"),Q=D.findByName("LinearGradient"),W=y.getAssetIDByName("ic_add_24px"),O=y.getAssetIDByName("ic_unread_checkmark"),w=y.getAssetIDByName("Small"),R=e.stylesheet.createThemedStyleSheet({border:{borderRadius:12,overflow:"hidden"},shadowTemplate:{shadowOffset:{width:1,height:3},shadowOpacity:.9,shadowRadius:24,elevation:16},input:{fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM,color:f.semanticColors.TEXT_NORMAL},placeholder:{color:f.semanticColors.INPUT_PLACEHOLDER_TEXT}});function Z(){var l;I.useProxy(a.storage),a.storage.soundDatas??=[];const n=e.NavigationNative.useNavigation();J();const[s,u]=e.React.useState(""),[d]=e.React.useState(new v.Value(0));e.React.useEffect(function(){v.loop(v.timing(d,{toValue:4,duration:8e3,useNativeDriver:!0})).start()},[]);const r={backgroundColor:d.interpolate({inputRange:[0,1,2,3,4],outputRange:["rgba(188,31,31,0.5)","rgba(46,168,30,0.5)","rgba(48,179,173,0.5)","rgba(183,40,198,0.5)","rgba(188,31,31,0.5)"]})},t=1e4,c=[{label:"Vine Boom SFX",callback:function(){a.storage.soundDatas.push({sound_id:t+a.storage.soundDatas.length,sound_name:"Vine Boom SFX",sound_url:"https://raw.githubusercontent.com/Metastruct/garrysmod-chatsounds/master/sound/chatsounds/autoadd/memes/overused%20thud.ogg",sound_match:"moyai",sound_regex:"((<a?:)?.*?moy?ai.*?(:>)?|\u{1F5FF})",regex_flag:"gi",repeat_sound:!1,use_regex:!1}),h.showToast("Vine Boom Added",O)}},{label:"Discordo",callback:function(){a.storage.soundDatas.push({sound_id:t+a.storage.soundDatas.length,sound_name:"Discordo SFX",sound_url:"https://discord.com/assets/ae7d16bb2eea76b9b9977db0fad66658.mp3",sound_match:"discordo",sound_regex:"(dc|discord(o)?)",regex_flag:"gi",repeat_sound:!1,use_regex:!1}),h.showToast("Discordo Added",O)}}],i=function(){if(s){let o=Number(s);if(isNaN(o))return h.showToast("[SOUNDBANKS] Sound ID must be Number.",w);if(o<0)return h.showToast("[SOUNDBANKS] Sound ID cannot be negative",w);if(o=Math.round(Math.abs(o)),o=o+t,a.storage.soundDatas.some(function(g){return g.sound_id==o}))return h.showToast("[SOUNDBANKS] Sound ID must be unique.",w);a.storage.soundDatas.push({sound_id:o,sound_name:"",sound_url:"",sound_match:"",sound_regex:"",regex_flag:"gi",repeat_sound:!1,use_regex:!1}),u(""),n.push("VendettaCustomPage",{title:"Adding Sound",render:function(){var g;return e.React.createElement(M,{index:((g=a.storage.soundDatas)===null||g===void 0?void 0:g.length)-1})}})}};return e.React.createElement(e.React.Fragment,null,e.React.createElement(G,null,e.React.createElement(Q,{start:{x:.8,y:0},end:{x:0,y:.8},colors:["#b8ff34","#4bff61","#44f6ff","#4dafff","#413dff","#d63efd"],style:[R.border,R.shadowTemplate,{flex:1,margin:"1%",shadowColor:"#b8ff34"}]},e.React.createElement(p,{style:[R.border,r,{backgroundColor:"rgba(10, 10, 10, 0.9)",margin:2,padding:"3%"}]},e.React.createElement(L,{title:"Preconfigured Rules, click to use"},e.React.createElement(v.View,{style:[R.border,r]},e.React.createElement(p,{style:[]},c.map(function(o){return e.React.createElement(e.React.Fragment,null,e.React.createElement(N,{label:o?.label,trailing:e.React.createElement(B,null),onPress:o?.callback}))})))),e.React.createElement(L,{title:"Sound List",style:[]},e.React.createElement(p,{style:[]},a.storage.soundDatas.length>0&&((l=a.storage.soundDatas)===null||l===void 0?void 0:l.map(function(o,g){var C;return e.React.createElement(e.React.Fragment,null,e.React.createElement(N,{label:(o?.sound_name.length>0?`${o?.sound_name} [ ${o?.sound_id-t} ]`:o?.sound_id-t)||"Unknown",trailing:e.React.createElement(B,null),onPress:function(){return n.push("VendettaCustomPage",{title:"Editing Sound",render:function(){return e.React.createElement(M,{index:g})}})}}),g!==((C=a.storage.soundDatas)===null||C===void 0?void 0:C.length)-1&&e.React.createElement(q,null))})),e.React.createElement(N,{label:e.React.createElement(H,{value:s,onChangeText:u,placeholder:"Sound ID",placeholderTextColor:R.placeholder.color,selectionColor:e.constants.Colors.PRIMARY_DARK_100,onSubmitEditing:i,returnKeyType:"done",style:[R.input]}),trailing:e.React.createElement(z,{onPress:i},e.React.createElement(j,{style:{opacity:1},source:W}))})))))))}const{DCDSoundManager:E}=e.ReactNative.NativeModules,ee=D.findByStoreName("SelectedChannelStore"),te=/((http(s)?\:\/\/)(((?!\?).)+\.(mp3|ogg|wav)))/i;let T=!1;a.storage.soundDatas??=[];const ae=a.storage.soundDatas,ne=function(l,n){return new Promise(function(s){return E.prepare(l,"notification",n,function(u,d){return s(d)})})};function A(l,n){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,u;const d=2e3;T=!0,ne(l,n).then(async function(r){u=r?.duration??d;let t=!1,c=null;for(let i=0;i<s;i++)setTimeout(async function(){t&&(t=!1,E.stop(n),clearTimeout(c)),t=!0,await E.play(n),c=setTimeout(function(){t=!1,E.stop(n),T=!1,setTimeout(function(){return E.release(n)},100)},u)},i*400)}).catch(function(r){k.logger.log("[SOUNDBANKS] (playSound Func): "+r)})}function V(l){if(l.message.content&&l.channelId==ee.getChannelId()&&!l.message.state){const d=l.message;if(!T){const r=ae.filter(function(t){var c;return t==null||(c=t.sound_url)===null||c===void 0?void 0:c.match(te)});for(const t of r)if(!(!t?.sound_id||!t?.sound_url)){if(!t?.use_regex&&t?.sound_match&&d.content.includes(t?.sound_match)){A(t?.sound_url,t?.sound_id);break}else if(t?.use_regex){if(!t?.regex_flag||!t?.sound_regex)continue;const c=new RegExp(t?.sound_regex,t?.regex_flag||"gi");if(c.test(d.content)){if(t?.repeat_sound){var n,s,u;const i=(d==null||(u=d.content)===null||u===void 0||(s=u.match)===null||s===void 0||(n=s.call(u,c))===null||n===void 0?void 0:n.length)??null;A(t?.sound_url,t?.sound_id,i)}else A(t?.sound_url,t?.sound_id);break}}}}}}var se={onLoad:async function(){a.storage.soundDatas??=[],e.FluxDispatcher.subscribe("MESSAGE_CREATE",V)},onUnload:async function(){e.FluxDispatcher.unsubscribe("MESSAGE_CREATE",V)},settings:Z};return S.default=se,Object.defineProperty(S,"__esModule",{value:!0}),S})({},vendetta.plugin,vendetta.storage,vendetta.ui.components,vendetta.ui.assets,vendetta.metro.common,vendetta.metro,vendetta.ui,vendetta.ui.toasts,vendetta);
