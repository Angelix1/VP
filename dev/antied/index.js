(function(U,ce,p,o,x,C,g,e,y,O,de,_,ue){"use strict";const{openLazy:ge,hideActionSheet:Ze}=p.findByProps("openLazy","hideActionSheet");function H(r,n){if(r!=null&&n!=null)for(const t of Object.keys(n))typeof n[t]=="object"&&!Array.isArray(n[t])?(typeof r[t]!="object"&&(r[t]={}),H(r[t],n[t])):r[t]??=n[t]}function fe(r,n){try{ge(new Promise(function(t){return t({default:r})}),"ActionSheet",n)}catch(t){ce.logger.error(t.stack),showToast("Got error when opening ActionSheet! Please check debug logs")}}const G={toInt(r){return r=r.replace(/^#/,""),parseInt(r,16)},toHex(r){return"#"+r.toString(16).toUpperCase()}},{ScrollView:he,View:$,Text:Re,TouchableOpacity:j,TextInput:et,Image:pe,Animated:T}=C.General,{FormLabel:Ee,FormIcon:ye,FormArrow:tt,FormRow:k,FormSwitch:me,FormSwitchRow:at,FormSection:Ae,FormDivider:be,FormInput:J}=C.Forms,Ce=p.findByName("useIsFocused");p.findByProps("BottomSheetScrollView");const W=p.findByStoreName("UserStore"),X=p.findByProps("showUserProfile");g.getAssetIDByName("ic_add_24px"),g.getAssetIDByName("ic_arrow"),g.getAssetIDByName("ic_minus_circle_24px"),g.getAssetIDByName("Check"),g.getAssetIDByName("Small");function Q(r){return e.React.createElement(ye,{style:{opacity:1},source:g.getAssetIDByName(r)})}const S=e.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:y.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"3%",fontSize:24},sub:{color:y.semanticColors.TEXT_POSITIVE,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:y.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16},container:{marginTop:25,marginLeft:"5%",marginBottom:-15,flexDirection:"row"},textContainer:{paddingLeft:15,paddingTop:5,flexDirection:"column",flexWrap:"wrap",shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:.2,shadowRadius:4.65,elevation:8},image:{width:75,height:75,borderRadius:10,shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:.2,shadowRadius:4.65,elevation:8},mainText:{opacity:.975,letterSpacing:.25},header:{color:y.semanticColors.HEADER_PRIMARY,fontFamily:e.constants.Fonts.DISPLAY_BOLD,fontSize:25,letterSpacing:.25},subHeader:{color:y.semanticColors.HEADER_SECONDARY,fontSize:12.75}});function K(r){let{index:n}=r;x.useProxy(o.storage);let t=o.storage?.inputs?.ignoredUserList[n];const s=e.React.useRef(new T.Value(1)).current,a=function(){return T.spring(s,{toValue:1.1,duration:10,useNativeDriver:!0}).start()},f=function(){return T.spring(s,{toValue:1,duration:250,useNativeDriver:!0}).start()},l={transform:[{scale:s}]};let u=W.getUser(t?.id),d=Object.values(W.getUsers());u||(u=d.find(function(i){return i?.username==t?.username})),u||(u=d.find(function(i){return i?.username?.toLowerCase()==t?.username?.toLowerCase()}));const A=e.NavigationNative.useNavigation();return Ce(),e.React.createElement(e.React.Fragment,null,e.React.createElement(he,null,e.React.createElement($,{style:[S.basicPad,S.sub]},e.React.createElement(Ae,{title:"User Setting",style:[S.header]},e.React.createElement(k,{label:"Find User Id or Username",leading:Q("ic_search"),onPress:function(){u&&!t.username?.length?t.username=u.username:u&&!t.id?.length?t.id=u.id:O.showToast("Cannot find User Id/Username.")}}),e.React.createElement(J,{title:"User Username | Case Sensitive",placeholder:"Missing No",value:t?.username,onChange:function(i){return t.username=i}}),e.React.createElement(J,{title:"User Id",placeholder:"Missing No",value:t?.id,onChange:function(i){return t.id=i}}),e.React.createElement(k,{label:"User is webhook?",subLabel:"User is webhook or system, and not BOT or Normal User.",leading:Q("ic_webhook_24px"),trailing:e.React.createElement(me,{value:t?.isWebhook||!1,onValueChange:function(i){return t.isWebhook=i}})})),u&&e.React.createElement($,{style:[S.container,{paddingBottom:10}]},e.React.createElement(j,{onPress:function(){return X.showUserProfile?.({userId:u?.id})},onPressIn:a,onPressOut:f},e.React.createElement(T.View,{style:l},e.React.createElement(pe,{source:{uri:u?.getAvatarURL?.()?.replace?.("webp","png")||"https://cdn.discordapp.com/embed/avatars/2.png"},style:{width:128,height:128,borderRadius:10}}))),e.React.createElement($,{style:S.textContainer},e.React.createElement(j,{onPress:function(){return X.showUserProfile({userId:u?.id})}},e.React.createElement(Re,{style:[S.mainText,S.header]},u?.username||t?.username||"No Name"))),e.React.createElement(be,null)),e.React.createElement(k,{label:e.React.createElement(Ee,{text:"Remove User from Ignore List",style:{color:y.rawColors.RED_400}}),onPress:function(){A.pop(),o.storage?.inputs?.ignoredUserList?.splice(n,1)}}))))}const{ScrollView:Se,View:Ie,Text:nt,TouchableOpacity:we,TextInput:De}=C.General,{FormLabel:rt,FormIcon:Fe,FormArrow:_e,FormRow:z,FormSwitch:st,FormSwitchRow:it,FormSection:Be,FormDivider:Pe,FormInput:ot}=C.Forms;function q(r,n){return React.createElement(Fe,{style:{opacity:1},source:n?r:g.getAssetIDByName(r)})}const Le=p.findByName("useIsFocused");p.findByProps("BottomSheetScrollView");const{getUser:Te}=p.findByProps("getUser"),ve=g.getAssetIDByName("ic_add_24px");g.getAssetIDByName("ic_arrow"),g.getAssetIDByName("ic_minus_circle_24px"),g.getAssetIDByName("Check"),g.getAssetIDByName("Small");const Me=g.getAssetIDByName("ic_trash_24px"),I=e.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:y.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"3.5%",fontSize:24},sub:{color:y.semanticColors.TEXT_POSITIVE,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:y.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16},input:{fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM,color:y.semanticColors.TEXT_NORMAL},placeholder:{color:y.semanticColors.INPUT_PLACEHOLDER_TEXT}});function Ne(){x.useProxy(o.storage);let[r,n]=React.useState("");const t=e.NavigationNative.useNavigation();Le();let s=o.storage?.inputs?.ignoredUserList??[];const a=function(){if(r){if(isNaN(parseInt(r)))s.push({id:void 0,username:r});else{let f=Te(r);if(f)s.push({id:f?.id,username:"",showUser:!1,isWebhook:!1});else return O.showToast("Invalid User Id")}n(""),t.push("VendettaCustomPage",{title:"Adding User to Ignore List",render:function(){return React.createElement(K,{index:s?.length-1})}})}};return React.createElement(React.Fragment,null,React.createElement(Se,{style:{flex:1}},React.createElement(Be,{style:[I.header,I.basicPad]},React.createElement(Ie,{style:[I.header,I.sub]},s.length>0&&React.createElement(z,{label:"Clear List",trailing:q(Me,!0),onPress:function(){s.length!==0&&de.showConfirmationAlert({title:"Hol up, wait a minute!",content:`This will removes in total ${s.length} users from ignore list.`,confirmText:"Ye",cancelText:"Nah",confirmColor:"brand",onConfirm:function(){o.storage.inputs.ignoredUserList=[]}})}}),s?.map(function(f,l){return React.createElement(React.Fragment,null,React.createElement(z,{label:f?.username||f?.id||"No Data",trailing:React.createElement(_e,null),onPress:function(){return t.push("VendettaCustomPage",{title:"Editing User",render:function(){return React.createElement(K,{index:l})}})}}),l!==s?.length-1&&React.createElement(Pe,null))}),React.createElement(z,{label:React.createElement(De,{value:r,onChangeText:n,placeholder:"User ID or Username",placeholderTextColor:I.placeholder.color,selectionColor:e.constants.Colors.PRIMARY_DARK_100,onSubmitEditing:a,returnKeyType:"done",style:I.input}),trailing:React.createElement(we,{onPress:a},q(ve,!0))})))))}const Ue=p.findByName("CustomColorPickerActionSheet"),{ScrollView:xe,View:v,Text:lt,TouchableOpacity:Z,TextInput:ct,Pressable:dt,Image:Oe}=C.General,{FormLabel:ut,FormIcon:M,FormArrow:gt,FormRow:N,FormSwitch:ee,FormSwitchRow:ft,FormSection:B,FormDivider:w,FormInput:$e}=C.Forms,P=e.stylesheet.createThemedStyleSheet({text:{color:y.semanticColors.HEADER_SECONDARY,paddingLeft:"5.5%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:e.constants.Fonts.PRIMARY_BOLD,fontSize:16},subText:{color:y.semanticColors.TEXT_POSITIVE,paddingLeft:"6%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,fontSize:12},input:{fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM,color:y.semanticColors.TEXT_NORMAL},placeholder:{color:y.semanticColors.INPUT_PLACEHOLDER_TEXT}}),ke=g.getAssetIDByName("ic_add_24px");p.findByProps("getUser");const ze=p.findByName("useIsFocused"),te=[{id:"minimalistic",default:!0,label:"Minimalistic Settings",subLabel:"Removes all Styling (Enabled by Default)"},{id:"useBackgroundColor",default:!1,label:"Enable Background Color",subLabel:"Background Color for Deleted Message, similiar to Mention but Customizeable"},{id:"ignoreBots",default:!1,label:"Ignore Bots",subLabel:"Ignore bot deleted messages."}],ae=[{id:"deletedMessageColor",title:"Customize Deleted Message Color",type:"default",defaultColor:"#E40303"},{id:"deletedMessageBackgroundColor",title:"Customize Deleted Background Message Color",type:"default",defaultColor:"#FF2C2F"}],ne=[{id:"deletedMessageBuffer",title:"Customize Deleted Message",type:"default",placeholder:"This message is deleted"},{id:"editedMessageBuffer",title:"Customize Edited Separator",type:"default",placeholder:"`[ EDITED ]`"}];function Ve(){x.useProxy(o.storage);const r=e.NavigationNative.useNavigation();ze(),o.storage?.inputs?.ignoredUserList;const n=function(){r.push("VendettaCustomPage",{title:"List of Ignored Users",render:function(){return e.React.createElement(Ne,null)}})};return e.React.createElement(xe,null,e.React.createElement(v,{style:{marginTop:20,marginBottom:20}},e.React.createElement(B,{title:"Plugin Setting",style:[P.header]},e.React.createElement(N,{label:"Customization",subLabel:"Show customization for the plugin",leading:e.React.createElement(M,{style:{opacity:1},source:g.getAssetIDByName("ic_category_16px")}),trailing:e.React.createElement(ee,{value:o.storage?.switches?.customizeable??!1,onValueChange:function(t){return o.storage.switches.customizeable=t}})}),o.storage?.switches?.customizeable&&e.React.createElement(e.React.Fragment,null,e.React.createElement(B,{title:"Switches"}),e.React.createElement(w,null)),o.storage?.switches?.customizeable&&e.React.createElement(e.React.Fragment,null,e.React.createElement(v,{style:[P.subText]},te?.map(function(t,s){return e.React.createElement(e.React.Fragment,null,e.React.createElement(N,{label:t?.label,subLabel:t?.subLabel,leading:t?.icon&&e.React.createElement(M,{style:{opacity:1},source:g.getAssetIDByName(t?.icon)}),trailing:"id"in t?e.React.createElement(ee,{value:o.storage?.switches[t?.id]??t?.default,onValueChange:function(a){return o.storage.switches[t?.id]=a}}):void 0}),s!==te?.length-1&&e.React.createElement(w,null))}))),o.storage?.switches?.customizeable&&e.React.createElement(e.React.Fragment,null,e.React.createElement(B,{title:"Colors Pickers"}),e.React.createElement(w,null)),o.storage?.switches?.customizeable&&e.React.createElement(e.React.Fragment,null,e.React.createElement(v,{style:[P.subText]},ae?.map(function(t){const s=function(){return fe(Ue,{color:G?.toInt(o.storage.inputs[t.id]||t?.defaultColor||"#000"),onSelect:function(a){const f=G?.toHex(a);o.storage.inputs[t.id]=f}})};return e.React.createElement(e.React.Fragment,null,e.React.createElement(N,{label:t?.title,subLabel:"Click to Update",onPress:s,trailing:e.React.createElement(Z,{onPress:s},e.React.createElement(Oe,{source:{uri:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mJsrQAAAgwBAJ9P6qYAAAAASUVORK5CYII="},style:{width:32,height:32,borderRadius:10,backgroundColor:o.storage?.inputs[t.id]||ae.find(function(a){return a?.id==t?.id})?.defaultColor||"#000"}}))}))}))),o.storage?.switches?.customizeable&&e.React.createElement(e.React.Fragment,null,e.React.createElement(B,{title:"Texts Variables"}),e.React.createElement(w,null)),o.storage?.switches?.customizeable&&e.React.createElement(e.React.Fragment,null,e.React.createElement(v,{style:[P.subText]},ne?.map(function(t,s){return e.React.createElement(e.React.Fragment,null,e.React.createElement($e,{title:t?.title,keyboardType:t?.type,placeholder:t?.placeholder,value:o.storage?.inputs[t.id]??t?.placeholder,onChange:function(a){return o.storage.inputs[t.id]=a.toString()}}),s!==ne.length-1&&e.React.createElement(w,null))})))),e.React.createElement(B,{title:"Ignore List Setting",style:[P.header]},e.React.createElement(N,{label:"Add User to List",subLabel:"List of ignored users for the plugin",leading:e.React.createElement(M,{style:{opacity:1},source:g.getAssetIDByName("ic_members")}),onPress:n,trailing:e.React.createElement(Z,{onPress:n},e.React.createElement(M,{style:{opacity:1},source:ke}))}),e.React.createElement(w,null))))}var m=void 0;p.findByProps("openLazy","hideActionSheet");const re=p.findByProps("getMessage","getMessages"),V=p.findByProps("getChannel","getDMFromUserId");function Ye(r,n){return _.instead("dispatch",e.FluxDispatcher,function(t,s){const[a]=t,f=a?.type;if(f=="MESSAGE_DELETE"){let l=function(d,A,i,h){const c=re.getMessage(a?.channelId,a?.id),R=c?.author?.id,b=c?.author?.username,D=!c?.content&&c?.attachments?.length==0&&c?.embeds?.length==0;return!R||!b||D||o.storage?.switches?.ignoreBots&&c?.author?.bot||o.storage?.inputs?.ignoredUserList?.length>0&&o.storage.inputs.ignoredUserList?.some(function(E){return E?.id==c?.author?.id||E.username==c.author.username})||(i[0]={type:"MESSAGE_UPDATE",channelId:c?.channel_id||a?.channelId,message:{...c,content:c?.content,type:0,flags:64,channel_id:c?.channel_id||a?.channelId,guild_id:V?.getChannel(c?.channel_id)?.guild_id,timestamp:`${new Date().toJSON()}`,state:"SENT",dumass:99},optimistic:!1,sendMessageOptions:{},isPushNotification:!1},h.push(a?.id||c?.id)),d.apply(A,i)};const u=V.getChannel(a?.channelId?.toString?.());return[1,3].some(function(d){return d==u.type})?a.hasOwnProperty("guildId")?n?.includes(a?.id)?(n=n?.filter(function(d){return d!=a?.id}),s.apply(m,t)):l(s,m,t,n):n?.includes(a?.id)?(n=n?.filter(function(d){return d!=a?.id}),s.apply(m,t)):(t[0]={type:"MESSAGE_CAT"},s.apply(m,t)):!a.guildId||!a.hasOwnProperty("guildId")?n?.includes(a?.id)?(n=n?.filter(function(d){return d!=a?.id}),s.apply(m,t)):(t[0]={type:"MESSAGE_CAT"},s.apply(m,t)):n?.includes(a?.id)?(n=n?.filter(function(d){return d!=a?.id}),s.apply(m,t)):l(s,m,t,n)}if(f=="MESSAGE_UPDATE"){if(a?.removeHistory||a?.message?.author?.bot)return s.apply(m,t);const l=re.getMessage(a?.message?.channel_id,a?.message?.id),u=l?.author?.id,d=l?.author?.username,A=!l?.content&&l?.attachments?.length==0&&l?.embeds?.length==0;if(!u||!d||A)return s.apply(m,t);const i=a?.message?.content==l?.content,h=a?.message?.embeds.some(function(E){return E?.url==l?.content||E?.thumbnail?.url==l?.content||l?.content.includes(E?.url)||l?.content.includes(E?.thumbnail?.url)}),c=a?.message?.embeds?.size||a?.message?.embeds?.length,R=l?.embeds?.size||l?.embeds?.length;if(i||h||!a?.message?.content&&c!=R||o.storage?.inputs?.ignoredUserList?.length>0&&o.storage.inputs.ignoredUserList?.some(function(E){return E?.id==l?.author?.id||E.username==l.author.username}))return s.apply(m,t);let b=o.storage?.inputs?.editedMessageBuffer||"`[ EDITED ]`";b=b+`

`;const D=a?.message||l;return t[0]={type:"MESSAGE_UPDATE",message:{...D,content:`${l?.content}  ${b}${a?.message?.content??""}`,guild_id:V.getChannel(l?.channel_id)?.guild_id,edited_timestamp:"invalid_timestamp"}},r.some(function(E){return E==l?.id||E==a?.message?.id})||r.push(l?.id||a?.message?.id),s.apply(m,t)}return s.apply(m,t)})}const He=p.findByProps("startEditMessage");function Ge(){return _.before("startEditMessage",He,function(r){let n=o.storage?.inputs?.editedMessageBuffer||"`[ EDITED ]`";n=n+`

`;const[t,s,a]=r,f=a.split(n);return r[2]=f[f.length-1],r})}const{DCDChatManager:je}=e.ReactNative.NativeModules;function Je(r){return _.before("updateRows",je,function(n){let t=JSON.parse(n[1]);const{deletedMessageColor:s,deletedMessageBackgroundColor:a,deletedMessageBuffer:f}=o.storage.inputs,{useBackgroundColor:l,minimalistic:u}=o.storage.switches;function d(i,h){i||(i=h);const c=i?.trim();if(c.startsWith("#")){const R=c.slice(1);if(/^[0-9A-Fa-f]{6}$/.test(R))return"#"+R.toUpperCase()}else{const R=c;if(/^[0-9A-Fa-f]{6}$/.test(R))return"#"+R.toUpperCase()}return h||"#000"}function A(i,h){const c=["text","heading","s","u","em","strong","list","blockQuote"];if(Array.isArray(i))return i.map(A);if(typeof i=="object"&&i!==null){const{content:R,type:b,target:D,items:E}=i;if(!c.includes(b))return i;if(b==="text"&&R&&R.length>=1)return{content:[{content:R,type:"text"}],target:"usernameOnClick",type:"link",context:{username:1,medium:!0,usernameOnClick:{action:"0",userId:"0",linkColor:e.ReactNative.processColor(`${h?.toString()}`),messageChannelId:"0"}}};const Y=A(R),le=E?E.map(A):void 0;if(Y!==R||le!==E||!c.includes(b)){const F={...i,content:Y};return b==="blockQuote"&&D&&(F.content=Y,F.target=D),b==="list"&&F?.content&&delete F.content,E&&(F.items=le),F}}return i}t.forEach(function(i){if(i?.type==1&&r?.includes(i?.message?.id)){if(!u||o.storage.switches?.minimalistic==!1){const h=d(s,"E40303"),c=A(i?.message?.content,h);i.message.content=c}if(i.message.edited=f||"This message is deleted",l&&!u){const h=d(a,"FF2C2F"),c=`${h.toString()}33`,R=`${h.toString()}CC`;i.backgroundHighlight={backgroundColor:e.ReactNative.processColor(c),gutterColor:e.ReactNative.processColor(R)}}}}),n[1]=JSON.stringify(t)})}const se=p.findByProps("openLazy","hideActionSheet"),We=p.findByProps("getMessage","getMessages"),Xe=p.findByProps("getChannel","getDMFromUserId"),{FormRow:Qe,FormIcon:Ke}=C.Forms;H(o.storage,{switches:{customizeable:!1,useBackgroundColor:!1,ignoreBots:!1,minimalistic:!0},inputs:{deletedMessageColor:void 0,deletedMessageBackgroundColor:void 0,deletedMessageBuffer:void 0,editedMessageBuffer:void 0,ignoredUserList:[]}});let ie=[],L=[],oe=[];var qe={onLoad:function(){ie.push(Ye(L,oe),Ge(),Je(oe),_.before("openLazy",se,function(r){let[n,t,s]=r;const a=s?.message;t!=="MessageLongPressActionSheet"||!a||n.then(function(f){const l=_.after("default",f,function(u,d){e.React.useEffect(function(){return function(){l()}},[]);const A=ue.findInReactTree(d,function(h){return h?.[0]?.type?.name==="ButtonRow"});if(!A)return d;const i=We.getMessage(a.channel_id,a?.id);(L.includes(a?.id)||L.includes(i?.id))&&A.unshift(e.React.createElement(Qe,{label:"Remove EDITED History",leading:e.React.createElement(Ke,{style:{opacity:1},source:g.getAssetIDByName("ic_edit_24px")}),onPress:function(){let h=o.storage?.inputs?.editedMessageBuffer||"`[ EDITED ]`";h=h+`

`;const c=a?.content?.split(h),R=c[c.length-1];e.FluxDispatcher.dispatch({type:"MESSAGE_UPDATE",message:{...i,content:`${R}`,guild_id:Xe.getChannel(i.channel_id).guild_id},removeHistory:!0}),L=L.filter(function(b){return b!=a?.id}),se.hideActionSheet(),O.showToast("[Message Logger] Logs Removed",g.getAssetIDByName("ic_edit_24px"))}}))})})}))},onUnload:function(){for(const r of ie)r()},settings:Ve};return U.default=qe,Object.defineProperty(U,"__esModule",{value:!0}),U})({},vendetta,vendetta.metro,vendetta.plugin,vendetta.storage,vendetta.ui.components,vendetta.ui.assets,vendetta.metro.common,vendetta.ui,vendetta.ui.toasts,vendetta.ui.alerts,vendetta.patcher,vendetta.utils);
