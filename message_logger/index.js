(function(B,s,P,C,d,e,u,g,M,re,F){"use strict";var se=[{version:"End Of Life",patch:["This plugin will not be updated anymore, until further infos."]},{version:"v0.0.811",patch:["Added minimalistic option"]},{version:"v0.0.810",patch:["Added remove edited log history when long press a message.","Fixed Message fails to logs. (lmk if persist).","Added Ignore user list, by UserID and Name."]},{version:"v0.0.8",patch:["Added Customizeable Text Color for Deleted Messages.","Added Customizeable Background Color for Deleted Messages.","Added Customization for Edited Messages Separator.","Added Fix for when editing a own message it only take the last edited history rather than everything."]}];const{ScrollView:ie,View:L,Text:oe,TouchableOpacity:k,TextInput:$e,Image:le,Animated:N}=C.General,{FormLabel:ce,FormArrow:ze,FormRow:b,FormSwitch:V,FormSwitchRow:ke,FormSection:Y,FormDivider:de,FormInput:H}=C.Forms;u.findByName("Icon");const ue=u.findByName("useIsFocused");u.findByProps("BottomSheetScrollView");const G=u.findByStoreName("UserStore"),j=u.findByProps("showUserProfile");d.getAssetIDByName("ic_add_24px"),d.getAssetIDByName("ic_arrow"),d.getAssetIDByName("ic_minus_circle_24px"),d.getAssetIDByName("Check"),d.getAssetIDByName("Small");const m=e.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:g.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"3%",fontSize:24},sub:{color:g.semanticColors.TEXT_POSITIVE,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:g.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16},container:{marginTop:25,marginLeft:"5%",marginBottom:-15,flexDirection:"row"},textContainer:{paddingLeft:15,paddingTop:5,flexDirection:"column",flexWrap:"wrap",shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:.2,shadowRadius:4.65,elevation:8},image:{width:75,height:75,borderRadius:10,shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:.2,shadowRadius:4.65,elevation:8},mainText:{opacity:.975,letterSpacing:.25},header:{color:g.semanticColors.HEADER_PRIMARY,fontFamily:e.constants.Fonts.DISPLAY_BOLD,fontSize:25,letterSpacing:.25},subHeader:{color:g.semanticColors.HEADER_SECONDARY,fontSize:12.75}});function X(r){let{index:n}=r,t=s.storage?.users[n];P.useProxy(s.storage);const a=e.React.useRef(new N.Value(1)).current,o=function(){return N.spring(a,{toValue:1.1,duration:10,useNativeDriver:!0}).start()},i=function(){return N.spring(a,{toValue:1,duration:250,useNativeDriver:!0}).start()},h={transform:[{scale:a}]};let l=G.getUser(t?.id),f=Object.values(G.getUsers());l||(l=f.find(function(c){return c?.username==t?.username})),l||(l=f.find(function(c){return c?.username?.toLowerCase()==t?.username?.toLowerCase()}));const y=e.NavigationNative.useNavigation();return ue(),e.React.createElement(e.React.Fragment,null,e.React.createElement(ie,null,e.React.createElement(Y,{style:[m.basicPad]},e.React.createElement(L,{style:[m.basicPad,m.sub]},e.React.createElement(Y,{title:"User Setting",style:[m.header]},e.React.createElement(b,{label:"Find User Id or Username",leading:e.React.createElement(b.Icon,{source:d.getAssetIDByName("ic_search")}),onPress:function(){l&&!t.username?.length?t.username=l.username:l&&!t.id?.length?t.id=l.id:M.showToast("Cannot find User Id/Username.")}}),e.React.createElement(H,{title:"User Username | Case Sensitive",placeholder:"Missing No",value:t?.username,onChange:function(c){return t.username=c}}),e.React.createElement(H,{title:"User Id",placeholder:"Missing No",value:t?.id,onChange:function(c){return t.id=c}}),e.React.createElement(b,{label:"User is webhook?",subLabel:"User is webhook or system, and not BOT or Normal User.",leading:e.React.createElement(b.Icon,{source:d.getAssetIDByName("ic_webhook_24px")}),trailing:e.React.createElement(V,{value:t?.isWebhook||!1,onValueChange:function(c){return t.isWebhook=c}})})),l&&e.React.createElement(b,{label:"Show User Profile",leading:e.React.createElement(b.Icon,{source:d.getAssetIDByName("ic_info")}),trailing:e.React.createElement(V,{value:t?.showUser||!1,onValueChange:function(c){return t.showUser=c}})}),t?.showUser&&e.React.createElement(L,{style:[m.container,{paddingBottom:10}]},e.React.createElement(k,{onPress:function(){return j.showUserProfile?.({userId:l?.id})},onPressIn:o,onPressOut:i},e.React.createElement(N.View,{style:h},e.React.createElement(le,{style:[m.image],source:function(){let c=l?.getAvatarURL?.()?.replace?.("webp","png");return c||(c="https://cdn.discordapp.com/embed/avatars/1.png?size=300"),{uri:c}}}))),e.React.createElement(L,{style:m.textContainer},e.React.createElement(k,{onPress:function(){return j.showUserProfile({userId:l?.id})}},e.React.createElement(oe,{style:[m.mainText,m.header]},l?.username||t?.username||"No Name"))),e.React.createElement(de,null)))),e.React.createElement(b,{label:e.React.createElement(ce,{text:"Remove User from Ignore List",style:{color:g.rawColors.RED_400}}),onPress:function(){y.pop(),s.storage.users?.splice(n,1)}})))}const{ScrollView:ge,View:he,Text:Ve,TouchableOpacity:fe,TextInput:Ee}=C.General,{FormLabel:Ye,FormArrow:Re,FormRow:x,FormSwitch:He,FormSwitchRow:Ge,FormSection:me,FormDivider:ye,FormInput:je}=C.Forms,pe=u.findByName("Icon"),Ce=u.findByName("useIsFocused");u.findByProps("BottomSheetScrollView");const{getUser:Ie}=u.findByProps("getUser"),Se=d.getAssetIDByName("ic_add_24px");d.getAssetIDByName("ic_arrow"),d.getAssetIDByName("ic_minus_circle_24px"),d.getAssetIDByName("Check"),d.getAssetIDByName("Small");const be=d.getAssetIDByName("ic_trash_24px"),A=e.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:g.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"3.5%",fontSize:24},sub:{color:g.semanticColors.TEXT_POSITIVE,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:g.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16},input:{fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM,color:g.semanticColors.TEXT_NORMAL},placeholder:{color:g.semanticColors.INPUT_PLACEHOLDER_TEXT}});function De(){P.useProxy(s.storage);let[r,n]=React.useState("");const t=e.NavigationNative.useNavigation();Ce();let a=s.storage.users??[];const o=function(){if(r){if(isNaN(parseInt(r)))a.push({id:void 0,username:r});else{let i=Ie(r);if(i)a.push({id:i?.id,username:"",showUser:!1,isWebhook:!1});else return M.showToast("Invalid User Id")}n(""),t.push("VendettaCustomPage",{title:"Adding User to Ignore List",render:function(){return React.createElement(X,{index:a?.length-1})}})}};return React.createElement(React.Fragment,null,React.createElement(ge,{style:{flex:1}},React.createElement(me,{style:[A.header,A.basicPad]},React.createElement(he,{style:[A.header,A.sub]},a.length>0&&React.createElement(x,{label:"Clear List",trailing:React.createElement(C.Forms.FormRow.Icon,{source:be}),onPress:function(){a.length!==0&&re.showConfirmationAlert({title:"Hol up, wait a minute!",content:`This will removes in total ${a.length} users from ignore list.`,confirmText:"Ye",cancelText:"Nah",confirmColor:"brand",onConfirm:function(){s.storage.users=[]}})}}),a?.map(function(i,h){return React.createElement(React.Fragment,null,React.createElement(x,{label:i?.username||i?.id||"No Data",trailing:React.createElement(Re,null),onPress:function(){return t.push("VendettaCustomPage",{title:"Editing User",render:function(){return React.createElement(X,{index:h})}})}}),h!==a?.length-1&&React.createElement(ye,null))}),React.createElement(x,{label:React.createElement(Ee,{value:r,onChangeText:n,placeholder:"User ID or Username",placeholderTextColor:A.placeholder.color,selectionColor:e.constants.Colors.PRIMARY_DARK_100,onSubmitEditing:o,returnKeyType:"done",style:A.input}),trailing:React.createElement(fe,{onPress:o},React.createElement(pe,{source:Se}))})))))}const{ScrollView:Ae,View:_,Text:U,TouchableOpacity:Fe,TextInput:Xe}=C.General,{FormLabel:Je,FormArrow:We,FormRow:I,FormSwitch:v,FormSwitchRow:Qe,FormSection:O,FormDivider:J,FormInput:_e}=C.Forms,E=e.stylesheet.createThemedStyleSheet({text:{color:g.semanticColors.HEADER_SECONDARY,paddingLeft:"5.5%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:e.constants.Fonts.PRIMARY_BOLD,fontSize:16},subText:{color:g.semanticColors.TEXT_POSITIVE,paddingLeft:"6%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,fontSize:12},input:{fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM,color:g.semanticColors.TEXT_NORMAL},placeholder:{color:g.semanticColors.INPUT_PLACEHOLDER_TEXT}}),we=u.findByName("Icon"),Ne=d.getAssetIDByName("ic_add_24px");u.findByProps("getUser");const ve=u.findByName("useIsFocused");let Te=function(r){return r.toUpperCase()},W=[{id:"deletedMessageColor",title:"Customize Deleted Message Color ( DO NOT INCLUDE # )",type:"default",placeholder:"E40303"},{id:"deletedMessage",title:"Customize Deleted Message",type:"default",placeholder:"This message is deleted"},{id:"editedMessage",title:"Customize Edited Separator",type:"default",placeholder:"`[ EDITED ]`"},{id:"deletedMessageColorBackground",title:"Customize Deleted Background Message Color ( DO NOT INCLUDE # )",type:"default",placeholder:"FF2C2F"}];const Q=[{id:"useBackgroundColor",default:!1,label:"Enable Background Color",subLabel:"Background Color for Deleted Message, similiar to Mention but Customizeable"},{id:"ignoreBots",default:!1,label:"Ignore Bots",subLabel:"Ignore bot deleted messages."}];function Be(){P.useProxy(s.storage);const r=e.NavigationNative.useNavigation();ve(),s.storage.users;const n=function(){r.push("VendettaCustomPage",{title:"List of Ignored Users",render:function(){return e.React.createElement(De,null)}})};return e.React.createElement(Ae,null,e.React.createElement(_,{style:{marginTop:20,marginBottom:20}},e.React.createElement(O,{title:"Plugin Setting",style:[E.header]},e.React.createElement(I,{label:"Customization",subLabel:"Show customization for the plugin",leading:e.React.createElement(I.Icon,{source:d.getAssetIDByName("ic_category_16px")}),trailing:e.React.createElement(v,{value:s.storage.customize??!1,onValueChange:function(t){return s.storage.customize=t}})}),s.storage.customize&&e.React.createElement(_,{style:[E.subText]},e.React.createElement(I,{label:"Minimalistic Settings",subLabel:"Removes all Styling (Enabled by Default)",trailing:e.React.createElement(v,{value:s.storage.minimal??!0,onValueChange:function(t){return s.storage.minimal=t}})})),s.storage.customize&&e.React.createElement(_,{style:[E.subText]},W.map(function(t,a){return e.React.createElement(e.React.Fragment,null,e.React.createElement(_e,{title:t.title,keyboardType:t.type,placeholder:t.placeholder,value:s.storage[t.id]??t.placeholder,onChange:function(o){return s.storage[t.id]=o.toString()}}),a!==W.length-1&&e.React.createElement(J,null))})),s.storage.customize&&e.React.createElement(_,{style:[E.subText]},Q.map(function(t,a){return e.React.createElement(e.React.Fragment,null,e.React.createElement(I,{label:t.label,subLabel:t.subLabel,leading:t.icon&&e.React.createElement(I.Icon,{source:d.getAssetIDByName(t.icon)}),trailing:"id"in t?e.React.createElement(v,{value:s.storage[t.id]??t.default,onValueChange:function(o){return s.storage[t.id]=o}}):void 0}),a!==Q.length-1&&e.React.createElement(J,null))})),s.storage.customize&&e.React.createElement(U,{style:[E.subText,E.optionText]},Te("Reload the Plugin to Apply Color Change"))),e.React.createElement(O,{title:"Ignore List Setting",style:[E.header]},e.React.createElement(_,{style:{color:g.semanticColors.TEXT_POSITIVE,paddingLeft:"8%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,fontSize:12}},e.React.createElement(I,{label:"Add User to List",onPress:n,trailing:e.React.createElement(Fe,{onPress:n},e.React.createElement(we,{source:Ne}))}))),e.React.createElement(O,{title:"Plugin Updates",style:[E.header]},e.React.createElement(I,{label:"Show Changes",subLabel:"Show New stuff, Fixes, etc for the plugin",leading:e.React.createElement(I.Icon,{source:d.getAssetIDByName("ic_info")}),trailing:e.React.createElement(v,{value:s.storage.showChanges??!1,onValueChange:function(t){return s.storage.showChanges=t}})}),s.storage.showChanges&&se?.map(function(t,a){return e.React.createElement(e.React.Fragment,null,e.React.createElement(U,{style:[E.text]},t.version||"Dev Version"),t.patch?.map(function(o){return e.React.createElement(e.React.Fragment,null,e.React.createElement(U,{style:[E.subText]},`- ${o}`))}))}))))}const Pe=u.findByProps("startEditMessage"),$=u.findByProps("getMessage","getMessages"),z=u.findByProps("getChannel","getDMFromUserId"),K=u.findByProps("openLazy","hideActionSheet");u.findByProps("getUser");const Me=u.findByName("Icon"),{DCDChatManager:Le}=e.ReactNative.NativeModules,{FormRow:xe}=C.Forms;function Ue(r,n){let{[r]:t,...a}=n;return a}let R={},T=[];function q(r,n){if(r!=null&&n!=null)for(const t of Object.keys(n))typeof n[t]=="object"&&!Array.isArray(n[t])?(typeof r[t]!="object"&&(r[t]={}),q(r[t],n[t])):r[t]??=n[t]}q(s.storage,{deletedMessage:void 0,editedMessage:void 0,deletedMessageColorBackground:void 0,useBackgroundColor:!1,customize:!1,showChanges:!1,ignore:!1,ignoreBots:!1,users:[],minimal:!0});let Z,ee,te,ae;const Oe={onLoad(){Z=F.before("startEditMessage",Pe,function(r){let n=s.storage.editedMessage||"`[ EDITED ]`";n=n+`

`;const[t,a,o]=r,i=o.split(n);return r[2]=i[i.length-1],r}),ee=F.before("dispatch",e.FluxDispatcher,function(r){const[n]=r;let t=n.type;if(t==="MESSAGE_DELETE"){if(R[n.id]&&R[n.id].modified==2)return R=Ue(n.id,R),r;if(R[n.id]&&R[n.id].modified==1)return R[n.id].modified=2,R[n.id].arg;const a=$.getMessage(r[0].channelId,r[0].id);return s.storage?.ignoreBots&&a?.author?.bot||!a?.author?.id||!a?.author?.username||!a?.content&&a?.attachments?.length==0&&a?.embeds?.length==0||s.storage?.users?.some(function(o){return o?.id==a?.author?.id})||s.storage?.users?.some(function(o){return o?.username==a?.author?.username})||(r[0]={type:"MESSAGE_UPDATE",channelId:a?.channel_id,message:{...a,content:a?.content,type:0,flags:64,channel_id:a?.channel_id,guild_id:z?.getChannel(a?.channel_id)?.guild_id,timestamp:`${new Date().toJSON()}`,state:"SENT"},optimistic:!1,sendMessageOptions:{},isPushNotification:!1},R[n.id]={arg:r,modified:1}),r}if(t==="MESSAGE_UPDATE"){if(n?.removeHistory||s.storage.ignoreBots&&n?.message?.author?.bot)return r;const a=$.getMessage(n?.message?.channel_id,n?.message?.id);if(!a?.author?.id||!a?.author?.username||!a?.content&&a?.attachments?.length==0&&a?.embeds?.length==0||n?.message?.content==a?.content||s.storage?.users?.some(function(h){return h?.id==n?.message?.author?.id})||s.storage?.users?.some(function(h){return h?.username==n?.message?.author?.username}))return r;let o=s.storage.editedMessage||"`[ EDITED ]`";o=o+`

`;let i=n?.message||a;return r[0]={type:"MESSAGE_UPDATE",message:{...i,content:`${a?.content}  ${o}${n?.message?.content??""}`,guild_id:z.getChannel(a?.channel_id)?.guild_id,edited_timestamp:"invalid_timestamp"}},T.push(a?.id||n?.message?.id),r}}),s.storage.minimal||(te=F.before("updateRows",Le,function(r){let n=JSON.parse(r[1]),t=s.storage.deletedMessageColor||"E40303",a=/[0-9A-Fa-f]{6}/;t.match(a)||(t="E40303");function o(i){const h=["text","heading","s","u","em","strong","list","blockQuote"];if(Array.isArray(i))return i.map(o);if(typeof i=="object"&&i!==null){const{content:l,type:f,target:y,context:c,items:p}=i;if(!h.includes(f))return i;if(f==="text"&&l&&l.length>=1)return{content:[{content:l,type:"text"}],target:"usernameOnClick",type:"link",context:{username:1,medium:!0,usernameOnClick:{action:"0",userId:"0",linkColor:e.ReactNative.processColor(`#${t.toString()}`),messageChannelId:"0"}}};const D=o(l),w=p?p.map(o):void 0;if(D!==l||w!==p||!h.includes(f)){const S={...i,content:D};return f==="blockQuote"&&y&&(S.content=D,S.target=y),f==="list"&&S.hasOwnProperty("content")&&delete S.content,p&&(S.items=w),S}}return i}n.forEach(function(i){if(i?.type==1&&R[i?.message?.id]){let h=o(i?.message?.content);i.message.content=h,i.message.edited=s.storage.deletedMessage||"This message is deleted";let l=s.storage.deletedMessageColorBackground||"FF2C2F";l.match(a)||(l="FF2C2F");let f=`#${l.toString()}33`,y=`#${l.toString()}CC`;Boolean(s.storage.useBackgroundColor)&&(i.backgroundHighlight={backgroundColor:e.ReactNative.processColor(f),gutterColor:e.ReactNative.processColor(y)})}}),r[1]=JSON.stringify(n)})),ae=F.before("openLazy",K,function(r){const[n,t,a]=r;t==="MessageLongPressActionSheet"&&n.then(function(o){const i=F.after("default",o,function(h,l){e.React.useEffect(function(){return function(){i()}},[]);let[f,y]=l.props?.children?.props?.children?.props?.children;const c=f?.props?.message??a?.message;if(!y||!c)return;const p=$.getMessage(c.channel_id,c.id);T.includes(c?.id||p?.id)&&y.unshift(e.React.createElement(xe,{label:"Remove EDITED Log History",leading:e.React.createElement(Me,{source:d.getAssetIDByName("ic_edit_24px")}),onPress:function(){let D=s.storage.editedMessage||"`[ EDITED ]`";D=D+`

`;const w=c?.content?.split(D),S=w[w.length-1];e.FluxDispatcher.dispatch({type:"MESSAGE_UPDATE",message:{...p,content:`${S}`,guild_id:z.getChannel(p.channel_id).guild_id},removeHistory:!0});let ne=T.indexOf(p?.id||c?.id);ne>-1&&T.splice(ne,1),K.hideActionSheet(),M.showToast("[Message Logger] Logs Removed",d.getAssetIDByName("ic_edit_24px"))}}))})})})},onUnload(){Z?.(),te?.(),ee?.(),ae?.()},settings:Be};return B.default=Oe,Object.defineProperty(B,"__esModule",{value:!0}),B})({},vendetta.plugin,vendetta.storage,vendetta.ui.components,vendetta.ui.assets,vendetta.metro.common,vendetta.metro,vendetta.ui,vendetta.ui.toasts,vendetta.ui.alerts,vendetta.patcher);
