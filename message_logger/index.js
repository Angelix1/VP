(function(N,s,B,C,u,e,f,g,M,ie,I,oe){"use strict";var le=[{version:"End Of Life (NO MAJOR UPDATE)",patch:["This plugin will not be updated anymore in term MAJOR UPDATE, until further infos."]},{version:"v0.1.3",patch:["Fixed Crashing Issue when Embedded Links got Sent on Chat","Fixed Crashing Issue When Long Press a Message","Fixed Crashing Issue when Opening Plugin Settings"]},{version:"v0.0.8 - v0.0.82",patch:["Added minimalistic option","Added remove edited log history when long press a message.","Added Ignore user list, by UserID and Name.","Added Customizeable Text Color for Deleted Messages.","Added Customizeable Background Color for Deleted Messages.","Added Customization for Edited Messages Separator.","Fixed for when editing a own message it only take the last edited history rather than everything.","Fixed Message fails to logs. (lmk if persist)."]}];const{ScrollView:ce,View:L,Text:de,TouchableOpacity:z,TextInput:ze,Image:ue,Animated:F}=C.General,{FormLabel:ge,FormIcon:he,FormArrow:Ve,FormRow:w,FormSwitch:V,FormSwitchRow:Ye,FormSection:Y,FormDivider:fe,FormInput:H}=C.Forms,Ee=f.findByName("useIsFocused");f.findByProps("BottomSheetScrollView");const G=f.findByStoreName("UserStore"),X=f.findByProps("showUserProfile");u.getAssetIDByName("ic_add_24px"),u.getAssetIDByName("ic_arrow"),u.getAssetIDByName("ic_minus_circle_24px"),u.getAssetIDByName("Check"),u.getAssetIDByName("Small");function x(r){return e.React.createElement(he,{style:{opacity:1},source:u.getAssetIDByName(r)})}const m=e.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:g.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"3%",fontSize:24},sub:{color:g.semanticColors.TEXT_POSITIVE,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:g.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16},container:{marginTop:25,marginLeft:"5%",marginBottom:-15,flexDirection:"row"},textContainer:{paddingLeft:15,paddingTop:5,flexDirection:"column",flexWrap:"wrap",shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:.2,shadowRadius:4.65,elevation:8},image:{width:75,height:75,borderRadius:10,shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:.2,shadowRadius:4.65,elevation:8},mainText:{opacity:.975,letterSpacing:.25},header:{color:g.semanticColors.HEADER_PRIMARY,fontFamily:e.constants.Fonts.DISPLAY_BOLD,fontSize:25,letterSpacing:.25},subHeader:{color:g.semanticColors.HEADER_SECONDARY,fontSize:12.75}});function j(r){let{index:n}=r,t=s.storage?.users[n];B.useProxy(s.storage);const a=e.React.useRef(new F.Value(1)).current,i=function(){return F.spring(a,{toValue:1.1,duration:10,useNativeDriver:!0}).start()},o=function(){return F.spring(a,{toValue:1,duration:250,useNativeDriver:!0}).start()},h={transform:[{scale:a}]};let l=G.getUser(t?.id),d=Object.values(G.getUsers());l||(l=d.find(function(c){return c?.username==t?.username})),l||(l=d.find(function(c){return c?.username?.toLowerCase()==t?.username?.toLowerCase()}));const y=e.NavigationNative.useNavigation();return Ee(),e.React.createElement(e.React.Fragment,null,e.React.createElement(ce,null,e.React.createElement(Y,{style:[m.basicPad]},e.React.createElement(L,{style:[m.basicPad,m.sub]},e.React.createElement(Y,{title:"User Setting",style:[m.header]},e.React.createElement(w,{label:"Find User Id or Username",leading:x("ic_search"),onPress:function(){l&&!t.username?.length?t.username=l.username:l&&!t.id?.length?t.id=l.id:M.showToast("Cannot find User Id/Username.")}}),e.React.createElement(H,{title:"User Username | Case Sensitive",placeholder:"Missing No",value:t?.username,onChange:function(c){return t.username=c}}),e.React.createElement(H,{title:"User Id",placeholder:"Missing No",value:t?.id,onChange:function(c){return t.id=c}}),e.React.createElement(w,{label:"User is webhook?",subLabel:"User is webhook or system, and not BOT or Normal User.",leading:x("ic_webhook_24px"),trailing:e.React.createElement(V,{value:t?.isWebhook||!1,onValueChange:function(c){return t.isWebhook=c}})})),l&&e.React.createElement(w,{label:"Show User Profile",leading:x("ic_info"),trailing:e.React.createElement(V,{value:t?.showUser||!1,onValueChange:function(c){return t.showUser=c}})}),t?.showUser&&e.React.createElement(L,{style:[m.container,{paddingBottom:10}]},e.React.createElement(z,{onPress:function(){return X.showUserProfile?.({userId:l?.id})},onPressIn:i,onPressOut:o},e.React.createElement(F.View,{style:h},e.React.createElement(ue,{style:[m.image],source:function(){let c=l?.getAvatarURL?.()?.replace?.("webp","png");return c||(c="https://cdn.discordapp.com/embed/avatars/1.png"),{uri:c}}}))),e.React.createElement(L,{style:m.textContainer},e.React.createElement(z,{onPress:function(){return X.showUserProfile({userId:l?.id})}},e.React.createElement(de,{style:[m.mainText,m.header]},l?.username||t?.username||"No Name"))),e.React.createElement(fe,null)))),e.React.createElement(w,{label:e.React.createElement(ge,{text:"Remove User from Ignore List",style:{color:g.rawColors.RED_400}}),onPress:function(){y.pop(),s.storage.users?.splice(n,1)}})))}const{ScrollView:Re,View:me,Text:He,TouchableOpacity:ye,TextInput:pe}=C.General,{FormLabel:Ge,FormIcon:Ce,FormArrow:be,FormRow:O,FormSwitch:Xe,FormSwitchRow:je,FormSection:Se,FormDivider:De,FormInput:Je}=C.Forms;function J(r,n){return React.createElement(Ce,{style:{opacity:1},source:n?r:u.getAssetIDByName(r)})}const Ie=f.findByName("useIsFocused");f.findByProps("BottomSheetScrollView");const{getUser:Ae}=f.findByProps("getUser"),Fe=u.getAssetIDByName("ic_add_24px");u.getAssetIDByName("ic_arrow"),u.getAssetIDByName("ic_minus_circle_24px"),u.getAssetIDByName("Check"),u.getAssetIDByName("Small");const we=u.getAssetIDByName("ic_trash_24px"),S=e.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:g.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"3.5%",fontSize:24},sub:{color:g.semanticColors.TEXT_POSITIVE,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:g.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16},input:{fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM,color:g.semanticColors.TEXT_NORMAL},placeholder:{color:g.semanticColors.INPUT_PLACEHOLDER_TEXT}});function _e(){B.useProxy(s.storage);let[r,n]=React.useState("");const t=e.NavigationNative.useNavigation();Ie();let a=s.storage.users??[];const i=function(){if(r){if(isNaN(parseInt(r)))a.push({id:void 0,username:r});else{let o=Ae(r);if(o)a.push({id:o?.id,username:"",showUser:!1,isWebhook:!1});else return M.showToast("Invalid User Id")}n(""),t.push("VendettaCustomPage",{title:"Adding User to Ignore List",render:function(){return React.createElement(j,{index:a?.length-1})}})}};return React.createElement(React.Fragment,null,React.createElement(Re,{style:{flex:1}},React.createElement(Se,{style:[S.header,S.basicPad]},React.createElement(me,{style:[S.header,S.sub]},a.length>0&&React.createElement(O,{label:"Clear List",trailing:J(we,!0),onPress:function(){a.length!==0&&ie.showConfirmationAlert({title:"Hol up, wait a minute!",content:`This will removes in total ${a.length} users from ignore list.`,confirmText:"Ye",cancelText:"Nah",confirmColor:"brand",onConfirm:function(){s.storage.users=[]}})}}),a?.map(function(o,h){return React.createElement(React.Fragment,null,React.createElement(O,{label:o?.username||o?.id||"No Data",trailing:React.createElement(be,null),onPress:function(){return t.push("VendettaCustomPage",{title:"Editing User",render:function(){return React.createElement(j,{index:h})}})}}),h!==a?.length-1&&React.createElement(De,null))}),React.createElement(O,{label:React.createElement(pe,{value:r,onChangeText:n,placeholder:"User ID or Username",placeholderTextColor:S.placeholder.color,selectionColor:e.constants.Colors.PRIMARY_DARK_100,onSubmitEditing:i,returnKeyType:"done",style:S.input}),trailing:React.createElement(ye,{onPress:i},J(Fe,!0))})))))}const{ScrollView:Te,View:_,Text:W,TouchableOpacity:ve,TextInput:We}=C.General,{FormLabel:Qe,FormIcon:T,FormArrow:Ke,FormRow:A,FormSwitch:U,FormSwitchRow:qe,FormSection:$,FormDivider:Q,FormInput:Pe}=C.Forms,b=e.stylesheet.createThemedStyleSheet({text:{color:g.semanticColors.HEADER_SECONDARY,paddingLeft:"5.5%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:e.constants.Fonts.PRIMARY_BOLD,fontSize:16},subText:{color:g.semanticColors.TEXT_POSITIVE,paddingLeft:"6%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,fontSize:12},input:{fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM,color:g.semanticColors.TEXT_NORMAL},placeholder:{color:g.semanticColors.INPUT_PLACEHOLDER_TEXT}}),Ne=u.getAssetIDByName("ic_add_24px");f.findByProps("getUser");const Be=f.findByName("useIsFocused");let K=[{id:"deletedMessageColor",title:"Customize Deleted Message Color ( DO NOT INCLUDE # )",type:"default",placeholder:"E40303"},{id:"deletedMessage",title:"Customize Deleted Message",type:"default",placeholder:"This message is deleted"},{id:"editedMessage",title:"Customize Edited Separator",type:"default",placeholder:"`[ EDITED ]`"},{id:"deletedMessageColorBackground",title:"Customize Deleted Background Message Color ( DO NOT INCLUDE # )",type:"default",placeholder:"FF2C2F"}];const q=[{id:"minimal",default:!0,label:"Minimalistic Settings",subLabel:"Removes all Styling (Enabled by Default)"},{id:"useBackgroundColor",default:!1,label:"Enable Background Color",subLabel:"Background Color for Deleted Message, similiar to Mention but Customizeable"},{id:"ignoreBots",default:!1,label:"Ignore Bots",subLabel:"Ignore bot deleted messages."}];function Me(){B.useProxy(s.storage);const r=e.NavigationNative.useNavigation();Be(),s.storage.users;const n=function(){r.push("VendettaCustomPage",{title:"List of Ignored Users",render:function(){return e.React.createElement(_e,null)}})};return e.React.createElement(Te,null,e.React.createElement(_,{style:{marginTop:20,marginBottom:20}},e.React.createElement($,{title:"Plugin Setting",style:[b.header]},e.React.createElement(A,{label:"Customization",subLabel:"Show customization for the plugin",leading:e.React.createElement(T,{style:{opacity:1},source:u.getAssetIDByName("ic_category_16px")}),trailing:e.React.createElement(U,{value:s.storage.customize??!1,onValueChange:function(t){return s.storage.customize=t}})}),s.storage.customize&&e.React.createElement(A,{label:"Reload the Plugin to Apply Color Change"}),s.storage.customize&&e.React.createElement(_,{style:[b.subText]},q.map(function(t,a){return e.React.createElement(e.React.Fragment,null,e.React.createElement(A,{label:t.label,subLabel:t.subLabel,leading:t.icon&&e.React.createElement(T,{style:{opacity:1},source:u.getAssetIDByName(t.icon)}),trailing:"id"in t?e.React.createElement(U,{value:s.storage[t.id]??t.default,onValueChange:function(i){return s.storage[t.id]=i}}):void 0}),a!==q.length-1&&e.React.createElement(Q,null))})),s.storage.customize&&e.React.createElement(_,{style:[b.subText]},K.map(function(t,a){return e.React.createElement(e.React.Fragment,null,e.React.createElement(Pe,{title:t.title,keyboardType:t.type,placeholder:t.placeholder,value:s.storage[t.id]??t.placeholder,onChange:function(i){return s.storage[t.id]=i.toString()}}),a!==K.length-1&&e.React.createElement(Q,null))}))),e.React.createElement($,{title:"Ignore List Setting",style:[b.header]},e.React.createElement(_,{style:{color:g.semanticColors.TEXT_POSITIVE,paddingLeft:"8%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,fontSize:12}},e.React.createElement(A,{label:"Add User to List",onPress:n,trailing:e.React.createElement(ve,{onPress:n},e.React.createElement(T,{style:{opacity:1},source:Ne}))}))),e.React.createElement($,{title:"Plugin Updates",style:[b.header]},e.React.createElement(A,{label:"Show Changes",subLabel:"Show New stuff, Fixes, etc for the plugin",leading:e.React.createElement(T,{style:{opacity:1},source:u.getAssetIDByName("ic_info")}),trailing:e.React.createElement(U,{value:s.storage.showChanges??!1,onValueChange:function(t){return s.storage.showChanges=t}})}),s.storage.showChanges&&le?.map(function(t,a){return e.React.createElement(e.React.Fragment,null,e.React.createElement(W,{style:[b.text]},t.version||"Dev Version"),t.patch?.map(function(i){return e.React.createElement(e.React.Fragment,null,e.React.createElement(W,{style:[b.subText]},`- ${i}`))}))}))))}const Le=f.findByProps("startEditMessage"),Z=f.findByProps("getMessage","getMessages"),k=f.findByProps("getChannel","getDMFromUserId"),ee=f.findByProps("openLazy","hideActionSheet");f.findByProps("getUser");const{DCDChatManager:xe}=e.ReactNative.NativeModules,{FormRow:Oe,FormIcon:Ue}=C.Forms;function $e(r,n){let{[r]:t,...a}=n;return a}let E={},v=[];function te(r,n){if(r!=null&&n!=null)for(const t of Object.keys(n))typeof n[t]=="object"&&!Array.isArray(n[t])?(typeof r[t]!="object"&&(r[t]={}),te(r[t],n[t])):r[t]??=n[t]}te(s.storage,{deletedMessage:void 0,editedMessage:void 0,deletedMessageColorBackground:void 0,useBackgroundColor:!1,customize:!1,showChanges:!1,ignore:!1,ignoreBots:!1,users:[],minimal:!0});let ae,ne,re,se;const ke={onLoad(){ae=I.before("startEditMessage",Le,function(r){let n=s.storage.editedMessage||"`[ EDITED ]`";n=n+`

`;const[t,a,i]=r,o=i.split(n);return r[2]=o[o.length-1],r}),ne=I.before("dispatch",e.FluxDispatcher,function(r){const[n]=r;let t=n.type;const a=Z.getMessage(n?.message?.channel_id||n?.channelId,n?.message?.id||n?.id);if(!a?.author?.id||!a?.author?.username||!a?.content&&a?.attachments?.length==0&&a?.embeds?.length==0)return r;if(t==="MESSAGE_DELETE")return E[n.id]&&E[n.id].modified==2?(E=$e(n.id,E),r):E[n.id]&&E[n.id].modified==1?(E[n.id].modified=2,E[n.id].arg):(s.storage?.ignoreBots&&a?.author?.bot||!a?.author?.id||!a?.author?.username||!a?.content&&a?.attachments?.length==0&&a?.embeds?.length==0||s.storage?.users?.length>0&&(s.storage?.users?.some(function(i){return i?.id==a?.author?.id})||s.storage?.users?.some(function(i){return i?.username==a?.author?.username}))||(r[0]={type:"MESSAGE_UPDATE",channelId:a?.channel_id,message:{...a,content:a?.content,type:0,flags:64,channel_id:a?.channel_id,guild_id:k?.getChannel(a?.channel_id)?.guild_id,timestamp:`${new Date().toJSON()}`,state:"SENT"},optimistic:!1,sendMessageOptions:{},isPushNotification:!1},E[n.id]={arg:r,modified:1}),r);if(t==="MESSAGE_UPDATE"){if(n?.removeHistory)return r;let i=n?.message?.content==a?.content,o=n?.message?.embeds.some(function(d){return d?.url==a?.content||d?.thumbnail?.url==a?.content});if(i||o||r[0].message?.author?.bot||a?.author?.bot||s.storage?.users?.length>0&&(s.storage?.users?.some(function(d){return d?.id==a?.author?.id})||s.storage?.users?.some(function(d){return d?.username==a?.author?.username})))return r;let h=s.storage.editedMessage||"`[ EDITED ]`";h=h+`

`;let l=n?.message||a;return r[0]={type:"MESSAGE_UPDATE",message:{...l,content:`${a?.content}  ${h}${n?.message?.content??""}`,guild_id:k.getChannel(a?.channel_id)?.guild_id,edited_timestamp:"invalid_timestamp"}},v.push(a?.id||n?.message?.id),r}}),s.storage.minimal||(re=I.before("updateRows",xe,function(r){let n=JSON.parse(r[1]),t=s.storage.deletedMessageColor||"E40303",a=/[0-9A-Fa-f]{6}/;t.match(a)||(t="E40303");function i(o){const h=["text","heading","s","u","em","strong","list","blockQuote"];if(Array.isArray(o))return o.map(i);if(typeof o=="object"&&o!==null){const{content:l,type:d,target:y,context:c,items:R}=o;if(!h.includes(d))return o;if(d==="text"&&l&&l.length>=1)return{content:[{content:l,type:"text"}],target:"usernameOnClick",type:"link",context:{username:1,medium:!0,usernameOnClick:{action:"0",userId:"0",linkColor:e.ReactNative.processColor(`#${t.toString()}`),messageChannelId:"0"}}};const D=i(l),P=R?R.map(i):void 0;if(D!==l||P!==R||!h.includes(d)){const p={...o,content:D};return d==="blockQuote"&&y&&(p.content=D,p.target=y),d==="list"&&p.hasOwnProperty("content")&&delete p.content,R&&(p.items=P),p}}return o}n.forEach(function(o){if(o?.type==1&&E[o?.message?.id]){let h=i(o?.message?.content);o.message.content=h,o.message.edited=s.storage.deletedMessage||"This message is deleted";let l=s.storage.deletedMessageColorBackground||"FF2C2F";l.match(a)||(l="FF2C2F");let d=`#${l.toString()}33`,y=`#${l.toString()}CC`;Boolean(s.storage.useBackgroundColor)&&(o.backgroundHighlight={backgroundColor:e.ReactNative.processColor(d),gutterColor:e.ReactNative.processColor(y)})}}),r[1]=JSON.stringify(n)})),se=I.before("openLazy",ee,function(r){let[n,t,a]=r;const i=a?.message;t!=="MessageLongPressActionSheet"||!i||n.then(function(o){const h=I.after("default",o,function(l,d){e.React.useEffect(function(){return function(){h()}},[]);const y=oe.findInReactTree(d,function(R){return R?.[0]?.type?.name==="ButtonRow"});if(!y)return d;const c=Z.getMessage(i.channel_id,i.id);v.includes(i?.id||c?.id)&&y.unshift(e.React.createElement(Oe,{label:"Remove EDITED Log History",leading:e.React.createElement(Ue,{style:{opacity:1},source:u.getAssetIDByName("ic_edit_24px")}),onPress:function(){let R=s.storage.editedMessage||"`[ EDITED ]`";R=R+`

`;const D=i?.content?.split(R),P=D[D.length-1];e.FluxDispatcher.dispatch({type:"MESSAGE_UPDATE",message:{...c,content:`${P}`,guild_id:k.getChannel(c.channel_id).guild_id},removeHistory:!0});let p=v.indexOf(c?.id||i?.id);p>-1&&v.splice(p,1),ee.hideActionSheet(),M.showToast("[Message Logger] Logs Removed",u.getAssetIDByName("ic_edit_24px"))}}))})})})},onUnload(){ae?.(),re?.(),ne?.(),se?.()},settings:Me};return N.default=ke,Object.defineProperty(N,"__esModule",{value:!0}),N})({},vendetta.plugin,vendetta.storage,vendetta.ui.components,vendetta.ui.assets,vendetta.metro.common,vendetta.metro,vendetta.ui,vendetta.ui.toasts,vendetta.ui.alerts,vendetta.patcher,vendetta.utils);
