(function(N,s,B,C,d,e,h,g,M,oe,I){"use strict";var le=[{version:"End Of Life (NO MAJOR UPDATE)",patch:["This plugin will not be updated anymore in term MAJOR UPDATE, until further infos."]},{version:"v0.1.3",patch:["Fixed Crashing Issue when Embedded Links got Sent on Chat","Fixed Crashing Issue When Long Press a Message","Fixed Crashing Issue when Opening Plugin Settings"]},{version:"v0.0.8 - v0.0.82",patch:["Added minimalistic option","Added remove edited log history when long press a message.","Added Ignore user list, by UserID and Name.","Added Customizeable Text Color for Deleted Messages.","Added Customizeable Background Color for Deleted Messages.","Added Customization for Edited Messages Separator.","Fixed for when editing a own message it only take the last edited history rather than everything.","Fixed Message fails to logs. (lmk if persist)."]}];const{ScrollView:ce,View:L,Text:de,TouchableOpacity:k,TextInput:ke,Image:ue,Animated:w}=C.General,{FormLabel:ge,FormIcon:he,FormArrow:Ve,FormRow:_,FormSwitch:V,FormSwitchRow:Ye,FormSection:Y,FormDivider:fe,FormInput:H}=C.Forms,Ee=h.findByName("useIsFocused");h.findByProps("BottomSheetScrollView");const G=h.findByStoreName("UserStore"),X=h.findByProps("showUserProfile");d.getAssetIDByName("ic_add_24px"),d.getAssetIDByName("ic_arrow"),d.getAssetIDByName("ic_minus_circle_24px"),d.getAssetIDByName("Check"),d.getAssetIDByName("Small");function x(r){return e.React.createElement(he,{style:{opacity:1},source:d.getAssetIDByName(r)})}const m=e.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:g.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"3%",fontSize:24},sub:{color:g.semanticColors.TEXT_POSITIVE,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:g.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16},container:{marginTop:25,marginLeft:"5%",marginBottom:-15,flexDirection:"row"},textContainer:{paddingLeft:15,paddingTop:5,flexDirection:"column",flexWrap:"wrap",shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:.2,shadowRadius:4.65,elevation:8},image:{width:75,height:75,borderRadius:10,shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:.2,shadowRadius:4.65,elevation:8},mainText:{opacity:.975,letterSpacing:.25},header:{color:g.semanticColors.HEADER_PRIMARY,fontFamily:e.constants.Fonts.DISPLAY_BOLD,fontSize:25,letterSpacing:.25},subHeader:{color:g.semanticColors.HEADER_SECONDARY,fontSize:12.75}});function j(r){let{index:n}=r,t=s.storage?.users[n];B.useProxy(s.storage);const a=e.React.useRef(new w.Value(1)).current,l=function(){return w.spring(a,{toValue:1.1,duration:10,useNativeDriver:!0}).start()},i=function(){return w.spring(a,{toValue:1,duration:250,useNativeDriver:!0}).start()},f={transform:[{scale:a}]};let o=G.getUser(t?.id),u=Object.values(G.getUsers());o||(o=u.find(function(c){return c?.username==t?.username})),o||(o=u.find(function(c){return c?.username?.toLowerCase()==t?.username?.toLowerCase()}));const R=e.NavigationNative.useNavigation();return Ee(),e.React.createElement(e.React.Fragment,null,e.React.createElement(ce,null,e.React.createElement(Y,{style:[m.basicPad]},e.React.createElement(L,{style:[m.basicPad,m.sub]},e.React.createElement(Y,{title:"User Setting",style:[m.header]},e.React.createElement(_,{label:"Find User Id or Username",leading:x("ic_search"),onPress:function(){o&&!t.username?.length?t.username=o.username:o&&!t.id?.length?t.id=o.id:M.showToast("Cannot find User Id/Username.")}}),e.React.createElement(H,{title:"User Username | Case Sensitive",placeholder:"Missing No",value:t?.username,onChange:function(c){return t.username=c}}),e.React.createElement(H,{title:"User Id",placeholder:"Missing No",value:t?.id,onChange:function(c){return t.id=c}}),e.React.createElement(_,{label:"User is webhook?",subLabel:"User is webhook or system, and not BOT or Normal User.",leading:x("ic_webhook_24px"),trailing:e.React.createElement(V,{value:t?.isWebhook||!1,onValueChange:function(c){return t.isWebhook=c}})})),o&&e.React.createElement(_,{label:"Show User Profile",leading:x("ic_info"),trailing:e.React.createElement(V,{value:t?.showUser||!1,onValueChange:function(c){return t.showUser=c}})}),t?.showUser&&e.React.createElement(L,{style:[m.container,{paddingBottom:10}]},e.React.createElement(k,{onPress:function(){return X.showUserProfile?.({userId:o?.id})},onPressIn:l,onPressOut:i},e.React.createElement(w.View,{style:f},e.React.createElement(ue,{style:[m.image],source:function(){let c=o?.getAvatarURL?.()?.replace?.("webp","png");return c||(c="https://cdn.discordapp.com/embed/avatars/1.png"),{uri:c}}}))),e.React.createElement(L,{style:m.textContainer},e.React.createElement(k,{onPress:function(){return X.showUserProfile({userId:o?.id})}},e.React.createElement(de,{style:[m.mainText,m.header]},o?.username||t?.username||"No Name"))),e.React.createElement(fe,null)))),e.React.createElement(_,{label:e.React.createElement(ge,{text:"Remove User from Ignore List",style:{color:g.rawColors.RED_400}}),onPress:function(){R.pop(),s.storage.users?.splice(n,1)}})))}const{ScrollView:me,View:Re,Text:He,TouchableOpacity:ye,TextInput:pe}=C.General,{FormLabel:Ge,FormIcon:Ce,FormArrow:be,FormRow:O,FormSwitch:Xe,FormSwitchRow:je,FormSection:Se,FormDivider:De,FormInput:Je}=C.Forms;function J(r,n){return React.createElement(Ce,{style:{opacity:1},source:n?r:d.getAssetIDByName(r)})}const Ie=h.findByName("useIsFocused");h.findByProps("BottomSheetScrollView");const{getUser:Ae}=h.findByProps("getUser"),Fe=d.getAssetIDByName("ic_add_24px");d.getAssetIDByName("ic_arrow"),d.getAssetIDByName("ic_minus_circle_24px"),d.getAssetIDByName("Check"),d.getAssetIDByName("Small");const we=d.getAssetIDByName("ic_trash_24px"),D=e.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:g.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"3.5%",fontSize:24},sub:{color:g.semanticColors.TEXT_POSITIVE,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:g.semanticColors.HEADER_SECONDARY,fontFamily:e.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16},input:{fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM,color:g.semanticColors.TEXT_NORMAL},placeholder:{color:g.semanticColors.INPUT_PLACEHOLDER_TEXT}});function _e(){B.useProxy(s.storage);let[r,n]=React.useState("");const t=e.NavigationNative.useNavigation();Ie();let a=s.storage.users??[];const l=function(){if(r){if(isNaN(parseInt(r)))a.push({id:void 0,username:r});else{let i=Ae(r);if(i)a.push({id:i?.id,username:"",showUser:!1,isWebhook:!1});else return M.showToast("Invalid User Id")}n(""),t.push("VendettaCustomPage",{title:"Adding User to Ignore List",render:function(){return React.createElement(j,{index:a?.length-1})}})}};return React.createElement(React.Fragment,null,React.createElement(me,{style:{flex:1}},React.createElement(Se,{style:[D.header,D.basicPad]},React.createElement(Re,{style:[D.header,D.sub]},a.length>0&&React.createElement(O,{label:"Clear List",trailing:J(we,!0),onPress:function(){a.length!==0&&oe.showConfirmationAlert({title:"Hol up, wait a minute!",content:`This will removes in total ${a.length} users from ignore list.`,confirmText:"Ye",cancelText:"Nah",confirmColor:"brand",onConfirm:function(){s.storage.users=[]}})}}),a?.map(function(i,f){return React.createElement(React.Fragment,null,React.createElement(O,{label:i?.username||i?.id||"No Data",trailing:React.createElement(be,null),onPress:function(){return t.push("VendettaCustomPage",{title:"Editing User",render:function(){return React.createElement(j,{index:f})}})}}),f!==a?.length-1&&React.createElement(De,null))}),React.createElement(O,{label:React.createElement(pe,{value:r,onChangeText:n,placeholder:"User ID or Username",placeholderTextColor:D.placeholder.color,selectionColor:e.constants.Colors.PRIMARY_DARK_100,onSubmitEditing:l,returnKeyType:"done",style:D.input}),trailing:React.createElement(ye,{onPress:l},J(Fe,!0))})))))}const{ScrollView:Pe,View:P,Text:W,TouchableOpacity:Te,TextInput:We}=C.General,{FormLabel:Qe,FormIcon:T,FormArrow:Ke,FormRow:A,FormSwitch:U,FormSwitchRow:qe,FormSection:$,FormDivider:Q,FormInput:ve}=C.Forms,b=e.stylesheet.createThemedStyleSheet({text:{color:g.semanticColors.HEADER_SECONDARY,paddingLeft:"5.5%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:e.constants.Fonts.PRIMARY_BOLD,fontSize:16},subText:{color:g.semanticColors.TEXT_POSITIVE,paddingLeft:"6%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,fontSize:12},input:{fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM,color:g.semanticColors.TEXT_NORMAL},placeholder:{color:g.semanticColors.INPUT_PLACEHOLDER_TEXT}}),Ne=d.getAssetIDByName("ic_add_24px");h.findByProps("getUser");const Be=h.findByName("useIsFocused");let K=[{id:"deletedMessageColor",title:"Customize Deleted Message Color ( DO NOT INCLUDE # )",type:"default",placeholder:"E40303"},{id:"deletedMessage",title:"Customize Deleted Message",type:"default",placeholder:"This message is deleted"},{id:"editedMessage",title:"Customize Edited Separator",type:"default",placeholder:"`[ EDITED ]`"},{id:"deletedMessageColorBackground",title:"Customize Deleted Background Message Color ( DO NOT INCLUDE # )",type:"default",placeholder:"FF2C2F"}];const q=[{id:"minimal",default:!0,label:"Minimalistic Settings",subLabel:"Removes all Styling (Enabled by Default)"},{id:"useBackgroundColor",default:!1,label:"Enable Background Color",subLabel:"Background Color for Deleted Message, similiar to Mention but Customizeable"},{id:"ignoreBots",default:!1,label:"Ignore Bots",subLabel:"Ignore bot deleted messages."}];function Me(){B.useProxy(s.storage);const r=e.NavigationNative.useNavigation();Be(),s.storage.users;const n=function(){r.push("VendettaCustomPage",{title:"List of Ignored Users",render:function(){return e.React.createElement(_e,null)}})};return e.React.createElement(Pe,null,e.React.createElement(P,{style:{marginTop:20,marginBottom:20}},e.React.createElement($,{title:"Plugin Setting",style:[b.header]},e.React.createElement(A,{label:"Customization",subLabel:"Show customization for the plugin",leading:e.React.createElement(T,{style:{opacity:1},source:d.getAssetIDByName("ic_category_16px")}),trailing:e.React.createElement(U,{value:s.storage.customize??!1,onValueChange:function(t){return s.storage.customize=t}})}),s.storage.customize&&e.React.createElement(A,{label:"Reload the Plugin to Apply Color Change"}),s.storage.customize&&e.React.createElement(P,{style:[b.subText]},q.map(function(t,a){return e.React.createElement(e.React.Fragment,null,e.React.createElement(A,{label:t.label,subLabel:t.subLabel,leading:t.icon&&e.React.createElement(T,{style:{opacity:1},source:d.getAssetIDByName(t.icon)}),trailing:"id"in t?e.React.createElement(U,{value:s.storage[t.id]??t.default,onValueChange:function(l){return s.storage[t.id]=l}}):void 0}),a!==q.length-1&&e.React.createElement(Q,null))})),s.storage.customize&&e.React.createElement(P,{style:[b.subText]},K.map(function(t,a){return e.React.createElement(e.React.Fragment,null,e.React.createElement(ve,{title:t.title,keyboardType:t.type,placeholder:t.placeholder,value:s.storage[t.id]??t.placeholder,onChange:function(l){return s.storage[t.id]=l.toString()}}),a!==K.length-1&&e.React.createElement(Q,null))}))),e.React.createElement($,{title:"Ignore List Setting",style:[b.header]},e.React.createElement(P,{style:{color:g.semanticColors.TEXT_POSITIVE,paddingLeft:"8%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:e.constants.Fonts.DISPLAY_NORMAL,fontSize:12}},e.React.createElement(A,{label:"Add User to List",onPress:n,trailing:e.React.createElement(Te,{onPress:n},e.React.createElement(T,{style:{opacity:1},source:Ne}))}))),e.React.createElement($,{title:"Plugin Updates",style:[b.header]},e.React.createElement(A,{label:"Show Changes",subLabel:"Show New stuff, Fixes, etc for the plugin",leading:e.React.createElement(T,{style:{opacity:1},source:d.getAssetIDByName("ic_info")}),trailing:e.React.createElement(U,{value:s.storage.showChanges??!1,onValueChange:function(t){return s.storage.showChanges=t}})}),s.storage.showChanges&&le?.map(function(t,a){return e.React.createElement(e.React.Fragment,null,e.React.createElement(W,{style:[b.text]},t.version||"Dev Version"),t.patch?.map(function(l){return e.React.createElement(e.React.Fragment,null,e.React.createElement(W,{style:[b.subText]},`- ${l}`))}))}))))}const Le=h.findByProps("startEditMessage"),Z=h.findByProps("getMessage","getMessages"),z=h.findByProps("getChannel","getDMFromUserId"),ee=h.findByProps("openLazy","hideActionSheet");h.findByProps("getUser");const{DCDChatManager:xe}=e.ReactNative.NativeModules,{FormRow:Oe,FormIcon:Ue}=C.Forms;function $e(r,n){let{[r]:t,...a}=n;return a}let E={},v=[];function te(r,n){if(r!=null&&n!=null)for(const t of Object.keys(n))typeof n[t]=="object"&&!Array.isArray(n[t])?(typeof r[t]!="object"&&(r[t]={}),te(r[t],n[t])):r[t]??=n[t]}te(s.storage,{deletedMessage:void 0,editedMessage:void 0,deletedMessageColorBackground:void 0,useBackgroundColor:!1,customize:!1,showChanges:!1,ignore:!1,ignoreBots:!1,users:[],minimal:!0});let ae,ne,re,se;const ze={onLoad(){ae=I.before("startEditMessage",Le,function(r){let n=s.storage.editedMessage||"`[ EDITED ]`";n=n+`

`;const[t,a,l]=r,i=l.split(n);return r[2]=i[i.length-1],r}),ne=I.before("dispatch",e.FluxDispatcher,function(r){const[n]=r;let t=n.type;const a=Z.getMessage(n?.message?.channel_id||n?.channelId,n?.message?.id||n?.id);if(!a?.author?.id||!a?.author?.username||!a?.content&&a?.attachments?.length==0&&a?.embeds?.length==0)return r;if(t==="MESSAGE_DELETE")return E[n.id]&&E[n.id].modified==2?(E=$e(n.id,E),r):E[n.id]&&E[n.id].modified==1?(E[n.id].modified=2,E[n.id].arg):(s.storage?.ignoreBots&&a?.author?.bot||!a?.author?.id||!a?.author?.username||!a?.content&&a?.attachments?.length==0&&a?.embeds?.length==0||s.storage?.users?.length>0&&(s.storage?.users?.some(function(l){return l?.id==a?.author?.id})||s.storage?.users?.some(function(l){return l?.username==a?.author?.username}))||(r[0]={type:"MESSAGE_UPDATE",channelId:a?.channel_id,message:{...a,content:a?.content,type:0,flags:64,channel_id:a?.channel_id,guild_id:z?.getChannel(a?.channel_id)?.guild_id,timestamp:`${new Date().toJSON()}`,state:"SENT"},optimistic:!1,sendMessageOptions:{},isPushNotification:!1},E[n.id]={arg:r,modified:1}),r);if(t==="MESSAGE_UPDATE"){if(n?.removeHistory)return r;let l=n?.message?.content==a?.content,i=n?.message?.embeds.some(function(u){return u?.url==a?.content||u?.thumbnail?.url==a?.content});if(l||i||r[0].message?.author?.bot||a?.author?.bot||s.storage?.users?.length>0&&(s.storage?.users?.some(function(u){return u?.id==a?.author?.id})||s.storage?.users?.some(function(u){return u?.username==a?.author?.username})))return r;let f=s.storage.editedMessage||"`[ EDITED ]`";f=f+`

`;let o=n?.message||a;return r[0]={type:"MESSAGE_UPDATE",message:{...o,content:`${a?.content}  ${f}${n?.message?.content??""}`,guild_id:z.getChannel(a?.channel_id)?.guild_id,edited_timestamp:"invalid_timestamp"}},v.push(a?.id||n?.message?.id),r}}),s.storage.minimal||(re=I.before("updateRows",xe,function(r){let n=JSON.parse(r[1]),t=s.storage.deletedMessageColor||"E40303",a=/[0-9A-Fa-f]{6}/;t.match(a)||(t="E40303");function l(i){const f=["text","heading","s","u","em","strong","list","blockQuote"];if(Array.isArray(i))return i.map(l);if(typeof i=="object"&&i!==null){const{content:o,type:u,target:R,context:c,items:y}=i;if(!f.includes(u))return i;if(u==="text"&&o&&o.length>=1)return{content:[{content:o,type:"text"}],target:"usernameOnClick",type:"link",context:{username:1,medium:!0,usernameOnClick:{action:"0",userId:"0",linkColor:e.ReactNative.processColor(`#${t.toString()}`),messageChannelId:"0"}}};const S=l(o),F=y?y.map(l):void 0;if(S!==o||F!==y||!f.includes(u)){const p={...i,content:S};return u==="blockQuote"&&R&&(p.content=S,p.target=R),u==="list"&&p.hasOwnProperty("content")&&delete p.content,y&&(p.items=F),p}}return i}n.forEach(function(i){if(i?.type==1&&E[i?.message?.id]){let f=l(i?.message?.content);i.message.content=f,i.message.edited=s.storage.deletedMessage||"This message is deleted";let o=s.storage.deletedMessageColorBackground||"FF2C2F";o.match(a)||(o="FF2C2F");let u=`#${o.toString()}33`,R=`#${o.toString()}CC`;Boolean(s.storage.useBackgroundColor)&&(i.backgroundHighlight={backgroundColor:e.ReactNative.processColor(u),gutterColor:e.ReactNative.processColor(R)})}}),r[1]=JSON.stringify(n)})),se=I.before("openLazy",ee,function(r){const[n,t,a]=r;t==="MessageLongPressActionSheet"&&n.then(function(l){const i=I.after("default",l,function(f,o){e.React.useEffect(function(){return function(){i()}},[]);let[u,R]=o.props?.children?.props?.children?.props?.children;const c=u?.props?.message??a?.message;if(!R||!c)return;const y=Z.getMessage(c.channel_id,c.id);v.includes(c?.id||y?.id)&&R.unshift(e.React.createElement(Oe,{label:"Remove EDITED Log History",leading:e.React.createElement(Ue,{style:{opacity:1},source:d.getAssetIDByName("ic_edit_24px")}),onPress:function(){let S=s.storage.editedMessage||"`[ EDITED ]`";S=S+`

`;const F=c?.content?.split(S),p=F[F.length-1];e.FluxDispatcher.dispatch({type:"MESSAGE_UPDATE",message:{...y,content:`${p}`,guild_id:z.getChannel(y.channel_id).guild_id},removeHistory:!0});let ie=v.indexOf(y?.id||c?.id);ie>-1&&v.splice(ie,1),ee.hideActionSheet(),M.showToast("[Message Logger] Logs Removed",d.getAssetIDByName("ic_edit_24px"))}}))})})})},onUnload(){ae?.(),re?.(),ne?.(),se?.()},settings:Me};return N.default=ze,Object.defineProperty(N,"__esModule",{value:!0}),N})({},vendetta.plugin,vendetta.storage,vendetta.ui.components,vendetta.ui.assets,vendetta.metro.common,vendetta.metro,vendetta.ui,vendetta.ui.toasts,vendetta.ui.alerts,vendetta.patcher);
