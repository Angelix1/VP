(function(o,s,y,i,u,E,p,g){"use strict";const{FormRow:P,FormSwitch:b,FormSwitchRow:x,FormSection:L,FormDivider:T,FormInput:R}=u.Forms,{ScrollView:M,View:c,Text:l}=u.General,d=s.stylesheet.createThemedStyleSheet({text:{color:E.semanticColors.HEADER_SECONDARY,paddingLeft:"5.5%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:s.constants.Fonts.PRIMARY_BOLD,fontSize:16},subText:{color:E.semanticColors.TEXT_POSITIVE,paddingLeft:"6%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:s.constants.Fonts.DISPLAY_NORMAL,fontSize:12}});let f=function(e){return e.toUpperCase()},_=[{id:"deletedMessageColor",title:"Customize Deleted Message Color ( DO NOT INCLUDE # )",type:"default",placeholder:"E40303"},{id:"deletedMessage",title:"Customize Deleted Message",type:"default",placeholder:"This message is deleted"},{id:"editedMessage",title:"Customize Edited Separator",type:"default",placeholder:"`[ EDITED ]`"}],v=[{version:"v0.0.8",patch:["Added Customizeable Text Color for Deleted Messages.","Changed Deleted Message Patch to use Discord Built-in.","Removed Option to use DELETED, NormalEphemeral, DefaultAutomodEphemeral","Removed Ephemeral Custom Settings.","Removed Ephemeral Patch."]}];function C(){return y.useProxy(i.storage),s.React.createElement(M,null,s.React.createElement(c,{style:{marginTop:20}},s.React.createElement(c,{style:{marginTop:10}},s.React.createElement(l,{style:[d.text,d.optionText]},f("Customize Separator")),s.React.createElement(c,{style:[d.subText]},_.map(function(e,t){return s.React.createElement(s.React.Fragment,null,s.React.createElement(R,{title:e.title,keyboardType:e.type,placeholder:e.placeholder,value:i.storage[e.id]??e.placeholder,onChange:function(a){return i.storage[e.id]=a.toString()}}),t!==_.length-1&&s.React.createElement(T,null))})),s.React.createElement(l,{style:[d.subText,d.optionText]},f("Reload the Plugin to Apply Color Change")),s.React.createElement(l,{style:[d.text,d.optionText]},"Changes"),v.map(function(e,t){return s.React.createElement(s.React.Fragment,null,s.React.createElement(l,{style:[d.text]},e.version||"Dev Version"),e.patch?.map(function(a){return s.React.createElement(s.React.Fragment,null,s.React.createElement(l,{style:[d.subText]},`- ${a}`))}))}))))}const D=g.findByProps("getMessage","getMessages"),m=g.findByProps("getChannel","getDMFromUserId"),A=g.findByProps("startEditMessage");let r={};function F(e,t){let{[e]:a,...n}=t;return n}const I={onLoad(){this.self=p.before("startEditMessage",A,function(e){let t=`${i.storage.edit_var||"`[ EDITED ]`"}

`;const[a,n,h]=e,S=h.split(t);return e[2]=S[S.length-1],e}),this.messageLogger=p.before("dispatch",s.FluxDispatcher,function(e){const[t]=e;if(t.type==="MESSAGE_DELETE"){if(r[t.id]&&r[t.id].modified==2)return r=F(t.id,r),e;if(r[t.id]&&r[t.id].modified==1)return r[t.id].modified=2,r[t.id].arg;if(!Boolean(i.storage.msg_useDeleted)&&!Boolean(i.storage.msg_normalEphemeral)){if(!t?.id||!t?.channelId)return;let n=i.storage.message?.trim?.()||"This message was deleted";return i.storage.useTimestamps&&(n+=` (${s.moment().format(i.storage.useAMPM?"hh:mm:ss.SS a":"HH:mm:ss.SS")})`),e[0]={type:"MESSAGE_EDIT_FAILED_AUTOMOD",messageData:{type:1,message:{channelId:t.channelId,messageId:t.id}},errorResponseBody:{code:2e5,message:n}},r[t.id]={arg:e,modified:1},e}const a=D.getMessage(e[0].channelId,e[0].id);if(Boolean(i.storage.msg_useDeleted)==!0){let n=i.storage.del_var||"`[ DELETED ]`";return!a?.author?.id||!a?.author?.username||!a?.content&&a?.attachments?.length==0&&a?.embeds?.length==0||(e[0]={type:"MESSAGE_UPDATE",message:{...a,edited_timestamp:"invalid_timestamp",content:`${a?.content} ${n}`,guild_id:m.getChannel(a?.channel_id)?.guild_id}},r[t.id]={arg:e,modified:1}),e}if(Boolean(i.storage.msg_normalEphemeral)==!0)return!a?.author?.id||!a?.author?.username||!a?.content&&a?.attachments?.length==0&&a?.embeds?.length==0||(e[0]={type:"MESSAGE_UPDATE",channelId:a?.channel_id,message:{...a,content:a?.content,type:0,flags:64,channel_id:a?.channel_id,guild_id:m?.getChannel(a?.channel_id)?.guild_id,timestamp:`${new Date().toJSON()}`,state:"SENT"},optimistic:!1,sendMessageOptions:{},isPushNotification:!1},r[t.id]={arg:e,modified:1}),e}if(t.type==="MESSAGE_UPDATE"){let a=`${i.storage.edit_var||"`[ EDITED ]`"}

`;const n=D.getMessage(e[0].message?.channel_id,e[0].message?.id);if(e[0].message?.author?.bot||n?.author?.bot||!n?.author?.id||!n?.author?.username||!n?.content&&n?.attachments?.length==0&&n?.embeds?.length==0||t?.message?.content==n.content)return e;let h=t?.message??n;return e[0]={type:"MESSAGE_UPDATE",message:{...h,content:`${n?.content}  ${a}${t?.message?.content??""}`,guild_id:m.getChannel(n?.channel_id)?.guild_id,edited_timestamp:"invalid_timestamp"}},e}})},onUnload(){this.self?.(),this.messageLogger?.()},settings:C};return o.default=I,Object.defineProperty(o,"__esModule",{value:!0}),o})({},vendetta.metro.common,vendetta.storage,vendetta.plugin,vendetta.ui.components,vendetta.ui,vendetta.patcher,vendetta.metro);
